<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lean: Common/SecurityIdentifier.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lean
   &#160;<span id="projectnumber">$LEAN_TAG$</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('SecurityIdentifier_8cs_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SecurityIdentifier.cs</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * QUANTCONNECT.COM - Democratizing Finance, Empowering Individuals.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Lean Algorithmic Trading Engine v2.0. Copyright 2014 QuantConnect Corporation.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * limitations under the License.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using</span> System;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using</span> System.Linq;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using</span> System.Numerics;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using</span> Newtonsoft.Json;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using</span> ProtoBuf;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Configuration.html">Configuration</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Data.html">Data</a>.<a class="code" href="namespaceQuantConnect_1_1Data_1_1Auxiliary.html">Auxiliary</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Data.html">Data</a>.<a class="code" href="namespaceQuantConnect_1_1Data_1_1UniverseSelection.html">UniverseSelection</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Interfaces.html">Interfaces</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Logging.html">Logging</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Securities.html">Securities</a>.<a class="code" href="namespaceQuantConnect_1_1Securities_1_1Future.html">Future</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="namespaceQuantConnect_1_1Util.html">Util</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceQuantConnect.html">QuantConnect</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">    /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">    /// Defines a unique identifier for securities</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">    /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">    /// &lt;remarks&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">    /// The SecurityIdentifier contains information about a specific security.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">    /// This includes the symbol and other data specific to the SecurityType.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">    /// The symbol is limited to 12 characters</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">    /// &lt;/remarks&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span>    [JsonConverter(typeof(<a class="code" href="classQuantConnect_1_1Util_1_1SecurityIdentifierJsonConverter.html" title="A JsonConverter implementation that serializes a SecurityIdentifier as a string">SecurityIdentifierJsonConverter</a>))]</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    [ProtoContract(SkipConstructor = <span class="keyword">true</span>)]</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html">   42</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> : IEquatable&lt;SecurityIdentifier&gt;, IComparable&lt;SecurityIdentifier&gt;, IComparable</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">        #region Empty, DefaultDate Fields</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly Dictionary&lt;string, Type&gt; TypeMapping = <span class="keyword">new</span>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly Dictionary&lt;string, SecurityIdentifier&gt; SecurityIdentifierCache = <span class="keyword">new</span>();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">char</span>[] InvalidCharacters = {<span class="charliteral">&#39;|&#39;</span>, <span class="charliteral">&#39; &#39;</span>};</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly Lazy&lt;IMapFileProvider&gt; MapFileProvider = <span class="keyword">new</span>(<a class="code" href="classQuantConnect_1_1Util_1_1Composer.html" title="Provides methods for obtaining exported MEF instances">Composer</a>.<a class="code" href="classQuantConnect_1_1Util_1_1Composer.html#a41c561733f9f9f866a93ff6062988f0a" title="Gets the singleton instance">Instance</a>.GetPart&lt;<a class="code" href="interfaceQuantConnect_1_1Interfaces_1_1IMapFileProvider.html" title="Provides instances of MapFileResolver at run time">IMapFileProvider</a>&gt;());</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">        /// Gets an instance of &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; that is empty, that is, one with no symbol specified</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40">   54</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> readonly <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a> = <span class="keyword">new</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a>(<span class="keywordtype">string</span>.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a>, 0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">        /// Gets an instance of &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; that is explicitly no symbol</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#af025dd543f5cf417656864b97fee4000">   59</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> readonly <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#af025dd543f5cf417656864b97fee4000" title="Gets an instance of SecurityIdentifier that is explicitly no symbol">None</a> = <span class="keyword">new</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a>(<span class="stringliteral">&quot;NONE&quot;</span>, 0);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">        /// Gets the date to be used when it does not apply.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe">   64</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> readonly DateTime <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a> = DateTime.FromOADate(0);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">        /// Gets the set of invalids symbol characters</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ae8627f9991928d66a5ad0f76a6a294c0">   69</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> readonly HashSet&lt;char&gt; <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ae8627f9991928d66a5ad0f76a6a294c0" title="Gets the set of invalids symbol characters">InvalidSymbolCharacters</a> = <span class="keyword">new</span> HashSet&lt;char&gt;(InvalidCharacters);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">        #region Scales, Widths and Market Maps</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">// these values define the structure of the &#39;otherData&#39;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">// the constant width fields are used via modulus, so the width is the number of zeros specified,</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">// {put/call:1}{oa-date:5}{style:1}{strike:6}{strike-scale:2}{market:3}{security-type:2}</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong SecurityTypeWidth = 100;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong SecurityTypeOffset = 1;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong MarketWidth = 1000;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong MarketOffset = SecurityTypeOffset * SecurityTypeWidth;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keywordtype">int</span> StrikeDefaultScale = 4;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly ulong StrikeDefaultScaleExpanded = Pow(10, StrikeDefaultScale);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong StrikeScaleWidth = 100;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong StrikeScaleOffset = MarketOffset * MarketWidth;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong StrikeWidth = 1000000;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong StrikeOffset = StrikeScaleOffset * StrikeScaleWidth;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong OptionStyleWidth = 10;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong OptionStyleOffset = StrikeOffset * StrikeWidth;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong DaysWidth = 100000;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong DaysOffset = OptionStyleOffset * OptionStyleWidth;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong PutCallOffset = DaysOffset * DaysWidth;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">private</span> <span class="keyword">const</span> ulong PutCallWidth = 10;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">        #region Member variables</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        [ProtoMember(1)]</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> _symbol;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        [ProtoMember(2)]</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">private</span> ulong _properties;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        [ProtoMember(3)]</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">private</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> _underlying;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> _hashCodeSet;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">int</span> _hashCode;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">private</span> decimal? _strikePrice;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespaceQuantConnect.html#af494a9ea558b0688d1ac13f0a751a18b" title="Specifies the style of an option">OptionStyle</a>? _optionStyle;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespaceQuantConnect.html#a0dda2dc2456afd7812708a3a2715badb" title="Specifies the different types of options">OptionRight</a>? _optionRight;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">private</span> DateTime? _date;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> _stringRep;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> _market;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">        #region Properties</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">        /// Gets whether or not this &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; is a derivative,</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">        /// that is, it has a valid &lt;see cref=&quot;Underlying&quot;/&gt; property</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a5059861c7d374e28ce5ba85ed7da25f3" title="Gets whether or not this SecurityIdentifier is a derivative, that is, it has a valid Underlying prope...">HasUnderlying</a></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a5059861c7d374e28ce5ba85ed7da25f3">  131</a></span>&#160;        {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keyword">get</span> { <span class="keywordflow">return</span> _underlying != <span class="keyword">null</span>; }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">        /// Gets the underlying security identifier for this security identifier. When there is</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">        /// no underlying, this property will return a value of &lt;see cref=&quot;Empty&quot;/&gt;.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ae4b1f50d04c2eec12ce562875e86c7eb" title="Gets the underlying security identifier for this security identifier. When there is no underlying,...">Underlying</a></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ae4b1f50d04c2eec12ce562875e86c7eb">  140</a></span>&#160;        {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">if</span> (_underlying == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.NoUnderlyingForIdentifier);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">return</span> _underlying;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">        /// Gets the date component of this identifier. For equities this</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">        /// is the first date the security traded. Technically speaking,</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">        /// in LEAN, this is the first date mentioned in the map_files.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">        /// For futures and options this is the expiry date of the contract.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">        /// For other asset classes, this property will throw an</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">        /// exception as the field is not specified.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> DateTime <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a2db4d78b110f2b7958e8c2db37633e75" title="Gets the date component of this identifier. For equities this is the first date the security traded....">Date</a></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a2db4d78b110f2b7958e8c2db37633e75">  160</a></span>&#160;        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">if</span> (_date.HasValue)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    <span class="keywordflow">return</span> _date.Value;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Base:</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Equity:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Option:</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future:</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Index:</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.FutureOption:</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.IndexOption:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.CryptoFuture:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                        var oadate = ExtractFromProperties(DaysOffset, DaysWidth);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        _date = DateTime.FromOADate(oadate);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        <span class="keywordflow">return</span> _date.Value;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.DateNotSupportedBySecurityType);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">        /// Gets the original symbol used to generate this security identifier.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">        /// For equities, by convention this is the first ticker symbol for which</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">        /// the security traded</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ace258f9e4ad2c6f375838feb31c6b2ee">  193</a></span>&#160;        {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keyword">get</span> { <span class="keywordflow">return</span> _symbol; }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">        /// Gets the market component of this security identifier. If located in the</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">        /// internal mappings, the full string is returned. If the value is unknown,</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">        /// the integer value is returned as a string.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a315b1be5234c0cff05939cd9db40e998">  203</a></span>&#160;        {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">if</span> (_market == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    var marketCode = ExtractFromProperties(MarketOffset, MarketWidth);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    var market = <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3c613b86b1b27e5f9db2ca7dd92e692" title="Gets the market string for the specified market code.">Decode</a>((<span class="keywordtype">int</span>)marketCode);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    <span class="comment">// if we couldn&#39;t find it, send back the numeric representation</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    _market = market ?? marketCode.ToStringInvariant();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="keywordflow">return</span> _market;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">        /// Gets the security type component of this security identifier.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span>        [ProtoMember(4)]</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50">  221</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a> <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">        /// Gets the option strike price. This only applies to SecurityType.Option</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">        /// and will thrown anexception if accessed otherwise.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> decimal <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aafa837959b7858b21f14ccfe9445e10a" title="Gets the option strike price. This only applies to SecurityType.Option and will thrown anexception if...">StrikePrice</a></div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#aafa837959b7858b21f14ccfe9445e10a">  228</a></span>&#160;        {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="keywordflow">if</span> (_strikePrice.HasValue)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="keywordflow">return</span> _strikePrice.Value;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.IsOption())</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.StrikePriceNotSupportedBySecurityType);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="comment">// performance: lets calculate strike price once</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                var scale = ExtractFromProperties(StrikeScaleOffset, StrikeScaleWidth);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                var unscaled = ExtractFromProperties(StrikeOffset, StrikeWidth);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                var pow = Math.Pow(10, (<span class="keywordtype">int</span>)scale - StrikeDefaultScale);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="comment">// If the 20th bit is set to 1, we have a negative strike price.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="comment">// Let&#39;s normalize the strike and explicitly make it negative</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">if</span> (((unscaled &gt;&gt; 19) &amp; 1) == 1)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    _strikePrice = -((unscaled ^ 1 &lt;&lt; 19) * (decimal)pow);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    _strikePrice = unscaled * (decimal)pow;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">return</span> _strikePrice.Value;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">        /// Gets the option type component of this security identifier. This</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">        /// only applies to SecurityType.Open and will throw an exception if</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">        /// accessed otherwise.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="namespaceQuantConnect.html#a0dda2dc2456afd7812708a3a2715badb" title="Specifies the different types of options">OptionRight</a> <a class="code" href="namespaceQuantConnect.html#a0dda2dc2456afd7812708a3a2715badb" title="Specifies the different types of options">OptionRight</a></div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a7bd877900556f1a06925e588e32da61e">  266</a></span>&#160;        {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">if</span> (_optionRight.HasValue)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">return</span> _optionRight.Value;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.IsOption())</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.OptionRightNotSupportedBySecurityType);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                _optionRight = (<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a7bd877900556f1a06925e588e32da61e" title="Gets the option type component of this security identifier. This only applies to SecurityType....">OptionRight</a>)ExtractFromProperties(PutCallOffset, PutCallWidth);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keywordflow">return</span> _optionRight.Value;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">        /// Gets the option style component of this security identifier. This</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">        /// only applies to SecurityType.Open and will throw an exception if</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">        /// accessed otherwise.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="namespaceQuantConnect.html#af494a9ea558b0688d1ac13f0a751a18b" title="Specifies the style of an option">OptionStyle</a> <a class="code" href="namespaceQuantConnect.html#af494a9ea558b0688d1ac13f0a751a18b" title="Specifies the style of an option">OptionStyle</a></div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a1eb9c1c858b62db0a0a3b528efb62e86">  289</a></span>&#160;        {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="keywordflow">if</span> (_optionStyle.HasValue)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    <span class="keywordflow">return</span> _optionStyle.Value;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.IsOption())</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.OptionStyleNotSupportedBySecurityType);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                _optionStyle = (<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a1eb9c1c858b62db0a0a3b528efb62e86" title="Gets the option style component of this security identifier. This only applies to SecurityType....">OptionStyle</a>)(ExtractFromProperties(OptionStyleOffset, OptionStyleWidth));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">return</span> _optionStyle.Value;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">        #region Constructors</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">        /// Initializes a new instance of the &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; class</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The base36 string encoded as a long using alpha [0-9A-Z]&lt;/param&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">        /// &lt;param name=&quot;properties&quot;&gt;Other data defining properties of the symbol including market,</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">        /// security type, listing or expiry date, strike/call/put/style for options, ect...&lt;/param&gt;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426">  317</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a>(<span class="keywordtype">string</span> symbol, ulong properties)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">if</span> (symbol == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(symbol), <a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.NullSymbol);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span> (symbol.IndexOfAny(InvalidCharacters) != -1)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.SymbolWithInvalidCharacters, nameof(symbol));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            _symbol = symbol;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            _properties = properties;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            _underlying = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            _strikePrice = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            _optionStyle = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            _optionRight = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            _date = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a> = (<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>)ExtractFromProperties(SecurityTypeOffset, SecurityTypeWidth, properties);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.IsValid())</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.PropertiesDoNotMatchAnySecurityType, nameof(properties));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            _hashCode = unchecked (symbol.GetHashCode() * 397) ^ properties.GetHashCode();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            _hashCodeSet = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">        /// Initializes a new instance of the &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; class</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The base36 string encoded as a long using alpha [0-9A-Z]&lt;/param&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">        /// &lt;param name=&quot;properties&quot;&gt;Other data defining properties of the symbol including market,</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">        /// security type, listing or expiry date, strike/call/put/style for options, ect...&lt;/param&gt;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">        /// &lt;param name=&quot;underlying&quot;&gt;Specifies a &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; that represents the underlying security&lt;/param&gt;</span></div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a5375b4677930b4e1cc7a77c66df9bb46">  350</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a5375b4677930b4e1cc7a77c66df9bb46" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a>(<span class="keywordtype">string</span> symbol, ulong properties, <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> underlying)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            : this(symbol, properties)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">if</span> (symbol == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(symbol), <a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.NullSymbol);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            _symbol = symbol;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            _properties = properties;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">// performance: directly call Equals(SecurityIdentifier other), shortcuts Equals(object other)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">if</span> (!underlying.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ab488583adab72515b2242de5bb81cddf" title="Indicates whether the current object is equal to another object of the same type.">Equals</a>(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a>))</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                _underlying = underlying;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">        #region AddMarket, GetMarketCode, and Generate</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for an option</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">        /// &lt;param name=&quot;expiry&quot;&gt;The date the option expires&lt;/param&gt;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">        /// &lt;param name=&quot;underlying&quot;&gt;The underlying security&#39;s symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The market&lt;/param&gt;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">        /// &lt;param name=&quot;strike&quot;&gt;The strike price&lt;/param&gt;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">        /// &lt;param name=&quot;optionRight&quot;&gt;The option type, call or put&lt;/param&gt;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">        /// &lt;param name=&quot;optionStyle&quot;&gt;The option style, American or European&lt;/param&gt;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified option security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a58becf4433a3155807bc4959679ccca7">  380</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a58becf4433a3155807bc4959679ccca7" title="Generates a new SecurityIdentifier for an option">GenerateOption</a>(DateTime expiry,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> underlying,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordtype">string</span> market,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            decimal strike,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <a class="code" href="namespaceQuantConnect.html#a0dda2dc2456afd7812708a3a2715badb" title="Specifies the different types of options">OptionRight</a> optionRight,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <a class="code" href="namespaceQuantConnect.html#af494a9ea558b0688d1ac13f0a751a18b" title="Specifies the style of an option">OptionStyle</a> optionStyle)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a58becf4433a3155807bc4959679ccca7" title="Generates a new SecurityIdentifier for an option">GenerateOption</a>(expiry, underlying, <span class="keyword">null</span>, market, strike, optionRight, optionStyle);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for an option</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">        /// &lt;param name=&quot;expiry&quot;&gt;The date the option expires&lt;/param&gt;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">        /// &lt;param name=&quot;underlying&quot;&gt;The underlying security&#39;s symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">        /// &lt;param name=&quot;targetOption&quot;&gt;The target option ticker. This is useful when the option ticker does not match the underlying, e.g. SPX index and the SPXW weekly option. If null is provided will use underlying&lt;/param&gt;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The market&lt;/param&gt;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">        /// &lt;param name=&quot;strike&quot;&gt;The strike price&lt;/param&gt;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">        /// &lt;param name=&quot;optionRight&quot;&gt;The option type, call or put&lt;/param&gt;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">        /// &lt;param name=&quot;optionStyle&quot;&gt;The option style, American or European&lt;/param&gt;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified option security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a82845310b39e03896ca25e0822141768">  401</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a82845310b39e03896ca25e0822141768" title="Generates a new SecurityIdentifier for an option">GenerateOption</a>(DateTime expiry,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> underlying,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordtype">string</span> targetOption,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordtype">string</span> market,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            decimal strike,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="namespaceQuantConnect.html#a0dda2dc2456afd7812708a3a2715badb" title="Specifies the different types of options">OptionRight</a> optionRight,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <a class="code" href="namespaceQuantConnect.html#af494a9ea558b0688d1ac13f0a751a18b" title="Specifies the style of an option">OptionStyle</a> optionStyle)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(targetOption))</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">if</span> (underlying.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a> == <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="comment">// Futures options tickers might not match, so we need</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <span class="comment">// to map the provided future Symbol to the actual future option Symbol.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    targetOption = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesOptionsSymbolMappings.html" title="Provides conversions from a GLOBEX Futures ticker to a GLOBEX Futures Options ticker">FuturesOptionsSymbolMappings</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesOptionsSymbolMappings.html#a251fd2b69c6e3169a2036c514529b785" title="Returns the futures options ticker for the given futures ticker.">Map</a>(underlying.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ace258f9e4ad2c6f375838feb31c6b2ee" title="Gets the original symbol used to generate this security identifier. For equities, by convention this ...">Symbol</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="comment">// by default the target option matches the underlying symbol</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    targetOption = underlying.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ace258f9e4ad2c6f375838feb31c6b2ee" title="Gets the original symbol used to generate this security identifier. For equities, by convention this ...">Symbol</a>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordflow">return</span> Generate(expiry, targetOption, <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#ae4c4c626fa68f4bc1e67e5ee8d9870fc" title="Determines the SecurityType based on the underlying Symbol&#39;s SecurityType">GetOptionTypeFromUnderlying</a>(underlying.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>), market, strike, optionRight, optionStyle, underlying);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a future</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">        /// &lt;param name=&quot;expiry&quot;&gt;The date the future expires&lt;/param&gt;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The security&#39;s symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The market&lt;/param&gt;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified futures security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ad50a891c97cb0c084a9e2aa43607ed66">  434</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ad50a891c97cb0c084a9e2aa43607ed66" title="Generates a new SecurityIdentifier for a future">GenerateFuture</a>(DateTime expiry,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordtype">string</span> symbol,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">return</span> Generate(expiry, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, market);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">        /// Helper overload that will search the mapfiles to resolve the first date. This implementation</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">        /// uses the configured &lt;see cref=&quot;IMapFileProvider&quot;/&gt; via the &lt;see cref=&quot;Composer.Instance&quot;/&gt;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The symbol as it is known today&lt;/param&gt;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The market&lt;/param&gt;</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">        /// &lt;param name=&quot;mapSymbol&quot;&gt;Specifies if symbol should be mapped using map file provider&lt;/param&gt;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">        /// &lt;param name=&quot;mapFileProvider&quot;&gt;Specifies the IMapFileProvider to use for resolving symbols, specify null to load from Composer&lt;/param&gt;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">        /// &lt;param name=&quot;mappingResolveDate&quot;&gt;The date to use to resolve the map file. Default value is &lt;see cref=&quot;DateTime.Today&quot;/&gt;&lt;/param&gt;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified symbol today&lt;/returns&gt;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a0c21d7880c9fdd260883d11ea0c99a00">  451</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a0c21d7880c9fdd260883d11ea0c99a00" title="Helper overload that will search the mapfiles to resolve the first date. This implementation uses the...">GenerateEquity</a>(<span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market, <span class="keywordtype">bool</span> mapSymbol = <span class="keyword">true</span>, <a class="code" href="interfaceQuantConnect_1_1Interfaces_1_1IMapFileProvider.html" title="Provides instances of MapFileResolver at run time">IMapFileProvider</a> mapFileProvider = <span class="keyword">null</span>, DateTime? mappingResolveDate = <span class="keyword">null</span>)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            var firstDate = <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">if</span> (mapSymbol)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                var firstTickerDate = GetFirstTickerAndDate(mapFileProvider ?? MapFileProvider.Value, symbol, market, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Equity, mappingResolveDate: mappingResolveDate);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                firstDate = firstTickerDate.Item2;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                symbol = firstTickerDate.Item1;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a0c21d7880c9fdd260883d11ea0c99a00" title="Helper overload that will search the mapfiles to resolve the first date. This implementation uses the...">GenerateEquity</a>(firstDate, symbol, market);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">        /// For the given symbol will resolve the ticker it used at the requested date</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The symbol to get the ticker for&lt;/param&gt;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">        /// &lt;param name=&quot;date&quot;&gt;The date to map the symbol to&lt;/param&gt;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">        /// &lt;returns&gt;The ticker for a date and symbol&lt;/returns&gt;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a62166df04edcb28963083dd34b500b5d">  470</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a62166df04edcb28963083dd34b500b5d" title="For the given symbol will resolve the ticker it used at the requested date">Ticker</a>(<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a> symbol, DateTime date)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">if</span> (symbol.RequiresMapping())</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                var resolver = MapFileProvider.Value.Get(<a class="code" href="classQuantConnect_1_1Data_1_1Auxiliary_1_1AuxiliaryDataKey.html" title="Unique definition key for a collection of auxiliary data for a Market and SecurityType">AuxiliaryDataKey</a>.<a class="code" href="classQuantConnect_1_1Data_1_1Auxiliary_1_1AuxiliaryDataKey.html#a581149f0149fb793872935e0d46f0eed" title="Helper method to create a new instance from a Symbol">Create</a>(symbol));</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                var mapfile = resolver.ResolveMapFile(symbol);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <span class="keywordflow">return</span> mapfile.GetMappedSymbol(date.Date, symbol.<a class="code" href="classQuantConnect_1_1Symbol.html#ad77256b8d686f7e2699e040e8e703b94" title="Gets the current symbol for this ticker">Value</a>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">return</span> symbol.<a class="code" href="classQuantConnect_1_1Symbol.html#ad77256b8d686f7e2699e040e8e703b94" title="Gets the current symbol for this ticker">Value</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for an equity</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">        /// &lt;param name=&quot;date&quot;&gt;The first date this security traded (in LEAN this is the first date in the map_file&lt;/param&gt;</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The ticker symbol this security traded under on the &lt;paramref name=&quot;date&quot;/&gt;&lt;/param&gt;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified equity security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#af79145f2e6bf6861ed87d27fbfac0a9f">  490</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#af79145f2e6bf6861ed87d27fbfac0a9f" title="Generates a new SecurityIdentifier for an equity">GenerateEquity</a>(DateTime date, <span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">return</span> Generate(date, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Equity, market);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a &lt;see cref=&quot;ConstituentsUniverseData&quot;/&gt;.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">        /// Note that the symbol ticker is case sensitive here.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The ticker to use for this constituent identifier&lt;/param&gt;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">        /// &lt;param name=&quot;securityType&quot;&gt;The security type of this constituent universe&lt;/param&gt;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">        /// &lt;remarks&gt;This method is special in the sense that it does not force the Symbol to be upper</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">        /// which is required to determine the source file of the constituent</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">        /// &lt;see cref=&quot;ConstituentsUniverseData.GetSource(Data.SubscriptionDataConfig,DateTime,bool)&quot;/&gt;&lt;/remarks&gt;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified constituent universe&lt;/returns&gt;</span></div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#aa2b8c59064a75d90b2e530e829331de1">  506</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2b8c59064a75d90b2e530e829331de1" title="Generates a new SecurityIdentifier for a ConstituentsUniverseData. Note that the symbol ticker is cas...">GenerateConstituentIdentifier</a>(<span class="keywordtype">string</span> symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a> securityType, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">return</span> Generate(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>, symbol, securityType, market, forceSymbolToUpper: <span class="keyword">false</span>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">        /// Generates the &lt;see cref=&quot;Symbol&quot;/&gt; property for &lt;see cref=&quot;QuantConnect.SecurityType.Base&quot;/&gt; security identifiers</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">        /// &lt;param name=&quot;dataType&quot;&gt;The base data custom data type if namespacing is required, null otherwise&lt;/param&gt;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The ticker symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">        /// &lt;returns&gt;The value used for the security identifier&#39;s &lt;see cref=&quot;Symbol&quot;/&gt;&lt;/returns&gt;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a19e1f9da410608020d74ed9e7d283575">  517</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a19e1f9da410608020d74ed9e7d283575" title="Generates the Symbol property for QuantConnect.SecurityType.Base security identifiers">GenerateBaseSymbol</a>(Type dataType, <span class="keywordtype">string</span> symbol)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">if</span> (dataType == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">return</span> symbol;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            TypeMapping[dataType.Name] = dataType;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">return</span> $<span class="stringliteral">&quot;{symbol.ToUpperInvariant()}.{dataType.Name}&quot;</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">        /// Tries to fetch the custom data type associated with a symbol</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">        /// &lt;remarks&gt;Custom data type &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; symbol value holds their data type&lt;/remarks&gt;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a65051a4af9e25cab40451dc9ef12db6a">  532</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a65051a4af9e25cab40451dc9ef12db6a" title="Tries to fetch the custom data type associated with a symbol">TryGetCustomDataType</a>(<span class="keywordtype">string</span> symbol, out <span class="keywordtype">string</span> type)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            type = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(symbol))</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                var index = symbol.LastIndexOf(<span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">if</span> (index != -1 &amp;&amp; symbol.Length &gt; index + 1)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    type = symbol.Substring(index + 1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">        /// Tries to fetch the custom data type associated with a symbol</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">        /// &lt;remarks&gt;Custom data type &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; symbol value holds their data type&lt;/remarks&gt;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a2a52cbd8bce9ff527bc8021a3e3a0037">  551</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a2a52cbd8bce9ff527bc8021a3e3a0037" title="Tries to fetch the custom data type associated with a symbol">TryGetCustomDataTypeInstance</a>(<span class="keywordtype">string</span> symbol, out Type type)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            type = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a65051a4af9e25cab40451dc9ef12db6a" title="Tries to fetch the custom data type associated with a symbol">TryGetCustomDataType</a>(symbol, out var strType) &amp;&amp; TypeMapping.TryGetValue(strType, out type);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a custom security with the option of providing the first date</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">        /// &lt;param name=&quot;dataType&quot;&gt;The custom data type&lt;/param&gt;</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The ticker symbol of this security&lt;/param&gt;</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">        /// &lt;param name=&quot;mapSymbol&quot;&gt;Whether or not we should map this symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">        /// &lt;param name=&quot;date&quot;&gt;First date that the security traded on&lt;/param&gt;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified base security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a02ca750115844561c001c2346fbafc00">  566</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a02ca750115844561c001c2346fbafc00" title="Generates a new SecurityIdentifier for a custom security with the option of providing the first date">GenerateBase</a>(Type dataType, <span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market, <span class="keywordtype">bool</span> mapSymbol = <span class="keyword">false</span>, DateTime? date = <span class="keyword">null</span>)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            var firstDate = date ?? <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">if</span> (mapSymbol)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                var firstTickerDate = GetFirstTickerAndDate(MapFileProvider.Value, symbol, market, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Equity);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                firstDate = firstTickerDate.Item2;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                symbol = firstTickerDate.Item1;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">return</span> Generate(</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                firstDate,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a19e1f9da410608020d74ed9e7d283575" title="Generates the Symbol property for QuantConnect.SecurityType.Base security identifiers">GenerateBaseSymbol</a>(dataType, symbol),</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Base,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                market,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                forceSymbolToUpper: <span class="keyword">false</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            );</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a forex pair</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The currency pair in the format similar to: &#39;EURUSD&#39;&lt;/param&gt;</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified forex pair&lt;/returns&gt;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a9cf0d3b208a5171e6112516ce441f18d">  592</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a9cf0d3b208a5171e6112516ce441f18d" title="Generates a new SecurityIdentifier for a forex pair">GenerateForex</a>(<span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">return</span> Generate(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Forex, market);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a Crypto pair</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The currency pair in the format similar to: &#39;EURUSD&#39;&lt;/param&gt;</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified Crypto pair&lt;/returns&gt;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a5889a95a36ce927dd0a109cbfbcbe663">  603</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a5889a95a36ce927dd0a109cbfbcbe663" title="Generates a new SecurityIdentifier for a Crypto pair">GenerateCrypto</a>(<span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">return</span> Generate(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Crypto, market);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a CryptoFuture pair</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">        /// &lt;param name=&quot;expiry&quot;&gt;The date the future expires&lt;/param&gt;</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The currency pair in the format similar to: &#39;EURUSD&#39;&lt;/param&gt;</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified CryptoFuture pair&lt;/returns&gt;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ac665665a16d5449872fed3427b95a260">  615</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ac665665a16d5449872fed3427b95a260" title="Generates a new SecurityIdentifier for a CryptoFuture pair">GenerateCryptoFuture</a>(DateTime expiry, <span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">return</span> Generate(expiry, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.CryptoFuture, market);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a CFD security</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The CFD contract symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified CFD security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a53953b18d814c5445e4ecdcb3b555080">  626</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a53953b18d814c5445e4ecdcb3b555080" title="Generates a new SecurityIdentifier for a CFD security">GenerateCfd</a>(<span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">return</span> Generate(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Cfd, market);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">        /// Generates a new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; for a INDEX security</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">        /// &lt;param name=&quot;symbol&quot;&gt;The Index contract symbol&lt;/param&gt;</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The security&#39;s market&lt;/param&gt;</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; representing the specified INDEX security&lt;/returns&gt;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ade05a8e57b041ab484cf585be8d05699">  637</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ade05a8e57b041ab484cf585be8d05699" title="Generates a new SecurityIdentifier for a INDEX security">GenerateIndex</a>(<span class="keywordtype">string</span> symbol, <span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">return</span> Generate(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>, symbol, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Index, market);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">        /// Generic generate method. This method should be used carefully as some parameters are not required and</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">        /// some parameters mean different things for different security types</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> Generate(DateTime date,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordtype">string</span> symbol,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a> securityType,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordtype">string</span> market,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            decimal strike = 0,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <a class="code" href="namespaceQuantConnect.html#a0dda2dc2456afd7812708a3a2715badb" title="Specifies the different types of options">OptionRight</a> optionRight = 0,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <a class="code" href="namespaceQuantConnect.html#af494a9ea558b0688d1ac13f0a751a18b" title="Specifies the style of an option">OptionStyle</a> optionStyle = 0,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> underlying = <span class="keyword">null</span>,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordtype">bool</span> forceSymbolToUpper = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">if</span> ((ulong)securityType &gt;= SecurityTypeWidth || securityType &lt; 0)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(nameof(securityType), <a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.InvalidSecurityType(nameof(securityType)));</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)optionRight &gt; 1 || optionRight &lt; 0)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(nameof(optionRight), Messages.SecurityIdentifier.InvalidOptionRight(nameof(optionRight)));</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">if</span> (date &lt; Time.BeginningOfTime)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(date.ToStringInvariant(), $<span class="stringliteral">&quot;date must be after the earliest possible date {Time.BeginningOfTime}&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="comment">// normalize input strings</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            symbol = forceSymbolToUpper ? symbol.LazyToUpper() : symbol;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            var marketIdentifier = GetMarketIdentifier(market);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            var days = (ulong)date.ToOADate() * DaysOffset;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            var marketCode = (ulong)marketIdentifier * MarketOffset;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            var strk = NormalizeStrike(strike, out ulong strikeScale) * StrikeOffset;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            strikeScale *= StrikeScaleOffset;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            var style = (ulong)optionStyle * OptionStyleOffset;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            var putcall = (ulong)optionRight * PutCallOffset;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            var otherData = putcall + days + style + strk + strikeScale + marketCode + (ulong)securityType;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            var result = <span class="keyword">new</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a>(symbol, otherData, underlying ?? <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">// we already have these so lets set them. Massive performance improvement!</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keywordflow">switch</span> (securityType)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>.Base:</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>.Equity:</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>.Future:</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    result._date = date;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>.Option:</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>.IndexOption:</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a>.FutureOption:</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    result._date = date;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    result._strikePrice = strike;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    result._optionRight = optionRight;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    result._optionStyle = optionStyle;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">        /// Resolves the first ticker/date of the security represented by &lt;paramref name=&quot;tickerToday&quot;/&gt;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">        /// &lt;param name=&quot;mapFileProvider&quot;&gt;The IMapFileProvider instance used for resolving map files&lt;/param&gt;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">        /// &lt;param name=&quot;tickerToday&quot;&gt;The security&#39;s ticker as it trades today&lt;/param&gt;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The market the security exists in&lt;/param&gt;</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">        /// &lt;param name=&quot;securityType&quot;&gt;The securityType the security exists in&lt;/param&gt;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">        /// &lt;param name=&quot;mappingResolveDate&quot;&gt;The date to use to resolve the map file. Default value is &lt;see cref=&quot;DateTime.Today&quot;/&gt;&lt;/param&gt;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">        /// &lt;returns&gt;The security&#39;s first ticker/date if mapping data available, otherwise, the provided ticker and DefaultDate are returned&lt;/returns&gt;</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> Tuple&lt;string, DateTime&gt; GetFirstTickerAndDate(<a class="code" href="interfaceQuantConnect_1_1Interfaces_1_1IMapFileProvider.html" title="Provides instances of MapFileResolver at run time">IMapFileProvider</a> mapFileProvider, <span class="keywordtype">string</span> tickerToday, <span class="keywordtype">string</span> market, <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a062a852f4a5c88ac939ade099c6a1d50" title="Gets the security type component of this security identifier.">SecurityType</a> securityType, DateTime? mappingResolveDate = <span class="keyword">null</span>)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            var resolver = mapFileProvider.<a class="code" href="interfaceQuantConnect_1_1Interfaces_1_1IMapFileProvider.html#af101e9f85e8c2beafb76f586f35a3833" title="Gets a MapFileResolver representing all the map files for the specified market">Get</a>(<span class="keyword">new</span> <a class="code" href="classQuantConnect_1_1Data_1_1Auxiliary_1_1AuxiliaryDataKey.html" title="Unique definition key for a collection of auxiliary data for a Market and SecurityType">AuxiliaryDataKey</a>(market, securityType));</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            var mapFile = resolver.<a class="code" href="classQuantConnect_1_1Data_1_1Auxiliary_1_1MapFileResolver.html#a6d176be34b3981cb11cd0a3f1d44d30a" title="Resolves the map file path containing the mapping information for the symbol defined at date">ResolveMapFile</a>(tickerToday, mappingResolveDate ?? DateTime.Today);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="comment">// if we have mapping data, use the first ticker/date from there, otherwise use provided ticker and DefaultDate</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">return</span> mapFile.Any()</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                ? Tuple.Create(mapFile.FirstTicker, mapFile.FirstDate)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                : Tuple.Create(tickerToday, <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa025329628074081cdf0827145bf68fe" title="Gets the date to be used when it does not apply.">DefaultDate</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">        /// The strike is normalized into deci-cents and then a scale factor</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">        /// is also saved to bring it back to un-normalized</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> ulong NormalizeStrike(decimal strike, out ulong scale)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            var str = strike;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="keywordflow">if</span> (strike == 0)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                scale = 0;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="comment">// convert strike to default scaling, this keeps the scale always positive</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            strike *= StrikeDefaultScaleExpanded;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            scale = 0;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">while</span> (strike % 10 == 0)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                strike /= 10;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                scale++;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="comment">// Since our max precision was previously capped at 999999 and it had 20 bits set,</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="comment">// we sacrifice a single bit from the strike price to allow for negative strike prices.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="comment">// 475711 is the maximum value that can be represented when setting the negative bit because</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="comment">// any number greater than that will cause an overflow in the strike price width and increase</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="comment">// its width to 7 digits.</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="comment">// The idea behind this formula is to determine what number the overflow would happen at.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="comment">// We get the max number representable in 19 bits, subtract the width to normalize the value,</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="comment">// and then get the difference between the 20 bit mask and the 19 bit normalized value to get</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="comment">// the max strike price + 1. Subtract 1 to normalize the value, and we have established an exclusive</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="comment">// upper bound.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keyword">const</span> ulong negativeMask = 1 &lt;&lt; 19;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keyword">const</span> ulong maxStrikePrice = negativeMask - ((negativeMask ^ (negativeMask - 1)) - StrikeWidth) - 1;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">if</span> (strike &gt;= maxStrikePrice || strike &lt;= -(<span class="keywordtype">long</span>)maxStrikePrice)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(Messages.SecurityIdentifier.InvalidStrikePrice(str));</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            var encodedStrike = (long)strike;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">if</span> (strike &lt; 0)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="comment">// Flip the sign</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                encodedStrike = -encodedStrike;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="comment">// Sets the 20th bit equal to 1</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                encodedStrike |= 1 &lt;&lt; 19;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordflow">return</span> (ulong)encodedStrike;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">        /// Accurately performs the integer exponentiation</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> ulong Pow(uint x, <span class="keywordtype">int</span> pow)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="comment">// don&#39;t use Math.Pow(double, double) due to precision issues</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">return</span> (ulong)BigInteger.Pow(x, pow);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="preprocessor">        #region Parsing routines</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">        /// Parses the specified string into a &lt;see cref=&quot;SecurityIdentifier&quot;/&gt;</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">        /// The string must be a 40 digit number. The first 20 digits must be parseable</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">        /// to a 64 bit unsigned integer and contain ancillary data about the security.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">        /// The second 20 digits must also be parseable as a 64 bit unsigned integer and</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">        /// contain the symbol encoded from base36, this provides for 12 alpha numeric case</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">        /// insensitive characters.</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">        /// &lt;param name=&quot;value&quot;&gt;The string value to be parsed&lt;/param&gt;</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">        /// &lt;returns&gt;A new &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; instance if the &lt;paramref name=&quot;value&quot;/&gt; is able to be parsed.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">        /// &lt;exception cref=&quot;FormatException&quot;&gt;This exception is thrown if the string&#39;s length is not exactly 40 characters, or</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">        /// if the components are unable to be parsed as 64 bit unsigned integers&lt;/exception&gt;</span></div>
<div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a89ccb2161613f17d18ca3dc1e9eb3872">  806</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a89ccb2161613f17d18ca3dc1e9eb3872" title="Parses the specified string into a SecurityIdentifier The string must be a 40 digit number....">Parse</a>(<span class="keywordtype">string</span> value)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            Exception exception;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> identifier;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a59bd74be4ec55a0e4631af9e10f65d7c" title="Attempts to parse the specified  as a SecurityIdentifier.">TryParse</a>(value, out identifier, out exception))</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">throw</span> exception;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">return</span> identifier;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">        /// Attempts to parse the specified &lt;see paramref=&quot;value&quot;/&gt; as a &lt;see cref=&quot;SecurityIdentifier&quot;/&gt;.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">        /// &lt;param name=&quot;value&quot;&gt;The string value to be parsed&lt;/param&gt;</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">        /// &lt;param name=&quot;identifier&quot;&gt;The result of parsing, when this function returns true, &lt;paramref name=&quot;identifier&quot;/&gt;</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">        /// was properly created and reflects the input string, when this function returns false &lt;paramref name=&quot;identifier&quot;/&gt;</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">        /// will equal default(SecurityIdentifier)&lt;/param&gt;</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">        /// &lt;returns&gt;True on success, otherwise false&lt;/returns&gt;</span></div>
<div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a59bd74be4ec55a0e4631af9e10f65d7c">  826</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a59bd74be4ec55a0e4631af9e10f65d7c" title="Attempts to parse the specified  as a SecurityIdentifier.">TryParse</a>(<span class="keywordtype">string</span> value, out <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> identifier)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            Exception exception;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a59bd74be4ec55a0e4631af9e10f65d7c" title="Attempts to parse the specified  as a SecurityIdentifier.">TryParse</a>(value, out identifier, out exception);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">        /// Helper method impl to be used by parse and tryparse</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a59bd74be4ec55a0e4631af9e10f65d7c" title="Attempts to parse the specified  as a SecurityIdentifier.">TryParse</a>(<span class="keywordtype">string</span> value, out <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> identifier, out Exception exception)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordflow">if</span> (!TryParseProperties(value, out exception, out identifier))</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">char</span>[] SplitSpace = {<span class="charliteral">&#39; &#39;</span>};</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">        /// Parses the string into its component ulong pieces</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> TryParseProperties(<span class="keywordtype">string</span> value, out Exception exception, out <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a> identifier)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            exception = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordflow">if</span> (value == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                identifier = <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            lock (SecurityIdentifierCache)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <span class="comment">// for performance, we first verify if we already have parsed this SecurityIdentifier</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <span class="keywordflow">if</span> (SecurityIdentifierCache.TryGetValue(value, out identifier))</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    <span class="keywordflow">return</span> identifier != <span class="keyword">null</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(value) || value == <span class="stringliteral">&quot; 0&quot;</span>)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    <span class="comment">// we know it&#39;s not null already let&#39;s cache it</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    SecurityIdentifierCache[value] = identifier = <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <span class="comment">// after calling TryGetValue because if it failed it will set identifier to default</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                identifier = <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#aa2c4ee14b7a104b1d8ee86693776ab40" title="Gets an instance of SecurityIdentifier that is empty, that is, one with no symbol specified">Empty</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <span class="keywordflow">try</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                    var sids = value.Split(<span class="charliteral">&#39;|&#39;</span>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                    <span class="keywordflow">for</span> (var i = sids.Length - 1; i &gt; -1; i--)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        var current = sids[i];</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                        var parts = current.Split(SplitSpace, StringSplitOptions.RemoveEmptyEntries);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                        <span class="keywordflow">if</span> (parts.Length != 2)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                        {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                            exception = <span class="keyword">new</span> FormatException(Messages.SecurityIdentifier.StringIsNotSplittable);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                        }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                        var symbol = parts[0];</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                        var otherData = parts[1];</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                        var props = otherData.DecodeBase36();</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                        <span class="comment">// toss the previous in as the underlying, if Empty, ignored by ctor</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                        identifier = <span class="keyword">new</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#abba434408f8a793fec1d82a5f45e5426" title="Initializes a new instance of the SecurityIdentifier class">SecurityIdentifier</a>(symbol, props, identifier);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                        <span class="comment">// the following method will test if the market is supported/valid</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        GetMarketIdentifier(identifier.Market);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="keywordflow">catch</span> (Exception error)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    exception = error;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    <a class="code" href="classQuantConnect_1_1Logging_1_1Log.html" title="Logging management class.">Log</a>.<a class="code" href="classQuantConnect_1_1Logging_1_1Log.html#af0e7955911bc7664b37661b2a303a9e3" title="Log error">Error</a>($<span class="stringliteral">@&quot;SecurityIdentifier.TryParseProperties(): {</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">                        Messages.SecurityIdentifier.ErrorParsingSecurityIdentifier(value, exception)}&quot;</span>);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    SecurityIdentifierCache[value] = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                SecurityIdentifierCache[value] = identifier;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">        /// Extracts the embedded value from _otherData</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> ulong ExtractFromProperties(ulong offset, ulong width)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">return</span> ExtractFromProperties(offset, width, _properties);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">        /// Extracts the embedded value from _otherData</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">        /// &lt;remarks&gt;Static so it can be used in &lt;see cref=&quot;SecurityIdentifier&quot;/&gt; initialization&lt;/remarks&gt;</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> ulong ExtractFromProperties(ulong offset, ulong width, ulong properties)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keywordflow">return</span> (properties / offset) % width;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">        /// Gets the market code for the specified market. Raise exception if the market is not found</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">        /// &lt;param name=&quot;market&quot;&gt;The market to check for (case sensitive)&lt;/param&gt;</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">        /// &lt;returns&gt;The internal code used for the market. Corresponds to the value used when calling &lt;see cref=&quot;Market.Add&quot;/&gt;&lt;/returns&gt;</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">int</span> GetMarketIdentifier(<span class="keywordtype">string</span> market)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            market = market.ToLowerInvariant();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            var marketIdentifier = <a class="code" href="namespaceQuantConnect.html">QuantConnect</a>.<a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a9640d97080d76f4f33c0d511934ac75a" title="Gets the market code for the specified market. Returns null if the market is not found">Encode</a>(market);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">if</span> (marketIdentifier.HasValue)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                <span class="keywordflow">return</span> marketIdentifier.Value;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(nameof(market), Messages.SecurityIdentifier.MarketNotFound(market));</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="preprocessor">        #region Equality members and ToString</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">        /// &lt;summary&gt;Compares the current instance with another object of the same type and returns an integer that indicates whether the current instance precedes, follows, or occurs in the same position in the sort order as the other object. &lt;/summary&gt;</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">        /// &lt;param name=&quot;other&quot;&gt;An object to compare with this instance. &lt;/param&gt;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">        /// &lt;returns&gt;A value that indicates the relative order of the objects being compared. The return value has these meanings: Value Meaning Less than zero This instance precedes &lt;paramref name=&quot;other&quot; /&gt; in the sort order.  Zero This instance occurs in the same position in the sort order as &lt;paramref name=&quot;other&quot; /&gt;. Greater than zero This instance follows &lt;paramref name=&quot;other&quot; /&gt; in the sort order. &lt;/returns&gt;</span></div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ad3b399b38ae519650ec764caabad7cfa">  957</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ad3b399b38ae519650ec764caabad7cfa" title="Compares the current instance with another object of the same type and returns an integer that indica...">CompareTo</a>(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> other)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">if</span> (ReferenceEquals(<span class="keyword">this</span>, other))</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="keywordflow">if</span> (ReferenceEquals(<span class="keyword">null</span>, other))</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keywordflow">return</span> <span class="keywordtype">string</span>.Compare(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a2bad64d68f0d388b0598ab60bf862631" title="Returns a string that represents the current object.">ToString</a>(), other.<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a2bad64d68f0d388b0598ab60bf862631" title="Returns a string that represents the current object.">ToString</a>(), StringComparison.Ordinal);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">        /// &lt;summary&gt;Compares the current instance with another object of the same type and returns an integer that indicates whether the current instance precedes, follows, or occurs in the same position in the sort order as the other object.&lt;/summary&gt;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">        /// &lt;param name=&quot;obj&quot;&gt;An object to compare with this instance. &lt;/param&gt;</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">        /// &lt;returns&gt;A value that indicates the relative order of the objects being compared. The return value has these meanings: Value Meaning Less than zero This instance precedes &lt;paramref name=&quot;obj&quot; /&gt; in the sort order. Zero This instance occurs in the same position in the sort order as &lt;paramref name=&quot;obj&quot; /&gt;. Greater than zero This instance follows &lt;paramref name=&quot;obj&quot; /&gt; in the sort order. &lt;/returns&gt;</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">        /// &lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">        /// &lt;paramref name=&quot;obj&quot; /&gt; is not the same type as this instance. &lt;/exception&gt;</span></div>
<div class="line"><a name="l00977"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ab9032cfe7a19882ddef6f5233dd09ae0">  977</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ab9032cfe7a19882ddef6f5233dd09ae0" title="Compares the current instance with another object of the same type and returns an integer that indica...">CompareTo</a>(<span class="keywordtype">object</span> obj)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keywordflow">if</span> (ReferenceEquals(<span class="keyword">null</span>, obj))</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">if</span> (ReferenceEquals(<span class="keyword">this</span>, obj))</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">if</span> (!(obj is <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a>))</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<a class="code" href="classQuantConnect_1_1Messages.html" title="Provides user-facing message construction methods and static messages for the Algorithm....">Messages</a>.<a class="code" href="classQuantConnect_1_1Messages_1_1SecurityIdentifier.html" title="Provides user-facing messages for the QuantConnect.SecurityIdentifier class and its consumers or rela...">SecurityIdentifier</a>.UnexpectedTypeToCompareTo);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ad3b399b38ae519650ec764caabad7cfa" title="Compares the current instance with another object of the same type and returns an integer that indica...">CompareTo</a>((<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a>) obj);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">        /// Indicates whether the current object is equal to another object of the same type.</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">        /// &lt;returns&gt;</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">        /// true if the current object is equal to the &lt;paramref name=&quot;other&quot;/&gt; parameter; otherwise, false.</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">        /// &lt;/returns&gt;</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">        /// &lt;param name=&quot;other&quot;&gt;An object to compare with this object.&lt;/param&gt;</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ab488583adab72515b2242de5bb81cddf"> 1004</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ab488583adab72515b2242de5bb81cddf" title="Indicates whether the current object is equal to another object of the same type.">Equals</a>(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> other)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="keywordflow">return</span> ReferenceEquals(<span class="keyword">this</span>, other) || _properties == other._properties</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                &amp;&amp; _symbol == other._symbol</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                &amp;&amp; _underlying == other._underlying;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">        /// Determines whether the specified &lt;see cref=&quot;T:System.Object&quot;/&gt; is equal to the current &lt;see cref=&quot;T:System.Object&quot;/&gt;.</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">        /// &lt;returns&gt;</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">        /// true if the specified object  is equal to the current object; otherwise, false.</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">        /// &lt;/returns&gt;</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">        /// &lt;param name=&quot;obj&quot;&gt;The object to compare with the current object. &lt;/param&gt;&lt;filterpriority&gt;2&lt;/filterpriority&gt;</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#ad3d17e1ebc8a7d6cbed9d4fb3248d6ab"> 1018</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ad3d17e1ebc8a7d6cbed9d4fb3248d6ab" title="Determines whether the specified T:System.Object is equal to the current T:System....">Equals</a>(<span class="keywordtype">object</span> obj)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordflow">if</span> (ReferenceEquals(<span class="keyword">null</span>, obj)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keywordflow">if</span> (obj.GetType() != GetType()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ab488583adab72515b2242de5bb81cddf" title="Indicates whether the current object is equal to another object of the same type.">Equals</a>((<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a>)obj);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">        /// Serves as a hash function for a particular type.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">        /// &lt;returns&gt;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">        /// A hash code for the current &lt;see cref=&quot;T:System.Object&quot;/&gt;.</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">        /// &lt;/returns&gt;</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">        /// &lt;filterpriority&gt;2&lt;/filterpriority&gt;</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a65a0f6a692872c6532dd6f8e95f1de44"> 1032</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">int</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a65a0f6a692872c6532dd6f8e95f1de44" title="Serves as a hash function for a particular type.">GetHashCode</a>()</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">if</span> (!_hashCodeSet)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                _hashCode = unchecked(_symbol.GetHashCode() * 397) ^ _properties.GetHashCode();</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                _hashCodeSet = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="keywordflow">return</span> _hashCode;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">        /// Override equals operator</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a1e1ea62bf3c9c0295e1da690bff87500"> 1045</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a1e1ea62bf3c9c0295e1da690bff87500" title="Override equals operator">operator ==</a>(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> left, <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> right)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ab488583adab72515b2242de5bb81cddf" title="Indicates whether the current object is equal to another object of the same type.">Equals</a>(left, right);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">        /// Override not equals operator</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a1e9cd99fc1f555967908ed4e94be0254"> 1053</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a1e9cd99fc1f555967908ed4e94be0254" title="Override not equals operator">operator !=</a>(<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> left, <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html" title="Defines a unique identifier for securities">SecurityIdentifier</a> right)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="keywordflow">return</span> !<a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#ab488583adab72515b2242de5bb81cddf" title="Indicates whether the current object is equal to another object of the same type.">Equals</a>(left, right);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">        /// Returns a string that represents the current object.</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">        /// &lt;returns&gt;</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">        /// A string that represents the current object.</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">        /// &lt;/returns&gt;</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">        /// &lt;filterpriority&gt;2&lt;/filterpriority&gt;</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1SecurityIdentifier.html#a2bad64d68f0d388b0598ab60bf862631"> 1065</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a2bad64d68f0d388b0598ab60bf862631" title="Returns a string that represents the current object.">ToString</a>()</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="keywordflow">if</span> (_stringRep == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                var props = _properties.EncodeBase36();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                props = props.Length == 0 ? <span class="stringliteral">&quot;0&quot;</span> : props;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                _stringRep = <a class="code" href="classQuantConnect_1_1SecurityIdentifier.html#a5059861c7d374e28ce5ba85ed7da25f3" title="Gets whether or not this SecurityIdentifier is a derivative, that is, it has a valid Underlying prope...">HasUnderlying</a> ? $<span class="stringliteral">&quot;{_symbol} {props}|{_underlying}&quot;</span> : $<span class="stringliteral">&quot;{_symbol} {props}&quot;</span>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">return</span> _stringRep;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4ab6b4cc6a7edbff49100e9123df213f.html">Common</a></li><li class="navelem"><b>SecurityIdentifier.cs</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
