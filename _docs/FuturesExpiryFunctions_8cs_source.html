<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lean: Common/Securities/Future/FuturesExpiryFunctions.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lean
   &#160;<span id="projectnumber">$LEAN_TAG$</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('FuturesExpiryFunctions_8cs_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">FuturesExpiryFunctions.cs</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * QUANTCONNECT.COM - Democratizing Finance, Empowering Individuals.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Lean Algorithmic Trading Engine v2.0. Copyright 2014 QuantConnect Corporation.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * limitations under the License.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using</span> System;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using</span> System.Linq;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceQuantConnect_1_1Securities_1_1Future.html">QuantConnect.Securities.Future</a></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">    /// Calculate the date of a futures expiry given an expiry month and year</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">    /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html">   25</a></span>&#160;<span class="comment"></span>    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html" title="Calculate the date of a futures expiry given an expiry month and year">FuturesExpiryFunctions</a></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {<span class="comment"></span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">        /// Method to retrieve the Function for a specific future symbol</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a0d6bb7f1fd71689f70b115ccb0f470e0">   30</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> Func&lt;DateTime, DateTime&gt; <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a0d6bb7f1fd71689f70b115ccb0f470e0" title="Method to retrieve the Function for a specific future symbol">FuturesExpiryFunction</a>(<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a> symbol)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            Func&lt;DateTime, DateTime&gt; result;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a33b2df9e17448b6c6cfa51238a0b07c8" title="Dictionary of the Functions that calculates the expiry for a given year and month....">FuturesExpiryDictionary</a>.TryGetValue(symbol.<a class="code" href="classQuantConnect_1_1Symbol.html#ab3edde4a23080d9beaa6106a2ecaccd4" title="Get&#39;s the canonical representation of this symbol">Canonical</a>, out result))</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="comment">// If the function cannot be found, throw an exception as it hasn&#39;t yet been implemented</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException($<span class="stringliteral">&quot;Expiry function not implemented for {symbol} in FuturesExpiryFunctions.FuturesExpiryDictionary&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">        /// The USDA publishes a report containing contract prices for the contract month.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">        /// You can see future publication dates at https://www.ams.usda.gov/rules-regulations/mmr/dmr (Advanced and Class Price Release Dates)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">        /// These dates are erratic and requires maintenance of a separate list instead of using holiday entries in MHDB.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">        /// &lt;remarks&gt;We only report the publication date of the report. In order to get accurate last trade dates, subtract one (plus holidays) from the value&#39;s date&lt;/remarks&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a4ecf08150419248119b772fdc6d7313b">   48</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> Dictionary&lt;DateTime, DateTime&gt; <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a4ecf08150419248119b772fdc6d7313b" title="The USDA publishes a report containing contract prices for the contract month. You can see future pub...">DairyReportDates</a> = <span class="keyword">new</span> Dictionary&lt;DateTime, DateTime&gt;()</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 3, 1), <span class="keyword">new</span> DateTime(2012, 4, 2) },</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 4, 1), <span class="keyword">new</span> DateTime(2012, 5, 2) },</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 5, 1), <span class="keyword">new</span> DateTime(2012, 5, 31) },</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 6, 1), <span class="keyword">new</span> DateTime(2012, 7, 5) },</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 7, 1), <span class="keyword">new</span> DateTime(2012, 8, 1) },</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 8, 1), <span class="keyword">new</span> DateTime(2012, 8, 29) },</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 9, 1), <span class="keyword">new</span> DateTime(2012, 10, 3) },</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 10, 1), <span class="keyword">new</span> DateTime(2012, 10, 31) },</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 11, 1), <span class="keyword">new</span> DateTime(2012, 12, 5) },</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            {<span class="keyword">new</span> DateTime(2012, 12, 1), <span class="keyword">new</span> DateTime(2013, 1, 3) },</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 1, 1), <span class="keyword">new</span> DateTime(2013, 1, 30) },</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 2, 1), <span class="keyword">new</span> DateTime(2013, 2, 27) },</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 3, 1), <span class="keyword">new</span> DateTime(2013, 4, 3) },</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 4, 1), <span class="keyword">new</span> DateTime(2013, 5, 1) },</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 5, 1), <span class="keyword">new</span> DateTime(2013, 6, 5) },</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 6, 1), <span class="keyword">new</span> DateTime(2013, 7, 3) },</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 7, 1), <span class="keyword">new</span> DateTime(2013, 7, 31) },</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 8, 1), <span class="keyword">new</span> DateTime(2013, 9, 5) },</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 9, 1), <span class="keyword">new</span> DateTime(2013, 10, 18) },</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 10, 1), <span class="keyword">new</span> DateTime(2013, 10, 30) },</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 11, 1), <span class="keyword">new</span> DateTime(2013, 12, 4) },</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            {<span class="keyword">new</span> DateTime(2013, 12, 1), <span class="keyword">new</span> DateTime(2014, 1, 2) },</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 1, 1), <span class="keyword">new</span> DateTime(2014, 2, 5) },</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 2, 1), <span class="keyword">new</span> DateTime(2014, 3, 5) },</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 3, 1), <span class="keyword">new</span> DateTime(2014, 4, 2) },</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 4, 1), <span class="keyword">new</span> DateTime(2014, 4, 30) },</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 5, 1), <span class="keyword">new</span> DateTime(2014, 6, 4) },</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 6, 1), <span class="keyword">new</span> DateTime(2014, 7, 2) },</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 7, 1), <span class="keyword">new</span> DateTime(2014, 7, 30) },</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 8, 1), <span class="keyword">new</span> DateTime(2014, 9, 4) },</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 9, 1), <span class="keyword">new</span> DateTime(2014, 10, 1) },</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 10, 1), <span class="keyword">new</span> DateTime(2014, 11, 5) },</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 11, 1), <span class="keyword">new</span> DateTime(2014, 12, 3) },</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            {<span class="keyword">new</span> DateTime(2014, 12, 1), <span class="keyword">new</span> DateTime(2014, 12, 31) },</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 1, 1), <span class="keyword">new</span> DateTime(2015, 2, 4) },</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 2, 1), <span class="keyword">new</span> DateTime(2015, 3, 4) },</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 3, 1), <span class="keyword">new</span> DateTime(2015, 4, 1) },</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 4, 1), <span class="keyword">new</span> DateTime(2015, 4, 29) },</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 5, 1), <span class="keyword">new</span> DateTime(2015, 6, 3) },</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 6, 1), <span class="keyword">new</span> DateTime(2015, 7, 1) },</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 7, 1), <span class="keyword">new</span> DateTime(2015, 8, 5) },</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 8, 1), <span class="keyword">new</span> DateTime(2015, 9, 2) },</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 9, 1), <span class="keyword">new</span> DateTime(2015, 9, 30) },</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 10, 1), <span class="keyword">new</span> DateTime(2015, 11, 4) },</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 11, 1), <span class="keyword">new</span> DateTime(2015, 12, 2) },</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            {<span class="keyword">new</span> DateTime(2015, 12, 1), <span class="keyword">new</span> DateTime(2015, 12, 30) },</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 1, 1), <span class="keyword">new</span> DateTime(2016, 2, 3) },</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 2, 1), <span class="keyword">new</span> DateTime(2016, 3, 2) },</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 3, 1), <span class="keyword">new</span> DateTime(2016, 3, 30) },</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 4, 1), <span class="keyword">new</span> DateTime(2016, 5, 4) },</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 5, 1), <span class="keyword">new</span> DateTime(2016, 6, 2) },</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 6, 1), <span class="keyword">new</span> DateTime(2016, 6, 29) },</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 7, 1), <span class="keyword">new</span> DateTime(2016, 8, 3) },</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 8, 1), <span class="keyword">new</span> DateTime(2016, 8, 31) },</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 9, 1), <span class="keyword">new</span> DateTime(2016, 10, 5) },</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 10, 1), <span class="keyword">new</span> DateTime(2016, 11, 2) },</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 11, 1), <span class="keyword">new</span> DateTime(2016, 11, 30) },</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            {<span class="keyword">new</span> DateTime(2016, 12, 1), <span class="keyword">new</span> DateTime(2017, 1, 5) },</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 1, 1), <span class="keyword">new</span> DateTime(2017, 2, 1) },</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 2, 1), <span class="keyword">new</span> DateTime(2017, 3, 1) },</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 3, 1), <span class="keyword">new</span> DateTime(2017, 4, 5) },</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 4, 1), <span class="keyword">new</span> DateTime(2017, 5, 3) },</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 5, 1), <span class="keyword">new</span> DateTime(2017, 6, 1) },</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 6, 1), <span class="keyword">new</span> DateTime(2017, 6, 28) },</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 7, 1), <span class="keyword">new</span> DateTime(2017, 8, 2) },</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 8, 1), <span class="keyword">new</span> DateTime(2017, 8, 30) },</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 9, 1), <span class="keyword">new</span> DateTime(2017, 10, 4) },</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 10, 1), <span class="keyword">new</span> DateTime(2017, 11, 1) },</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 11, 1), <span class="keyword">new</span> DateTime(2017, 11, 29) },</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            {<span class="keyword">new</span> DateTime(2017, 12, 1), <span class="keyword">new</span> DateTime(2018, 1, 4) },</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 1, 1), <span class="keyword">new</span> DateTime(2018, 1, 31) },</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 2, 1), <span class="keyword">new</span> DateTime(2018, 2, 28) },</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 3, 1), <span class="keyword">new</span> DateTime(2018, 4, 4) },</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 4, 1), <span class="keyword">new</span> DateTime(2018, 5, 2) },</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 5, 1), <span class="keyword">new</span> DateTime(2018, 5, 31) },</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 6, 1), <span class="keyword">new</span> DateTime(2018, 7, 5) },</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 7, 1), <span class="keyword">new</span> DateTime(2018, 8, 1) },</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 8, 1), <span class="keyword">new</span> DateTime(2018, 8, 29) },</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 9, 1), <span class="keyword">new</span> DateTime(2018, 10, 3) },</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 10, 1), <span class="keyword">new</span> DateTime(2018, 10, 31) },</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 11, 1), <span class="keyword">new</span> DateTime(2018, 12, 5) },</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            {<span class="keyword">new</span> DateTime(2018, 12, 1), <span class="keyword">new</span> DateTime(2019, 1, 3) },</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 1, 1), <span class="keyword">new</span> DateTime(2019, 1, 30) },</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 2, 1), <span class="keyword">new</span> DateTime(2019, 2, 27) },</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 3, 1), <span class="keyword">new</span> DateTime(2019, 4, 3) },</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 4, 1), <span class="keyword">new</span> DateTime(2019, 5, 1) },</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 5, 1), <span class="keyword">new</span> DateTime(2019, 6, 5) },</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 6, 1), <span class="keyword">new</span> DateTime(2019, 7, 3) },</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 7, 1), <span class="keyword">new</span> DateTime(2019, 7, 31) },</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 8, 1), <span class="keyword">new</span> DateTime(2019, 9, 5) },</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 9, 1), <span class="keyword">new</span> DateTime(2019, 10, 2) },</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 10, 1), <span class="keyword">new</span> DateTime(2019, 10, 30) },</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 11, 1), <span class="keyword">new</span> DateTime(2019, 12, 4) },</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 12, 1), <span class="keyword">new</span> DateTime(2020, 1, 2) },</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 1, 1), <span class="keyword">new</span> DateTime(2020, 2, 5) },</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 2, 1), <span class="keyword">new</span> DateTime(2020, 3, 4) },</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 3, 1), <span class="keyword">new</span> DateTime(2020, 4, 1) },</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 4, 1), <span class="keyword">new</span> DateTime(2020, 4, 29) },</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 5, 1), <span class="keyword">new</span> DateTime(2020, 6, 3) },</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 6, 1), <span class="keyword">new</span> DateTime(2020, 7, 1) },</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 7, 1), <span class="keyword">new</span> DateTime(2020, 8, 5) },</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 8, 1), <span class="keyword">new</span> DateTime(2020, 9, 2) },</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 9, 1), <span class="keyword">new</span> DateTime(2020, 9, 30) },</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 10, 1), <span class="keyword">new</span> DateTime(2020, 11, 4) },</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 11, 1), <span class="keyword">new</span> DateTime(2020, 12, 2) },</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 12, 1), <span class="keyword">new</span> DateTime(2020, 12, 30) },</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 1, 1), <span class="keyword">new</span> DateTime(2021, 2, 3) },</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 2, 1), <span class="keyword">new</span> DateTime(2021, 3, 3) },</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 3, 1), <span class="keyword">new</span> DateTime(2021, 3, 31) },</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 4, 1), <span class="keyword">new</span> DateTime(2021, 5, 5) },</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 5, 1), <span class="keyword">new</span> DateTime(2021, 6, 3) },</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 6, 1), <span class="keyword">new</span> DateTime(2021, 6, 30) },</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 7, 1), <span class="keyword">new</span> DateTime(2021, 8, 4) },</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 8, 1), <span class="keyword">new</span> DateTime(2021, 9, 1) },</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 9, 1), <span class="keyword">new</span> DateTime(2021, 9, 29) },</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 10, 1), <span class="keyword">new</span> DateTime(2021, 11, 3) },</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 11, 1), <span class="keyword">new</span> DateTime(2021, 12, 1) },</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 12, 1), <span class="keyword">new</span> DateTime(2022, 1, 5) },</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 1, 1), <span class="keyword">new</span> DateTime(2022, 2, 2) },</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 2, 1), <span class="keyword">new</span> DateTime(2022, 3, 2) },</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 3, 1), <span class="keyword">new</span> DateTime(2022, 3, 30) },</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 4, 1), <span class="keyword">new</span> DateTime(2022, 5, 4) },</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 5, 1), <span class="keyword">new</span> DateTime(2022, 6, 2) },</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 6, 1), <span class="keyword">new</span> DateTime(2022, 6, 29) },</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 7, 1), <span class="keyword">new</span> DateTime(2022, 8, 3) },</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 8, 1), <span class="keyword">new</span> DateTime(2022, 8, 31) },</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 9, 1), <span class="keyword">new</span> DateTime(2022, 10, 5) },</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 10, 1), <span class="keyword">new</span> DateTime(2022, 11, 2) },</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 11, 1), <span class="keyword">new</span> DateTime(2022, 11, 30) },</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 12, 1), <span class="keyword">new</span> DateTime(2023, 1, 5) },</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        };</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">        /// Enbridge&#39;s Notice of Shipment report dates. Used to calculate the last trade date for CSW</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">        /// &lt;remarks&gt;Subtract a day from the value&#39;s date in order to get the last trade date&lt;/remarks&gt;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a4b2fbfcd2df2c157bca020c1fe7d9b40">  186</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> Dictionary&lt;DateTime, DateTime&gt; <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a4b2fbfcd2df2c157bca020c1fe7d9b40" title="Enbridge&#39;s Notice of Shipment report dates. Used to calculate the last trade date for CSW">EnbridgeNoticeOfShipmentDates</a> = <span class="keyword">new</span> Dictionary&lt;DateTime, DateTime&gt;()</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 6, 1), <span class="keyword">new</span> DateTime(2019, 5, 17) },</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 7, 1), <span class="keyword">new</span> DateTime(2019, 6, 15) },</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 8, 1), <span class="keyword">new</span> DateTime(2019, 7, 17) },</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 9, 1), <span class="keyword">new</span> DateTime(2019, 8, 16) },</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 10, 1), <span class="keyword">new</span> DateTime(2019, 9, 14) },</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 11, 1), <span class="keyword">new</span> DateTime(2019, 10, 17) },</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            {<span class="keyword">new</span> DateTime(2019, 12, 1), <span class="keyword">new</span> DateTime(2019, 11, 15) },</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 1, 1), <span class="keyword">new</span> DateTime(2019, 12, 14) },</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 2, 1), <span class="keyword">new</span> DateTime(2020, 1, 22) },</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 3, 1), <span class="keyword">new</span> DateTime(2020, 2, 21) },</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 4, 1), <span class="keyword">new</span> DateTime(2020, 3, 21) },</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 5, 1), <span class="keyword">new</span> DateTime(2020, 4, 21) },</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 6, 1), <span class="keyword">new</span> DateTime(2020, 5, 21) },</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 7, 1), <span class="keyword">new</span> DateTime(2020, 6, 23) },</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 8, 1), <span class="keyword">new</span> DateTime(2020, 7, 21) },</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 9, 1), <span class="keyword">new</span> DateTime(2020, 8, 21) },</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 10, 1), <span class="keyword">new</span> DateTime(2020, 9, 22) },</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 11, 1), <span class="keyword">new</span> DateTime(2020, 10, 21) },</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            {<span class="keyword">new</span> DateTime(2020, 12, 1), <span class="keyword">new</span> DateTime(2020, 11, 21) },</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 1, 1), <span class="keyword">new</span> DateTime(2020, 12, 22) },</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 2, 1), <span class="keyword">new</span> DateTime(2021, 1, 21) },</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 3, 1), <span class="keyword">new</span> DateTime(2021, 2, 23) },</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 4, 1), <span class="keyword">new</span> DateTime(2021, 3, 23) },</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 5, 1), <span class="keyword">new</span> DateTime(2021, 4, 21) },</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 6, 1), <span class="keyword">new</span> DateTime(2021, 5, 21) },</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 7, 1), <span class="keyword">new</span> DateTime(2021, 6, 22) },</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 8, 1), <span class="keyword">new</span> DateTime(2021, 7, 21) },</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 9, 1), <span class="keyword">new</span> DateTime(2021, 8, 21) },</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 10, 1), <span class="keyword">new</span> DateTime(2021, 9, 21) },</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 11, 1), <span class="keyword">new</span> DateTime(2021, 10, 21) },</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            {<span class="keyword">new</span> DateTime(2021, 12, 1), <span class="keyword">new</span> DateTime(2021, 11, 23) },</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 1, 1), <span class="keyword">new</span> DateTime(2021, 12, 21) },</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 2, 1), <span class="keyword">new</span> DateTime(2022, 1, 21) },</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 3, 1), <span class="keyword">new</span> DateTime(2022, 2, 23) },</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 4, 1), <span class="keyword">new</span> DateTime(2022, 3, 22) },</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 5, 1), <span class="keyword">new</span> DateTime(2022, 4, 21) },</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 6, 1), <span class="keyword">new</span> DateTime(2022, 5, 21) },</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 7, 1), <span class="keyword">new</span> DateTime(2022, 6, 21) },</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 8, 1), <span class="keyword">new</span> DateTime(2022, 7, 21) },</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 9, 1), <span class="keyword">new</span> DateTime(2022, 8, 23) },</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 10, 1), <span class="keyword">new</span> DateTime(2022, 9, 21) },</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 11, 1), <span class="keyword">new</span> DateTime(2022, 10, 21) },</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            {<span class="keyword">new</span> DateTime(2022, 12, 1), <span class="keyword">new</span> DateTime(2022, 11, 22) },</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        };</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">        /// Dictionary of the Functions that calculates the expiry for a given year and month.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">        /// It does not matter what the day and time of day are passed into the Functions.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">        /// The Functions is responsible for calculating the day and time of day given a year and month</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a33b2df9e17448b6c6cfa51238a0b07c8">  238</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> readonly Dictionary&lt;Symbol, Func&lt;DateTime, DateTime&gt;&gt; <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a33b2df9e17448b6c6cfa51238a0b07c8" title="Dictionary of the Functions that calculates the expiry for a given year and month....">FuturesExpiryDictionary</a> = <span class="keyword">new</span> Dictionary&lt;Symbol, Func&lt;DateTime, DateTime&gt;&gt;()</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">// Metals</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">// Gold (GC): http://www.cmegroup.com/trading/metals/precious/gold_contract_specifications.html</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a76c64bbbdd445c6db12bc87ac2f93970" title="Gold Futures">Gold</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the delivery month.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a76c64bbbdd445c6db12bc87ac2f93970" title="Gold Futures">Gold</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time,3, holidays);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                })</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            },</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">// Silver (SI): http://www.cmegroup.com/trading/metals/precious/silver_contract_specifications.html</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a10f664e63a46a6fabfd59461b114d10f" title="Silver Futures">Silver</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the delivery month.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a10f664e63a46a6fabfd59461b114d10f" title="Silver Futures">Silver</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time,3, holidays);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                })</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            },</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">// Platinum (PL): http://www.cmegroup.com/trading/metals/precious/platinum_contract_specifications.html</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a6a9ee60ae879d8d0c58c4968b7955212" title="Platinum Futures">Platinum</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the delivery month.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a6a9ee60ae879d8d0c58c4968b7955212" title="Platinum Futures">Platinum</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time,3, holidays);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                })</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            },</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">// Palladium (PA): http://www.cmegroup.com/trading/metals/precious/palladium_contract_specifications.html</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a172420fc7cf66d78059d780bc062d0ec" title="Palladium Futures">Palladium</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the delivery month.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a172420fc7cf66d78059d780bc062d0ec" title="Palladium Futures">Palladium</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time,3, holidays);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                })</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            },</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="comment">// Aluminum MW U.S. Transaction Premium Platts (25MT) (AUP): https://www.cmegroup.com/trading/metals/base/aluminum-mw-us-transaction-premium-platts-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a94eab320bc5efedafa5e8af9bd3ee685" title="Aluminum MW U.S. Transaction Premium Platts (25MT) Futures">AluminumMWUSTransactionPremiumPlatts25MT</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a94eab320bc5efedafa5e8af9bd3ee685" title="Aluminum MW U.S. Transaction Premium Platts (25MT) Futures">AluminumMWUSTransactionPremiumPlatts25MT</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                })</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            },</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">// Aluminium European Premium Duty-Paid (Metal Bulletin) (EDP): https://www.cmegroup.com/trading/metals/base/aluminium-european-premium-duty-paid-metal-bulletin_contract_specifications.html</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#af2b65299ff5841bed435ae2fec49010f" title="Aluminium European Premium Duty-Paid (Metal Bulletin) Futures">AluminiumEuropeanPremiumDutyPaidMetalBulletin</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#af2b65299ff5841bed435ae2fec49010f" title="Aluminium European Premium Duty-Paid (Metal Bulletin) Futures">AluminiumEuropeanPremiumDutyPaidMetalBulletin</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                })</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            },</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">// Copper (HG): https://www.cmegroup.com/trading/metals/base/copper_contract_specifications.html</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a45356c1c29ad049572a85fa8e8d57a57" title="Copper Futures">Copper</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a45356c1c29ad049572a85fa8e8d57a57" title="Copper Futures">Copper</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <span class="comment">// Trading terminates at 12:00 Noon CT on the third last business day of the contract month.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays).Add(<span class="keyword">new</span> TimeSpan(17, 0, 0));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                })</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            },</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">// U.S. Midwest Domestic Hot-Rolled Coil Steel (CRU) Index (HRC): https://www.cmegroup.com/trading/metals/ferrous/hrc-steel_contract_specifications.html</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a7fc7944e5ffe13d1d33440a2a99342ab" title="U.S. Midwest Domestic Hot-Rolled Coil Steel (CRU) Index Futures">USMidwestDomesticHotRolledCoilSteelCRUIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a7fc7944e5ffe13d1d33440a2a99342ab" title="U.S. Midwest Domestic Hot-Rolled Coil Steel (CRU) Index Futures">USMidwestDomesticHotRolledCoilSteelCRUIndex</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="comment">// Trading terminates on the business day prior to the last Wednesday of the named contract month.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    var lastWednesday = (from dateRange in Enumerable.Range(1, DateTime.DaysInMonth(time.Year, time.Month))</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                         where <span class="keyword">new</span> DateTime(time.Year, time.Month, dateRange).DayOfWeek == DayOfWeek.Wednesday</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                         select <span class="keyword">new</span> DateTime(time.Year, time.Month, dateRange)).Last();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastWednesday, -1, holidays);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                })</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            },</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="comment">// Indices</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="comment">// SP500EMini (ES): http://www.cmegroup.com/trading/equity-index/us-index/e-mini-sandp500_contract_specifications.html</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a49b98ee4a69fe7f86a8dfe7acf4e8a07" title="E-mini&#160;S&amp;P&#160;500 Futures">SP500EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    <span class="comment">// Quarterly contracts (Mar/3, Jun/6 , Sep/9 , Dec/12) listed for 9 consecutive quarters and 3 additional December contract months.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="comment">// Trading can occur up to 9:30 a.m. Eastern Time (ET) on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                })</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            },</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="comment">// NASDAQ100EMini (NQ): http://www.cmegroup.com/trading/equity-index/us-index/e-mini-nasdaq-100_contract_specifications.html</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aefb26665c0bb04b4d5861f62c17a36e8" title="E-mini&#160;NASDAQ&#160;100 Futures">NASDAQ100EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    <span class="comment">// Trading can occur up to 9:30 a.m. Eastern Time (ET) on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                })</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            },</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="comment">// Dow30EMini (YM): http://www.cmegroup.com/trading/equity-index/us-index/e-mini-dow_contract_specifications.html</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a74486a91ed067dd2a117596eb2daa72c" title="E-mini&#160;Dow&#160;Indu 30 Futures">Dow30EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 4 consecutive quarters</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    <span class="comment">// Trading can occur up to 9:30 a.m. Eastern Time (ET) on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                })</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            },</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="comment">// Russell2000EMini (RTY): https://www.cmegroup.com/trading/equity-index/us-index/e-mini-russell-2000_contract_specifications.html</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a10685a24257492190b203e6d7d862391" title="E-mini Russell 2000 Futures">Russell2000EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <span class="comment">// Trading can occur up to 9:30 a.m. Eastern Time (ET) on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan (13,30,0));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                })</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            },</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="comment">// Nikkei225Dollar (NKD): https://www.cmegroup.com/trading/equity-index/international-index/nikkei-225-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#af66343dcac31d15b1ff48906d6066aa8" title="Nikkei-225 Dollar Futures">Nikkei225Dollar</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#af66343dcac31d15b1ff48906d6066aa8" title="Nikkei-225 Dollar Futures">Nikkei225Dollar</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 12 quarters, and 3 additional Dec contract months</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="comment">// Trading terminates at 5:00 p.m. Eastern Time (ET) on Business Day prior to 2nd Friday of the contract month.</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    var secondFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a6099b084e8edfa30928ea5e275208d95" title="Method to retrieve the 2nd Friday of the given month">SecondFriday</a>(time);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    var priorBusinessDay = secondFriday.AddDays(-1);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(priorBusinessDay, holidays))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        priorBusinessDay = priorBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <span class="keywordflow">return</span> priorBusinessDay.Add(TimeSpan.FromHours(21));</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                })</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            },</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">// Nikkei225YenCME (NIY): https://www.cmegroup.com/markets/equities/international-indices/nikkei-225-yen.contractSpecs.html</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aaca8979514fe6cec0ca6c51d9520a5ae" title="Nikkei-225 Yen denominated Futures on CME">Nikkei225YenCME</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aaca8979514fe6cec0ca6c51d9520a5ae" title="Nikkei-225 Yen denominated Futures on CME">Nikkei225YenCME</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 12 quarters, serial contract listed for 3 months, and 3 additional Dec contract months</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    <span class="comment">// Trading terminates at 5:00 p.m. Eastern Time (ET) on Business Day prior to 2nd Friday of the contract month.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    var secondFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a6099b084e8edfa30928ea5e275208d95" title="Method to retrieve the 2nd Friday of the given month">SecondFriday</a>(time);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    var priorBusinessDay = secondFriday.AddDays(-1);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(priorBusinessDay, holidays))</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        priorBusinessDay = priorBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    <span class="keywordflow">return</span> priorBusinessDay.Add(TimeSpan.FromHours(21));</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                })</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            },</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="comment">// Nikkei225YenEMini (ENY): https://www.cmegroup.com/markets/equities/international-indices/emini-nikkei-225-yen.contractSpecs.html</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a153aee5056ddfc5fe2043feb8b29b620">Nikkei225YenEMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a153aee5056ddfc5fe2043feb8b29b620">Nikkei225YenEMini</a>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    <span class="comment">// Four months in the March Quarterly Cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    <span class="comment">// Trading terminates at 5:00 p.m. Eastern Time (ET) on Business Day prior to 2nd Friday of the contract month.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    var secondFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a6099b084e8edfa30928ea5e275208d95" title="Method to retrieve the 2nd Friday of the given month">SecondFriday</a>(time);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    var priorBusinessDay = secondFriday.AddDays(-1);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(priorBusinessDay, holidays))</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                        priorBusinessDay = priorBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    <span class="keywordflow">return</span> priorBusinessDay.Add(TimeSpan.FromHours(21));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                })</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            },</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="comment">// FTSEChina50EMini (FT5): https://www.cmegroup.com/markets/equities/international-indices/e-mini-ftse-china-50-index.contractSpecs.html</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a503f4cc0818794071f90449fa00e185f">FTSEChina50EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a503f4cc0818794071f90449fa00e185f">FTSEChina50EMini</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    <span class="comment">//Contracts listed for the  2 nearest serial and 4 quarterly months.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="comment">//Trading terminates on the second to last business day of the contract month at the end of trading on the Hong Kong Exchange Securities Market</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    var secondLastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time,2, holidays);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(secondLastBusinessDay, holidays))</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        secondLastBusinessDay = secondLastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <span class="keywordflow">return</span> secondLastBusinessDay.Add(TimeSpan.FromHours(6));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                })</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            },</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="comment">// FTSE100EMini (FT1): https://www.cmegroup.com/markets/equities/international-indices/e-mini-ftse-100-index.contractSpecs.html</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ae4071f39b4ae85c87c3225cf3d2d491e">FTSE100EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ae4071f39b4ae85c87c3225cf3d2d491e">FTSE100EMini</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="comment">//Contracts listed for five months in the March Quarterly Cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    <span class="comment">//Trading terminates on the third Friday of the contract month</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <span class="keywordflow">return</span> thirdFriday;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                })</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            },</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="comment">// SPEurop350ESGEMini (E3G): https://www.cmegroup.com/markets/equities/international-indices/e-mini-sp-europe-350-esg-index.contractSpecs.html</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#af6ddb1603fb45a29b2d30eb0c30284e4">SPEurop350ESGEMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#af6ddb1603fb45a29b2d30eb0c30284e4">SPEurop350ESGEMini</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    <span class="comment">//Contracts listed for 5 months in the March Quarterly Cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    <span class="comment">//Trading terminates on the 3rd Friday of contract delivery month.</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    <span class="keywordflow">return</span> thirdFriday;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                })</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            },</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="comment">// FTSE100USDEMini (FTU): https://www.cmegroup.com/markets/equities/international-indices/e-mini-sp-europe-350-esg-index.contractSpecs.html</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a6eb9fa6c8ab51555fbb1a972a7a11d5f">FTSE100USDEMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a6eb9fa6c8ab51555fbb1a972a7a11d5f">FTSE100USDEMini</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    <span class="comment">//Contracts listed for five months in the March Quarterly Cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    <span class="comment">//Trading terminates on the third Friday of the contract month.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    <span class="keywordflow">return</span> thirdFriday;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                })</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            },</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="comment">// TOPIXUSD (TPD): https://www.cmegroup.com/markets/equities/international-indices/usd-denominated-topix-index.contractSpecs.html</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a60b9bbf3c4a62109ed9a7c0919e64e57">TOPIXUSD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a60b9bbf3c4a62109ed9a7c0919e64e57">TOPIXUSD</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    <span class="comment">//Quarterly Contracts listed for (Mar, Jun, Sep, Dec) for 5 months</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <span class="comment">//Trading terminates at 5:00 p.m. ET on the Thursday prior to the second Friday of the contract month.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    var secondFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,2);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    var thursdaypriorsecondFriday = secondFriday.AddDays(-1);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thursdaypriorsecondFriday, holidays))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        thursdaypriorsecondFriday = thursdaypriorsecondFriday.AddDays(-1);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <span class="keywordflow">return</span> thursdaypriorsecondFriday.Add(TimeSpan.FromHours(21));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                })</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            },</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="comment">// TOPIXYEN (TPY): https://www.cmegroup.com/markets/equities/international-indices/usd-denominated-topix-index.contractSpecs.html</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7e67c04243096180f85734cefcdc89a6">TOPIXYEN</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7e67c04243096180f85734cefcdc89a6">TOPIXYEN</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                    <span class="comment">//Quarterly Contracts listed for (Mar, Jun, Sep, Dec) for 5 months</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                    <span class="comment">//Trading terminates at 5:00 p.m. ET on the Thursday prior to the second Friday of the contract month.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                    var secondFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,2);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    var thursdaypriorsecondFriday = secondFriday.AddDays(-1);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thursdaypriorsecondFriday, holidays))</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                        thursdaypriorsecondFriday = thursdaypriorsecondFriday.AddDays(-1);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                    <span class="keywordflow">return</span> thursdaypriorsecondFriday.Add(TimeSpan.FromHours(21));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                })</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            },</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="comment">// DowJonesRealEstate (RX): https://www.cmegroup.com/markets/equities/dow-jones/dow-jones-rei.contractSpecs.html</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a2118ce60c4580f32158b1919dc1652cc">DowJonesRealEstate</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a2118ce60c4580f32158b1919dc1652cc">DowJonesRealEstate</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    <span class="comment">//Quarterly contracts (Mar, Jun, Sep, Dec) listed for 4 consecutive quarters</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    <span class="comment">//Trading can occur up to 9:30 a.m. ET on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                })</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            },</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="comment">// SP500EMiniESG (ESG): https://www.cmegroup.com/markets/equities/sp/e-mini-sandp-500-esg-index.contractSpecs.html</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a6f54955fd0ea6e478426908c9fceb4ae">SP500EMiniESG</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a6f54955fd0ea6e478426908c9fceb4ae">SP500EMiniESG</a>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    <span class="comment">//Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    <span class="comment">//Trading terminates at 9:30 a.m. ET on the 3rd Friday of the contract month.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                })</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            },</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="comment">// Russell1000EMini (RS1): https://www.cmegroup.com/markets/equities/russell/e-mini-russell-1000-index.contractSpecs.html</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a715d7499fd5db53c68a3dbf20e7e52bd">Russell1000EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a715d7499fd5db53c68a3dbf20e7e52bd">Russell1000EMini</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    <span class="comment">//Quarterly contracts (Mar, Jun, Sep, Dec) lisrted for 5 consecutive quarters</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    <span class="comment">//Trading terminates at 9:30 a.m. ET on the 3rd Friday of the contract month.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                })</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            },</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="comment">// SP500AnnualDividendIndex (SDA): https://www.cmegroup.com/markets/equities/sp/sp-500-annual-dividend-index.contractSpecs.html</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a1337b21beefedc5cc78187b143aeba0d" title="S&amp;P 500 Annual dividend index futures on CME">SP500AnnualDividendIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a1337b21beefedc5cc78187b143aeba0d" title="S&amp;P 500 Annual dividend index futures on CME">SP500AnnualDividendIndex</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <span class="comment">//Annual contracts (December) listed for 11 consecutive years</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a2d4706817beed80236d94e624841c625" title="December Cycle: Expirations in December">December</a>.Contains(time.Month))</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <span class="comment">//Trading terminates at 9:30 a.m. ET on the 3rd Friday of the contract month.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time,3);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(thirdFriday, holidays))</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        thirdFriday = thirdFriday.AddDays(-1);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                })</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            },</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="comment">// CBOE Volatility Index Futures (VIX): https://www.cboe.com/tradable_products/vix/vix_futures/specifications/</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ae7913d65fbd94c75db067184ce254868" title="CBOE Volatility Index Futures">VIX</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a32c25a7593a58f38bbfb5e96b8307b41" title="CFE">CFE</a>), (time =&gt;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <span class="comment">// Trading can occur up to 9:00 a.m. Eastern Time (ET) on the &quot;Wednesday that is 30 days prior to</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="comment">// the third Friday of the calendar month immediately following the month in which the contract expires&quot;.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a32c25a7593a58f38bbfb5e96b8307b41" title="CFE">CFE</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ae7913d65fbd94c75db067184ce254868" title="CBOE Volatility Index Futures">VIX</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    var nextThirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time.AddMonths(1));</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    var expiryDate = nextThirdFriday.AddDays(-30);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    <span class="comment">// If the next third Friday or the Wednesday are holidays, then it is moved to the previous day.</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <span class="keywordflow">if</span> (holidays.Contains(expiryDate) || holidays.Contains(nextThirdFriday))</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                        expiryDate = expiryDate.AddDays(-1);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    <span class="comment">// Trading hours for expiring VX futures contracts end at 8:00 a.m. Chicago time on the final settlement date.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    <span class="keywordflow">return</span> expiryDate.Add(<span class="keyword">new</span> TimeSpan(13, 0, 0));</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                })</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            },</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="comment">// Bloomberg Commodity Index (AW): https://www.cmegroup.com/trading/agricultural/commodity-index/bloomberg-commodity-index_contract_specifications.html</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aa7f358c4e351792fa45124a034ef39b6" title="Bloomberg Commodity Index Futures">BloombergCommodityIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aa7f358c4e351792fa45124a034ef39b6" title="Bloomberg Commodity Index Futures">BloombergCommodityIndex</a>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 4 consecutive quarters and 4 additional Dec contract months</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    <span class="comment">// 3rd Wednesday of the contract month/ 1:30pm</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                    thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(thirdWednesday, -1, holidays);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <span class="keywordflow">return</span> thirdWednesday.Add(<span class="keyword">new</span> TimeSpan(18, 30, 0));</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                })</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            },</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="comment">// E-mini Nasdaq-100 Biotechnology Index (BIO): https://www.cmegroup.com/trading/equity-index/us-index/e-mini-nasdaq-biotechnology_contract_specifications.html</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#acf5958f3264b6d5d021d83330dcafeef" title="E-mini Nasdaq-100 Biotechnology Index Futures">NASDAQ100BiotechnologyEMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#acf5958f3264b6d5d021d83330dcafeef" title="E-mini Nasdaq-100 Biotechnology Index Futures">NASDAQ100BiotechnologyEMini</a>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    <span class="comment">// Trading can occur up to 9:30 a.m. ET on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(thirdFriday, -1, holidays);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                })</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            },</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="comment">// E-mini FTSE Emerging Index (EI): https://www.cmegroup.com/trading/equity-index/international-index/e-mini-ftse-emerging-index_contract_specifications.html</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a66c09d1148700e781e104165d01949d7" title="E-mini FTSE Emerging Index Futures">FTSEEmergingEmini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    <span class="comment">// Five months in the March Quarterly Cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    <span class="comment">// Trading can occur up to 4:00 p.m. ET on the 3rd Friday of contract month</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time, 3).Add(<span class="keyword">new</span> TimeSpan(20, 0, 0));</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                })</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            },</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="comment">// E-mini S&amp;amp;P MidCap 400 Futures (EMD): https://www.cmegroup.com/trading/equity-index/us-index/e-mini-sandp-midcap-400_contract_specifications.html</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a094fb47e6ea83f704ad853dcdac38763" title="E-mini S&amp;P MidCap 400 Futures">SP400MidCapEmini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    <span class="comment">// Trading can occur up until 9:30 a.m. Eastern Time (ET) on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a52378fb319c477c06f7f2e619abe2ecd" title="Method to retrieve the Nth Friday of the given month">NthFriday</a>(time, 3).Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                })</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            },</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="comment">// S&amp;amp;P-GSCI Commodity Index (GD): https://www.cmegroup.com/trading/agricultural/commodity-index/gsci_contract_specifications.html</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7a6bb492c799b3f9ef4a07a85d9ef902" title="S&amp;P-GSCI Commodity Index Futures">SPGSCICommodity</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7a6bb492c799b3f9ef4a07a85d9ef902" title="S&amp;P-GSCI Commodity Index Futures">SPGSCICommodity</a>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    <span class="comment">// Trading terminates on the11th business day of the contract month, 1:40pm.</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a033bcd11133290ed64a7d98b4a454548" title="Calculates the n^th business day of the month (includes checking for holidays)">NthBusinessDay</a>(time, 11, holidays).Add(<span class="keyword">new</span> TimeSpan(18, 40, 0));</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                })</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            },</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="comment">// USD-Denominated Ibovespa Index (IBV): https://www.cmegroup.com/trading/equity-index/international-index/usd-denominated-ibovespa_contract_specifications.html</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aff11f07c45cbe745ec6c6a9cfce68f6a" title="USD-Denominated Ibovespa Index Futures">USDDenominatedIbovespa</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aff11f07c45cbe745ec6c6a9cfce68f6a" title="USD-Denominated Ibovespa Index Futures">USDDenominatedIbovespa</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    <span class="comment">// Four bi-monthly contracts (Feb/2, Apr/4, Jun/6, Aug/8, Oct/10, Dec/12 cycle)</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a5f17db58b481b28cace2bf5ebfdaaa14" title="GJMQVZ Cycle">GJMQVZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="comment">// 5:00 p.m. Sao Paulo Time on the Wednesday closest to the 15th calendar day of the contract month. If it is a non-trading day at BM&amp;amp;F Bovespa, trading shall terminate on the next trading day.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    var wednesdays = (from dateRange in Enumerable.Range(1, DateTime.DaysInMonth(time.Year, time.Month))</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                                               where <span class="keyword">new</span> DateTime(time.Year, time.Month, dateRange).DayOfWeek == DayOfWeek.Wednesday</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                                               select <span class="keyword">new</span> DateTime(time.Year, time.Month, dateRange));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    var distanceFromFifteenthDay = wednesdays.Select(x =&gt; Math.Abs(15 - x.Day)).ToList();</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    var wednesdayIndex = distanceFromFifteenthDay.IndexOf(distanceFromFifteenthDay.Min());</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    var closestWednesday = wednesdays.ElementAt(wednesdayIndex);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">if</span> (holidays.Contains(closestWednesday) || !<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(closestWednesday, holidays))</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                        closestWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(closestWednesday, 1, holidays);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                    <span class="keywordflow">return</span> closestWednesday.Add(<span class="keyword">new</span> TimeSpan(20, 0, 0));</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                })</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            },</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="comment">// JPY-Denominated Nikkie 225 Index Futures: https://www2.sgx.com/derivatives/products/nikkei225futuresoptions?cc=NK#Contract%20Specifications</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a49ac180eb9c93c0b629dd6f50aa1438c" title="Nikkei-225 Yen denominated Index Futures">Nikkei225Yen</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a8f5a40916c16f1e04e1ef5b1946104d2" title="Singapore Exchange">SGX</a>), (time =&gt;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    <span class="comment">// 6 nearest serial months &amp; 32 nearest quarterly months</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    <span class="comment">// The day before the second Friday of the contract month. Trading Hours on Last Day is normal Trading Hours (session T)</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="comment">// T Session</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <span class="comment">// 7.15 am - 2.30 pm</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a8f5a40916c16f1e04e1ef5b1946104d2" title="Singapore Exchange">SGX</a>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a49ac180eb9c93c0b629dd6f50aa1438c" title="Nikkei-225 Yen denominated Index Futures">Nikkei225Yen</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    var secondFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a6099b084e8edfa30928ea5e275208d95" title="Method to retrieve the 2nd Friday of the given month">SecondFriday</a>(time);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    var priorBusinessDay = secondFriday.AddDays(-1);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(priorBusinessDay) || !priorBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                        priorBusinessDay = priorBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <span class="keywordflow">return</span> priorBusinessDay.Add(<span class="keyword">new</span> TimeSpan(14, 30, 0));</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                })</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            },</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="comment">// MSCI Taiwan Index Futures: https://www2.sgx.com/derivatives/products/timsci?cc=TW</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a626a3e3a1a27ae3f59a5bad203adb019" title="USD-Denominated MSCI Taiwan Index Futures">MSCITaiwanIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a8f5a40916c16f1e04e1ef5b1946104d2" title="Singapore Exchange">SGX</a>), (time =&gt;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    <span class="comment">// 2 nearest serial months and 12 quarterly months on March, June, September and December cycle.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    <span class="comment">// Second last business day of the contract month. Same as T Session trading hours</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a8f5a40916c16f1e04e1ef5b1946104d2" title="Singapore Exchange">SGX</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a626a3e3a1a27ae3f59a5bad203adb019" title="USD-Denominated MSCI Taiwan Index Futures">MSCITaiwanIndex</a>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                    var lastDay = <span class="keyword">new</span> DateTime(time.Year, time.Month, DateTime.DaysInMonth(time.Year, time.Month));</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    var priorBusinessDay = lastDay.AddDays(-1);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(priorBusinessDay) || !priorBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                        priorBusinessDay = priorBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keywordflow">return</span> priorBusinessDay.Add(<span class="keyword">new</span> TimeSpan(13, 45, 0));</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                })</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            },</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="comment">// Nifty 50 Index Futures: https://www1.nseindia.com/products/content/derivatives/equities/contract_specifitns.htm</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ac3c496b83d94650c70755708863d56e6" title="NSE Nifty50 Index Futures">Nifty50</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#adabbf7ee019a7a781e56aba3f7f86c90" title="NSE - National Stock Exchange">India</a>), (time =&gt;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    <span class="comment">// 3 consecutive months trading cycle – Near-Month, Mid-Month and Far-Month.</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    <span class="comment">// Last Thursday of the expiring contract month. If this falls on an NSE non-business day, the last trading day shall be the preceding business day.</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    <span class="comment">// The expiring contract shall close on its last trading day at 3.30 pm.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#adabbf7ee019a7a781e56aba3f7f86c90" title="NSE - National Stock Exchange">India</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ac3c496b83d94650c70755708863d56e6" title="NSE Nifty50 Index Futures">Nifty50</a>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    var expiryday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aae9f7f77c0ccdafb4dfbbfb7215a7d0b" title="Method to retrieve the last Thursday of any month">LastThursday</a>(time);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(expiryday) || !expiryday.IsCommonBusinessDay())</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        expiryday = expiryday.AddDays(-1);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <span class="keywordflow">return</span> expiryday.Add(<span class="keyword">new</span> TimeSpan(15, 30, 0));</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                })</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            },</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="comment">// BankNifty Index Futures: https://www1.nseindia.com/products/content/derivatives/equities/bank_nifty_new.htm</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7040e1cc2c5dae3f627d8c2710f50236" title="NSE BankNifty Futures">BankNifty</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#adabbf7ee019a7a781e56aba3f7f86c90" title="NSE - National Stock Exchange">India</a>), (time =&gt;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    <span class="comment">// have a maximum of 3-month trading cycle - the near month , the next month and the far month.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    <span class="comment">// Last Thursday of the expiring contract month. If this falls on an NSE non-business day, the last trading day shall be the preceding business day.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    <span class="comment">// The expiring contract shall close on its last trading day at 3.30 pm.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#adabbf7ee019a7a781e56aba3f7f86c90" title="NSE - National Stock Exchange">India</a>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7040e1cc2c5dae3f627d8c2710f50236" title="NSE BankNifty Futures">BankNifty</a>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                    var expiryday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aae9f7f77c0ccdafb4dfbbfb7215a7d0b" title="Method to retrieve the last Thursday of any month">LastThursday</a>(time);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(expiryday) || !expiryday.IsCommonBusinessDay())</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        expiryday = expiryday.AddDays(-1);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                    <span class="keywordflow">return</span> expiryday.Add(<span class="keyword">new</span> TimeSpan(15, 30, 0));</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                })</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            },</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="comment">// BSE S&amp;P Sensex Index Futures: https://www.bseindia.com/static/markets/Derivatives/DeriReports/market_information.html#!#ach6</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aabfb74ff8f096e41ca06f9c44e7dd468" title="S&amp;P BSE Sensex Index Futures">BseSensex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#adabbf7ee019a7a781e56aba3f7f86c90" title="NSE - National Stock Exchange">India</a>), (time =&gt;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    <span class="comment">// Last Thursday of the expiring contract month. If this falls on an BSE non-business day, the last trading day shall be the preceding business day.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                    <span class="comment">// The expiring contract shall close on its last trading day at 3.30 pm.</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#adabbf7ee019a7a781e56aba3f7f86c90" title="NSE - National Stock Exchange">India</a>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#aabfb74ff8f096e41ca06f9c44e7dd468" title="S&amp;P BSE Sensex Index Futures">BseSensex</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    var expiryday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aae9f7f77c0ccdafb4dfbbfb7215a7d0b" title="Method to retrieve the last Thursday of any month">LastThursday</a>(time);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(expiryday) || !expiryday.IsCommonBusinessDay())</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                        expiryday = expiryday.AddDays(-1);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                    <span class="keywordflow">return</span> expiryday.Add(<span class="keyword">new</span> TimeSpan(15, 30, 0));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                })</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            },</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="comment">// MSCI Europe Net Total Return (USD) Futures: https://www.theice.com/products/71512951/MSCI-Europe-NTR-Index-Future-USD &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#abb4462010370e304a0f528269aec3ba0" title="MSCI Europe Net Total Return (USD) Futures">MSCIEuropeNTR</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#abb4462010370e304a0f528269aec3ba0" title="MSCI Europe Net Total Return (USD) Futures">MSCIEuropeNTR</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    <span class="comment">// Trading terminates on the third Friday of the contract month @16:15.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    var lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastTradingDay, -1, holidays);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    <span class="keywordflow">return</span> lastTradingDay.Add(<span class="keyword">new</span> TimeSpan(16, 15, 0));</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                })</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            },</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="comment">// MSCI Japan Net Total Return Futures: https://www.theice.com/products/75392111/MSCI-Japan-NTR-Index-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a2af61f423fc9be53e540841c0eabf103" title="MSCI Japan Net Total Return Futures">MSCIJapanNTR</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a2af61f423fc9be53e540841c0eabf103" title="MSCI Japan Net Total Return Futures">MSCIJapanNTR</a>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    <span class="comment">// Trading terminates on the third Friday of the contract month @16:15.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    var lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastTradingDay, -1, holidays);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                    <span class="keywordflow">return</span> lastTradingDay.Add(<span class="keyword">new</span> TimeSpan(16, 15, 0));</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                })</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            },</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="comment">// MSCI Emerging Markets Asia Net Total Return Futures: https://www.theice.com/products/32375861/MSCI-Emerging-Markets-Asia-NTR-Index-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a52929447ed652646fa98c8355f72eb90" title="MSCI Emerging Markets Asia Net Total Return Futures">MSCIEmergingMarketsAsiaNTR</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a52929447ed652646fa98c8355f72eb90" title="MSCI Emerging Markets Asia Net Total Return Futures">MSCIEmergingMarketsAsiaNTR</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="comment">// Trading terminates on the third Friday of the contract month @16:15.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    var lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastTradingDay, -1, holidays);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    <span class="keywordflow">return</span> lastTradingDay.Add(<span class="keyword">new</span> TimeSpan(16, 15, 0));</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                })</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            },</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="comment">// MSCI EAFE Index Futures: https://www.theice.com/products/31196848/MSCI-EAFE-Index-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7b91a13d15c0d0ccd35112073de0fe69" title="MSCI EAFE Index Futures">MSCIEafeIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7b91a13d15c0d0ccd35112073de0fe69" title="MSCI EAFE Index Futures">MSCIEafeIndex</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    <span class="comment">// Trading terminates on the third Friday of the contract month @16:15.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    var lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastTradingDay, -1, holidays);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    <span class="keywordflow">return</span> lastTradingDay.Add(<span class="keyword">new</span> TimeSpan(16, 15, 0));</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                })</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            },</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="comment">// MSCI Emerging Markets Index Futures: https://www.theice.com/products/31196851/MSCI-Emerging-Markets-Index-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a310dffcca23ee87a46bfc1c35c57fd93" title="MSCI Emerging Markets Index Futures">MSCIEmergingMarketsIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a310dffcca23ee87a46bfc1c35c57fd93" title="MSCI Emerging Markets Index Futures">MSCIEmergingMarketsIndex</a>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    <span class="comment">// Trading terminates on the third Friday of the contract month @16:15.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    var lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastTradingDay, -1, holidays);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    <span class="keywordflow">return</span> lastTradingDay.Add(<span class="keyword">new</span> TimeSpan(16, 15, 0));</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                })</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            },</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="comment">// MSCI USA Index Futures: https://www.theice.com/products/32375866/MSCI-USA-Index-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7b51f89b6e03a42d208f9f71c3cb78dc" title="MSCI USA Index Futures">MSCIUsaIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a7b51f89b6e03a42d208f9f71c3cb78dc" title="MSCI USA Index Futures">MSCIUsaIndex</a>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    <span class="comment">// Trading terminates on the third Friday of the contract month @16:15.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                    var lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    lastTradingDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastTradingDay, -1, holidays);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    <span class="keywordflow">return</span> lastTradingDay.Add(<span class="keyword">new</span> TimeSpan(16, 15, 0));</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                })</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            },</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="comment">// Forestry Group</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">// Random Length Lumber (LBS): https://www.cmegroup.com/trading/agricultural/lumber-and-pulp/random-length-lumber_contract_specifications.html</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html" title="Forestry group">Forestry</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html#a187c44935ecd057df4ff65445b56a620" title="Random Length Lumber Futures">RandomLengthLumber</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html" title="Forestry group">Forestry</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html#a187c44935ecd057df4ff65445b56a620" title="Random Length Lumber Futures">RandomLengthLumber</a>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                    <span class="comment">// Monthly contracts (Jan, Mar, May, Jul, Sep, Nov) listed for 7 months</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#abdd664b0966118a46ff25c906350bad6" title="FHKNUX Cycle">FHKNUX</a>.Contains(time.Month))</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                    <span class="comment">// The business day prior to the 16th calendar day of the contract month at 12:05pm CT</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                    var sixteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,16);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(sixteenth, -1, holidays).Add(<span class="keyword">new</span> TimeSpan(17, 5, 0));</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                })</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            },</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="comment">// Lumber and Softs</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="comment">// Lumber Futures (LBR): https://www.cmegroup.com/markets/agriculture/lumber-and-softs/lumber.contractSpecs.html</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html" title="Forestry group">Forestry</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html#aec24b2179527e348ec835c93f1b527e7" title="Lumber Futures">Lumber</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html" title="Forestry group">Forestry</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Forestry.html#aec24b2179527e348ec835c93f1b527e7" title="Lumber Futures">Lumber</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="comment">// Monthly contracts (Jan, Mar, May, Jul, Sep, Nov) listed for 7 months</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#abdd664b0966118a46ff25c906350bad6" title="FHKNUX Cycle">FHKNUX</a>.Contains(time.Month))</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                    <span class="comment">// The business day prior to the 16th calendar day of the contract month at 12:05pm CT</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    var sixteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month, 16);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(sixteenth, -1, holidays).Add(<span class="keyword">new</span> TimeSpan(17, 5, 0));</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                })</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            },</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="comment">// Grains And OilSeeds Group</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="comment">// Chicago SRW Wheat (ZW): http://www.cmegroup.com/trading/agricultural/grain-and-oilseed/wheat_contract_specifications.html</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a0b91bd87580d4bd25e43e9dca052f9a5" title="Chicago SRW Wheat Futures">SRWWheat</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a0b91bd87580d4bd25e43e9dca052f9a5" title="Chicago SRW Wheat Futures">SRWWheat</a>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                    <span class="comment">// 15 monthly contracts of Mar, May, Jul, Sep, Dec listed annually following the termination of trading in the July contract of the current year.</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a7f732da437ca4c5d8ea92b01a685eccc" title="HKNUZ Cycle">HKNUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                    }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                })</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            },</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="comment">// HRW Wheat (KE): https://www.cmegroup.com/trading/agricultural/grain-and-oilseed/kc-wheat_contract_specifications.html</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#ada3cfa2a30dc1b31d8ed8982e96ca950" title="KC HRW Wheat Futures">HRWWheat</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#ada3cfa2a30dc1b31d8ed8982e96ca950" title="KC HRW Wheat Futures">HRWWheat</a>;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    <span class="comment">// Monthly contracts (Mar, May, Jul, Sep, Dec) listed for  15 months</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a7f732da437ca4c5d8ea92b01a685eccc" title="HKNUZ Cycle">HKNUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                })</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            },</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="comment">// Corn (ZC): http://www.cmegroup.com/trading/agricultural/grain-and-oilseed/corn_contract_specifications.html</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a5ff389978345c72ea04d6ae5981979f5" title="Corn Futures">Corn</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a5ff389978345c72ea04d6ae5981979f5" title="Corn Futures">Corn</a>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    <span class="comment">// 9 monthly contracts of Mar/3, May/5, Sep/9 and 8 monthly contracts of Jul/7 and Dec/12 listed annually after the termination of trading in the December contract of the current year.</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a7f732da437ca4c5d8ea92b01a685eccc" title="HKNUZ Cycle">HKNUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                    {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                    }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                })</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            },</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="comment">// Soybeans (ZS): http://www.cmegroup.com/trading/agricultural/grain-and-oilseed/soybean_contract_specifications.html</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#ae61956bc68e8f581e05c6273dece57d7" title="Soybeans Futures">Soybeans</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#ae61956bc68e8f581e05c6273dece57d7" title="Soybeans Futures">Soybeans</a>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    <span class="comment">// 15 monthly contracts of Jan/1, Mar/3, May/5, Aug/8, Sep/9 and 8 monthly contracts of Jul/7 and Nov/11 listed annually after the termination of trading in the November contract of the current year.</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#ac4284c668103d418ac0a565efc2015a8" title="FHKNQUX Cycle">FHKNQUX</a>.Contains(time.Month))</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                })</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            },</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="comment">// SoybeanMeal (ZM): http://www.cmegroup.com/trading/agricultural/grain-and-oilseed/soybean-meal_contract_specifications.html</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a6e3125f441dfb65a4eaa165b079e7879" title="Soybean Meal Futures">SoybeanMeal</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a6e3125f441dfb65a4eaa165b079e7879" title="Soybean Meal Futures">SoybeanMeal</a>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                    <span class="comment">//  15 monthly contracts of Jan/1, Mar/3, May/5, Aug/8, Sep/9 and 12 monthly contracts of Jul/7, Oct/10, Dec/12 listed annually after the termination of trading in the December contract of the current year.</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#ac200d46fb1a57b7f7f9a31026bddb8dc" title="FHKMQUVZ Cycle">FHKNQUVZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                    {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                    }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                })</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            },</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="comment">// SoybeanOil (ZL): http://www.cmegroup.com/trading/agricultural/grain-and-oilseed/soybean-oil_contract_specifications.html</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a437f8ad570800cab47eb61a132646676" title="Soybean Oil Futures">SoybeanOil</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a437f8ad570800cab47eb61a132646676" title="Soybean Oil Futures">SoybeanOil</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    <span class="comment">//  15 monthly contracts of Jan/1, Mar/3, May/5, Aug/8, Sep/9 and 12 monthly contracts of Jul/7, Oct/10, Dec/12 listed annually after the termination of trading in the December contract of the current year.</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#ac200d46fb1a57b7f7f9a31026bddb8dc" title="FHKMQUVZ Cycle">FHKNQUVZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                    {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                })</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            },</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            <span class="comment">// Oats (ZO): http://www.cmegroup.com/trading/agricultural/grain-and-oilseed/oats_contract_specifications.html</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a4725486fafcdb1c93c0b5c9c9732c719" title="Oats Futures">Oats</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a4725486fafcdb1c93c0b5c9c9732c719" title="Oats Futures">Oats</a>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    <span class="comment">// Monthly contracts (Mar, May, Jul, Sep, Dec) listed for 10 months and 1 additional Jul and 1 additional Sep contract listed in September</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a7f732da437ca4c5d8ea92b01a685eccc" title="HKNUZ Cycle">HKNUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                    <span class="comment">// The business day prior to the 15th calendar day of the contract month.</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year,time.Month,15);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth,-1, holidays);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                })</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            },</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="comment">// Black Sea Corn Financially Settled (Platts) (BCF): https://www.cmegroup.com/trading/agricultural/grain-and-oilseed/black-sea-corn-financially-settled-platts_contract_specifications.html</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a452fca5bfde0b70059ced2aa1bb26895" title="Black Sea Corn Financially Settled (Platts) Futures">BlackSeaCornFinanciallySettledPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#a452fca5bfde0b70059ced2aa1bb26895" title="Black Sea Corn Financially Settled (Platts) Futures">BlackSeaCornFinanciallySettledPlatts</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                    </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                    <span class="comment">// Monthly contracts listed for 15 consecutive months.</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month which is also a Platts publication date for the price assessment.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                })</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            },</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="comment">// Black Sea Wheat Financially Settled (Platts) (BWF): https://www.cmegroup.com/trading/agricultural/grain-and-oilseed/black-sea-wheat-financially-settled-platts_contract_specifications.html</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#ad9b2321233f84b556ca097b2cc49a1f6" title="Black Sea Wheat Financially Settled (Platts) Futures">BlackSeaWheatFinanciallySettledPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html" title="Grains and Oilseeds group">Grains</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Grains.html#ad9b2321233f84b556ca097b2cc49a1f6" title="Black Sea Wheat Financially Settled (Platts) Futures">BlackSeaWheatFinanciallySettledPlatts</a>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    <span class="comment">// Monthly contracts listed for 15 consecutive months</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month which is also a Platts publication date for the price assessment.</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                })</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            },</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="comment">// Currencies group</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <span class="comment">// U.S. Dollar Index(R) Futures (DX): https://www.theice.com/products/194/US-Dollar-Index-Futures</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a9bd0552a3baee010e4f6f7aab07328e2" title="U.S. Dollar Index Futures">USD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    <span class="comment">// Four months in the March/June/September/December quarterly expiration cycle</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    <span class="comment">// Last Trading Day:</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                    <span class="comment">// Trading ceases at 10:16 Eastern time two days prior to settlement</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                    <span class="comment">// Final Settlement:</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                    <span class="comment">// The US Dollar Index is physically settled on the third Wednesday of the expiration month</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    <span class="comment">// against six component currencies (euro, Japanese yen, British pound, Canadian dollar, Swedish</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                    <span class="comment">// krona and Swiss franc) in their respective percentage weights in the Index.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    <span class="comment">// Settlement rates may be quoted to three decimal places.</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    var twoDaysPrior = thirdWednesday.AddDays(-2);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    <span class="keywordflow">return</span> twoDaysPrior.Add(<span class="keyword">new</span> TimeSpan(10, 16, 0));</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                })</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            },</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <span class="comment">//  GBP (6B): http://www.cmegroup.com/trading/fx/g10/british-pound_contract_specifications.html</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#afa7c591c47dac3394c2060d0f487db52" title="British Pound Futures">GBP</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#afa7c591c47dac3394c2060d0f487db52" title="British Pound Futures">GBP</a>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 20 consecutive quarters and serial contracts listed for 3 months</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                        thirdWednesday,</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                        -2, holidays);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                })</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            },</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            <span class="comment">// CAD (6C): http://www.cmegroup.com/trading/fx/g10/canadian-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a2d98a7f58b17e19b670895a3925c44c0" title="Canadian Dollar Futures">CAD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a2d98a7f58b17e19b670895a3925c44c0" title="Canadian Dollar Futures">CAD</a>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 20 consecutive quarters and serial contracts listed for 3 months</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the business day immediately preceding the third Wednesday of the contract month (usually Tuesday).</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                    var businessDayPrecedingThridWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                    <span class="keywordflow">return</span> businessDayPrecedingThridWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                })</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            },</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="comment">// JPY (6J): http://www.cmegroup.com/trading/fx/g10/japanese-yen_contract_specifications.html</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a802eb12eeac66365e2d534e538f51c71" title="Japanese Yen Futures">JPY</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a802eb12eeac66365e2d534e538f51c71" title="Japanese Yen Futures">JPY</a>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 20 consecutive quarters and serial contracts listed for 3 months</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        thirdWednesday,</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                        -2, holidays);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                })</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            },</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="comment">// CHF (6S): http://www.cmegroup.com/trading/fx/g10/swiss-franc_contract_specifications.html</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a8c9276e210c74948ee067efe21c80bd8" title="Swiss Franc Futures">CHF</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a8c9276e210c74948ee067efe21c80bd8" title="Swiss Franc Futures">CHF</a>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 20 consecutive quarters</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                    {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                    }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                        thirdWednesday,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                        -2, holidays);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                })</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            },</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="comment">// EUR (6E): http://www.cmegroup.com/trading/fx/g10/euro-fx_contract_specifications.html</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a5bdc7d5e005e77acf60228e7a1d411f1" title="Euro FX Futures">EUR</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a5bdc7d5e005e77acf60228e7a1d411f1" title="Euro FX Futures">EUR</a>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 20 consecutive quarters and serial contracts listed for 3 months</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                        thirdWednesday,</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                        -2, holidays);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                })</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            },</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="comment">// AUD (6A): http://www.cmegroup.com/trading/fx/g10/australian-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a92f9a29494e909978f6022449313a526" title="Australian Dollar Futures">AUD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a92f9a29494e909978f6022449313a526" title="Australian Dollar Futures">AUD</a>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 20 consecutive quarters and serial contracts listed for 3 months</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                        thirdWednesday,</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                        -2, holidays);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                })</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            },</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="comment">// NZD (6N): http://www.cmegroup.com/trading/fx/g10/new-zealand-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a590bb46ba565d4a170a15cbeabd40844" title="New Zealand Dollar Futures">NZD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a590bb46ba565d4a170a15cbeabd40844" title="New Zealand Dollar Futures">NZD</a>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 6 consecutive quarters</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                    }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                        thirdWednesday,</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                        -2, holidays);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                })</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            },</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <span class="comment">// RUB (6R): https://www.cmegroup.com/trading/fx/emerging-market/russian-ruble_contract_specifications.html</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#abb7ae7a2895d4082679d03e870175198" title="Russian Ruble Futures">RUB</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#abb7ae7a2895d4082679d03e870175198" title="Russian Ruble Futures">RUB</a>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                    <span class="comment">// Monthly contacts listed for 12 consecutive months and quarterly contracts (Mar, Jun, Sep, Dec) listed for16 additional quarters</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                    <span class="comment">// 11:00 a.m. Mosccow time on the fifteenth day of the month, or, if not a business day, on the next business day for the Moscow interbank foreign exchange market.</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                    var fifteenth = <span class="keyword">new</span> DateTime(time.Year, time.Month, 15);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(fifteenth, holidays))</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                    {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                        fifteenth = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fifteenth, 1, holidays);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                    }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                    <span class="keywordflow">return</span> fifteenth.Add(<span class="keyword">new</span> TimeSpan(08,0,0));</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                })</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            },</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="comment">// BRL (6L): https://www.cmegroup.com/trading/fx/emerging-market/brazilian-real_contract_specifications.html</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a26ae5bef6c56044a71776c3013f24ed0" title="Brazillian Real Futures">BRL</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a26ae5bef6c56044a71776c3013f24ed0" title="Brazillian Real Futures">BRL</a>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                    <span class="comment">// Monthly contracts listed for 60 consecutive months</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    <span class="comment">// On the last business day of the month, at 9:15 a.m. CT, immediately preceding the contract month, on which the Central Bank of Brazil is scheduled to publish its final end-of-month (EOM), &quot;Commercial exchange rate for Brazilian reais per U.S. dollar for cash delivery&quot; (PTAX rate).</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                    var lastPrecedingBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(time, -1, holidays);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                    lastPrecedingBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastPrecedingBusinessDay, -1, holidays);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                    <span class="keywordflow">return</span> lastPrecedingBusinessDay.Add(<span class="keyword">new</span> TimeSpan(14,15,0));</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                })</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            },</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            <span class="comment">// MXN (6M): https://www.cmegroup.com/trading/fx/emerging-market/mexican-peso_contract_specifications.html</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a562032bba7332d525f1f55218f3a4693" title="Mexican Peso Futures">MXN</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a562032bba7332d525f1f55218f3a4693" title="Mexican Peso Futures">MXN</a>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                    <span class="comment">// Monthly contracts listed for 13 consecutive  months and 2 additional quarterly contracts (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday,-2, holidays);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                })</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            },</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="comment">// ZAR (6Z): https://www.cmegroup.com/trading/fx/emerging-market/south-african-rand_contract_specifications.html</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ace5dc4554077ccc5d489bca7d25cdf46" title="South African Rand Futures">ZAR</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ace5dc4554077ccc5d489bca7d25cdf46" title="South African Rand Futures">ZAR</a>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    <span class="comment">// Monthly contracts listed for 13 consecutive months and quarterly contracts (Mar, Jun, Sep, Dec) listed for 4 consecutive quarters</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday)</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                    </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                })</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            },</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            <span class="comment">// AUD/CAD (ACD): https://www.cmegroup.com/trading/fx/g10/australian-dollar-canadian-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#aecdb135e13dfbe1e7829020c17b9dd9a" title="Australian Dollar/Canadian Dollar Futures">AUDCAD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#aecdb135e13dfbe1e7829020c17b9dd9a" title="Australian Dollar/Canadian Dollar Futures">AUDCAD</a>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                    <span class="comment">// Six months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                    }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday)</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    secondBusinessDayPrecedingThirdWednesday =  <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14,16,0));</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                })</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            },</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <span class="comment">// Australian Dollar/Japanese Yen (AJY): https://www.cmegroup.com/trading/fx/g10/australian-dollar-japanese-yen_contract_specifications.html</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a46436a17919dd718201eaa0f1621d143" title="Australian Dollar/Japanese Yen Futures">AUDJPY</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a46436a17919dd718201eaa0f1621d143" title="Australian Dollar/Japanese Yen Futures">AUDJPY</a>;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                    <span class="comment">// Six months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                    {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                    }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                })</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            },</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="comment">// Australian Dollar/New Zealand Dollar (ANE): https://www.cmegroup.com/trading/fx/g10/australian-dollar-new-zealand-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a65d48a263915374bab1e83f6d7604637" title="Australian Dollar/New Zealand Dollar Futures">AUDNZD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a65d48a263915374bab1e83f6d7604637" title="Australian Dollar/New Zealand Dollar Futures">AUDNZD</a>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                    <span class="comment">// Six months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                    {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                })</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            },</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            <span class="comment">// Bitcoin (BTC): https://www.cmegroup.com/trading/equity-index/us-index/bitcoin_contract_specifications.html</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad913eb0e8def2ff9fba8202f56c990b5" title="Bitcoin Futures">BTC</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad913eb0e8def2ff9fba8202f56c990b5" title="Bitcoin Futures">BTC</a>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                    <span class="comment">// Monthly contracts listed for 6 consecutive months and 2 additional Dec contract months. If the 6 consecutive months includes Dec, list only 1 additional Dec contract month.</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    <span class="comment">// Trading terminates at 4:00 p.m. London time on the last Friday of the contract month. If that day is not a business day in both the U.K. and the US, trading terminates on the preceding day that is a business day for both the U.K. and the U.S..</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                    var lastFriday =<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a050919058118947f8294ec0e10105087" title="Method to retrieve the last Friday of any month">LastFriday</a>(time);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                    lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastFriday, -1, holidays);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                    <span class="keywordflow">return</span> lastFriday.Add(<span class="keyword">new</span> TimeSpan(15, 0, 0));</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                })</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            },</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            <span class="comment">// Ether (ETH): https://www.cmegroup.com/markets/cryptocurrencies/ether/ether.contractSpecs.html</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a3c245de4019943c9a3c51a275e125d0e" title="Ether Futures">ETH</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a3c245de4019943c9a3c51a275e125d0e" title="Ether Futures">ETH</a>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                    <span class="comment">// Monthly contracts listed for 6 consecutive months, quarterly contracts (Mar, Jun, Sep, Dec) listed for 4 additional quarters and a second Dec contract if only one is listed.</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    <span class="comment">// Trading terminates at 4:00 p.m. London time on the last Friday of the contract month that is either a London or U.S. business day. If the last Friday of the contract month day is not a business day in both London and the U.S., trading terminates on the prior London or U.S. business day.</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                    var lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a050919058118947f8294ec0e10105087" title="Method to retrieve the last Friday of any month">LastFriday</a>(time);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                    lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastFriday, -1, holidays);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                    <span class="keywordflow">return</span> lastFriday.Add(<span class="keyword">new</span> TimeSpan(15, 0, 0));</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                })</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            },</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <span class="comment">// Canadian Dollar/Japanese Yen (CJY): https://www.cmegroup.com/trading/fx/g10/canadian-dollar-japanese-yen_contract_specifications.html</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ac70dddce6dcb7c69bcb1358e6555ee62" title="Canadian Dollar/Japanese Yen Futures">CADJPY</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ac70dddce6dcb7c69bcb1358e6555ee62" title="Canadian Dollar/Japanese Yen Futures">CADJPY</a>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                    <span class="comment">// Six months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                    {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                })</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            },</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="comment">// Standard-Size USD/Offshore RMB (CNH): https://www.cmegroup.com/trading/fx/emerging-market/usd-cnh_contract_specifications.html</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#aeb3cda42ac9db0a6ba34e14c222295b3" title="Standard-Size USD/Offshore RMB (CNH) Futures">StandardSizeUSDOffshoreRMBCNH</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#aeb3cda42ac9db0a6ba34e14c222295b3" title="Standard-Size USD/Offshore RMB (CNH) Futures">StandardSizeUSDOffshoreRMBCNH</a>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                    </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                    <span class="comment">// Monthly contracts listed for 13 consecutive months and quarterly contracts (Mar, Jun, Sep, Dec) listed for the next 8  quarters.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                    <span class="comment">// Trading terminates on the second Hong Kong business day prior to the third Wednesday of the contract month at 11:00 a.m. Hong Kong local time.</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = thirdWednesday.AddDays(-2);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(secondBusinessDayPrecedingThirdWednesday) || !secondBusinessDayPrecedingThirdWednesday.IsCommonBusinessDay())</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                    {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        secondBusinessDayPrecedingThirdWednesday = secondBusinessDayPrecedingThirdWednesday.AddDays(-1);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                    }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(3,0,0));</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                })</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            },</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="comment">// E-mini Euro FX (E7): https://www.cmegroup.com/trading/fx/g10/e-mini-euro-fx_contract_specifications.html</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#aaaf40bc9c2d1741108ffc018d8ba25e0" title="E-mini Euro FX Futures">EuroFXEmini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#aaaf40bc9c2d1741108ffc018d8ba25e0" title="E-mini Euro FX Futures">EuroFXEmini</a>;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                    {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                })</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            },</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="comment">// Euro/Australian Dollar (EAD): https://www.cmegroup.com/trading/fx/g10/euro-fx-australian-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a05e9e39d2032bff4befc6ec110f9fb56" title="Euro/Australian Dollar Futures">EURAUD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a05e9e39d2032bff4befc6ec110f9fb56" title="Euro/Australian Dollar Futures">EURAUD</a>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                    </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 6 consecutive quarters</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                    {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                    }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                })</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            },</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <span class="comment">// Euro/Canadian Dollar (ECD): https://www.cmegroup.com/trading/fx/g10/euro-fx-canadian-dollar_contract_specifications.html</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a00302eae82972c42529547ee74ed6a85" title="Euro/Canadian Dollar Futures">EURCAD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a00302eae82972c42529547ee74ed6a85" title="Euro/Canadian Dollar Futures">EURCAD</a>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                    </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 6 consecutive quarters</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                    {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                    }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                    <span class="comment">// Trading terminates at 9:16 a.m. CT on the second business day prior to the third Wednesday of the contract month.</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                })</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            },</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="comment">// Euro/Swedish Krona (ESK): https://www.cmegroup.com/trading/fx/g10/euro-fx-swedish-krona_contract_specifications.html</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a3cd14ca664499a93e75727eb2209c5d9" title="Euro/Swedish Krona Futures">EURSEK</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a3cd14ca664499a93e75727eb2209c5d9" title="Euro/Swedish Krona Futures">EURSEK</a>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                    </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                    <span class="comment">// Six months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    {</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                    }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                })</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            },</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            <span class="comment">// E-mini Japanese Yen (J7): https://www.cmegroup.com/trading/fx/g10/e-mini-japanese-yen_contract_specifications.html</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a1326f62760f7e830ebe7c6e2fd93ce06" title="E-mini Japanese Yen Futures">JapaneseYenEmini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a1326f62760f7e830ebe7c6e2fd93ce06" title="E-mini Japanese Yen Futures">JapaneseYenEmini</a>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                    <span class="comment">// Two months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                    {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                    }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                   <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                })</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            },</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <span class="comment">// Financials group</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <span class="comment">// Y30TreasuryBond (ZB): http://www.cmegroup.com/trading/interest-rates/us-treasury/30-year-us-treasury-bond_contract_specifications.html</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a00f2e0cec63ce786887a027bd98222f8" title="30Y U.S. Treasury Bond Futures">Y30TreasuryBond</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a00f2e0cec63ce786887a027bd98222f8" title="30Y U.S. Treasury Bond Futures">Y30TreasuryBond</a>;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                    </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 3 quarters</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                    {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                    <span class="comment">//  Seventh business day preceding the last business day of the delivery month. Trading in expiring contracts closes at 12:01 p.m. on the last trading day.</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    var seventhBusinessDayPrecedingLastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastBusinessDay,-7, holidays);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                    <span class="keywordflow">return</span> seventhBusinessDayPrecedingLastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(12,01,0));</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                })</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            },</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            <span class="comment">// Y10TreasuryNote (ZN): http://www.cmegroup.com/trading/interest-rates/us-treasury/10-year-us-treasury-note_contract_specifications.html</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a770836c4d7a279daaa6df67cf06e3b10" title="10Y U.S. Treasury Note Futures">Y10TreasuryNote</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a770836c4d7a279daaa6df67cf06e3b10" title="10Y U.S. Treasury Note Futures">Y10TreasuryNote</a>;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 3 consecutive quarters</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                    {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                    }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                    <span class="comment">//  Seventh business day preceding the last business day of the delivery month. Trading in expiring contracts closes at 12:01 p.m. on the last trading day.</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                    var seventhBusinessDayPrecedingLastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastBusinessDay,-7, holidays);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                    <span class="keywordflow">return</span> seventhBusinessDayPrecedingLastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(12,01,0));</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                })</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            },</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="comment">// Y5TreasuryNote (ZF): http://www.cmegroup.com/trading/interest-rates/us-treasury/5-year-us-treasury-note_contract_specifications.html</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#ac67f8360d51b50987b3d679e6c88eec9" title="5Y U.S. Treasury Note Futures">Y5TreasuryNote</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#ac67f8360d51b50987b3d679e6c88eec9" title="5Y U.S. Treasury Note Futures">Y5TreasuryNote</a>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 3 consecutive quarters</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                    {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                    }</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                    <span class="comment">// Last business day of the calendar month. Trading in expiring contracts closes at 12:01 p.m. on the last trading day.</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(12,01,0));</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                })</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            },</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            <span class="comment">// Y2TreasuryNote (ZT): http://www.cmegroup.com/trading/interest-rates/us-treasury/2-year-us-treasury-note_contract_specifications.html</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a713af46c98f8e1a16acbf23140fa77c8" title="2Y U.S. Treasury Note Futures">Y2TreasuryNote</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a713af46c98f8e1a16acbf23140fa77c8" title="2Y U.S. Treasury Note Futures">Y2TreasuryNote</a>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                    </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 3 consecutive quarters</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                    {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                    <span class="comment">// Last business day of the calendar month. Trading in expiring contracts closes at 12:01 p.m. on the last trading day.</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(12,01,0));</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                })</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            },</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <span class="comment">// Eurodollar (GE): https://www.cmegroup.com/trading/interest-rates/stir/eurodollar_contract_specifications.html</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a5ef2f1876d6f99943b19b89e2f974ab7" title="EuroDollar Futures">EuroDollar</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a5ef2f1876d6f99943b19b89e2f974ab7" title="EuroDollar Futures">EuroDollar</a>;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                    </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 40 consecutive quarters and the nearest 4 serial contract months.</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                    <span class="comment">// List a new quarterly contract for trading on the last trading day of the nearby expiry.</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                    <span class="comment">// Termination of trading:</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                    <span class="comment">// Second London bank business day before 3rd Wednesday of the contract month. Trading</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                    <span class="comment">// in expiring contracts terminates at 11:00 a.m. London time on the last trading day.</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time), -2, holidays)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                        .Add(TimeSpan.FromHours(11));</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                })</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            },</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <span class="comment">// 5-Year USD MAC Swap (F1U): https://www.cmegroup.com/trading/interest-rates/swap-futures/5-year-usd-mac-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a02579a8154963449c1beb45baa2408c2" title="5-Year USD MAC Swap Futures">FiveYearUSDMACSwap</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a02579a8154963449c1beb45baa2408c2" title="5-Year USD MAC Swap Futures">FiveYearUSDMACSwap</a>;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                    </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                    {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                    }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                    <span class="comment">// Second London business day before 3rd Wednesday of futures Delivery Month. Trading in expiring contracts closes at 2:00 p.m. on the last trading day.</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                    var secondBusinessDayBeforeThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time).AddDays(-2);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                    <span class="comment">// Because we&#39;re using a London calendar, we need to put entries in MHDB and not use `USHolidays.Dates`</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(secondBusinessDayBeforeThirdWednesday) || !secondBusinessDayBeforeThirdWednesday.IsCommonBusinessDay())</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                    {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                        secondBusinessDayBeforeThirdWednesday = secondBusinessDayBeforeThirdWednesday.AddDays(-1);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayBeforeThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(19, 0, 0));</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                })</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            },</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            <span class="comment">// Ultra U.S. Treasury Bond (UB): https://www.cmegroup.com/trading/interest-rates/us-treasury/ultra-t-bond_contract_specifications.html</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a8fd7dd54dacbf65ad4cc8c84b06752f7" title="Ultra U.S. Treasury Bond Futures">UltraUSTreasuryBond</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a8fd7dd54dacbf65ad4cc8c84b06752f7" title="Ultra U.S. Treasury Bond Futures">UltraUSTreasuryBond</a>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                    </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 3 consecutive quarters</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                    {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                    }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                    <span class="comment">// Seventh business day preceding the last business day of the delivery month. Trading in expiring contracts closes at 12:01 p.m. on the last trading day.</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                    var sevenBusinessDaysBeforeLastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 8, holidays);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                    <span class="keywordflow">return</span> sevenBusinessDaysBeforeLastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(12, 1, 0));</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                })</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            },</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            <span class="comment">// Ultra 10-Year U.S. Treasury Note (TN): https://www.cmegroup.com/trading/interest-rates/us-treasury/ultra-10-year-us-treasury-note_contract_specifications.html</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#ab911fbab1df6ab6d341a7d107380f3a2" title="Ultra 10-Year U.S. Treasury Note Futures">UltraTenYearUSTreasuryNote</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#ab911fbab1df6ab6d341a7d107380f3a2" title="Ultra 10-Year U.S. Treasury Note Futures">UltraTenYearUSTreasuryNote</a>;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                    </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 3 consecutive quarters</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                    {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                    }</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                     <span class="comment">// Trading terminates on the 7th business day before the last business day of the contract month.</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 8, holidays);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                })</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            },</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            <span class="comment">// Energies group</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <span class="comment">// Propane Non LDH Mont Belvieu (1S): https://www.cmegroup.com/trading/energy/petrochemicals/propane-non-ldh-mt-belvieu-opis-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a853281c353c03a26d09ac84075723e68" title="Propane Non LDH Mont Belvieu (OPIS) BALMO Futures">PropaneNonLDHMontBelvieu</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a853281c353c03a26d09ac84075723e68" title="Propane Non LDH Mont Belvieu (OPIS) BALMO Futures">PropaneNonLDHMontBelvieu</a>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month (no time specified)</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                })</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            },</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="comment">// Argus Propane Far East Index BALMO (22): https://www.cmegroup.com/trading/energy/petrochemicals/argus-propane-far-east-index-balmo-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a09e9214b2f164040198bd8162ed11c21" title="Argus Propane Far East Index BALMO Futures">ArgusPropaneFarEastIndexBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                {</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a09e9214b2f164040198bd8162ed11c21" title="Argus Propane Far East Index BALMO Futures">ArgusPropaneFarEastIndexBALMO</a>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                    </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for three cconsecutive months</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month. Business days are based on the Singapore Public Holiday calendar.</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                    <span class="comment">// TODO: Might need singapore calendar</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                })</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            },</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="comment">// Mini European 3.5% Fuel Oil Barges FOB Rdam (Platts) (A0D): https://www.cmegroup.com/trading/energy/refined-products/mini-european-35pct-fuel-oil-platts-barges-fob-rdam-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a399e128e62dcb49a4c09cf98d306e94b" title="Mini European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">MiniEuropeanThreePointPercentFiveFuelOilBargesPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a399e128e62dcb49a4c09cf98d306e94b" title="Mini European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">MiniEuropeanThreePointPercentFiveFuelOilBargesPlatts</a>;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    </div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 4 calendar years.</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                })</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            },</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <span class="comment">// Mini Singapore Fuel Oil 180 cst (Platts) (A0F): https://www.cmegroup.com/trading/energy/refined-products/mini-singapore-fuel-oil-180-cst-platts-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a806837dd1342ff604d1e410721717cb2" title="Mini Singapore Fuel Oil 180 cst (Platts) Futures">MiniSingaporeFuelOil180CstPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a806837dd1342ff604d1e410721717cb2" title="Mini Singapore Fuel Oil 180 cst (Platts) Futures">MiniSingaporeFuelOil180CstPlatts</a>;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                    </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 5 calendar years.</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                    <span class="comment">// Special case exists where the last trade occurs on US holiday, but not an exchange holiday (markets closed)</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                    <span class="comment">// In order to fix that case, we will start from the last day of the month and go backwards checking if it&#39;s a weekday and a holiday</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                    var lastDay = <span class="keyword">new</span> DateTime(time.Year, time.Month, DateTime.DaysInMonth(time.Year, time.Month));</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastDay) || !lastDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                    {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                        lastDay = lastDay.AddDays(-1);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                    }</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                    <span class="keywordflow">return</span> lastDay;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                })</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            },</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="comment">// Gulf Coast ULSD (Platts) Up-Down BALMO Futures (A1L): https://www.cmegroup.com/trading/energy/refined-products/ulsd-up-down-balmo-calendar-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aed6a1e1ac7c9c2c3567814bf2e089ccf" title="Gulf Coast ULSD (Platts) Up-Down BALMO Futures">GulfCoastULSDPlattsUpDownBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aed6a1e1ac7c9c2c3567814bf2e089ccf" title="Gulf Coast ULSD (Platts) Up-Down BALMO Futures">GulfCoastULSDPlattsUpDownBALMO</a>;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                })</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            },</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            <span class="comment">// Gulf Coast Jet (Platts) Up-Down BALMO Futures (A1M): https://www.cmegroup.com/trading/energy/refined-products/jet-fuel-up-down-balmo-calendar-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a89cf599193a513e544aa8766463781f1" title="Gulf Coast Jet (Platts) Up-Down BALMO Futures">GulfCoastJetPlattsUpDownBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a89cf599193a513e544aa8766463781f1" title="Gulf Coast Jet (Platts) Up-Down BALMO Futures">GulfCoastJetPlattsUpDownBALMO</a>;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                })</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            },</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <span class="comment">// Propane Non-LDH Mont Belvieu (OPIS) Futures (A1R): https://www.cmegroup.com/trading/energy/petrochemicals/propane-non-ldh-mt-belvieu-opis-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0016f2109af4620c731222026d57b55b" title="Propane Non-LDH Mont Belvieu (OPIS) Futures">PropaneNonLDHMontBelvieuOPIS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0016f2109af4620c731222026d57b55b" title="Propane Non-LDH Mont Belvieu (OPIS) Futures">PropaneNonLDHMontBelvieuOPIS</a>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                    </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                    <span class="comment">// Monthly contracts listed for 48 consecutive months</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                })</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            },</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="comment">// European Propane CIF ARA (Argus) BALMO Futures (A32): https://www.cmegroup.com/trading/energy/petrochemicals/european-propane-cif-ara-argus-balmo-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a5612f92933c047394a9cf2e51314f73f" title="European Propane CIF ARA (Argus) BALMO Futures">EuropeanPropaneCIFARAArgusBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a5612f92933c047394a9cf2e51314f73f" title="European Propane CIF ARA (Argus) BALMO Futures">EuropeanPropaneCIFARAArgusBALMO</a>;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                })</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            },</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <span class="comment">// Premium Unleaded Gasoline 10 ppm FOB MED (Platts) Futures (A3G): https://www.cmegroup.com/trading/energy/refined-products/premium-unleaded-10-ppm-platts-fob-med-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ac66a025c8258285cbda16a1eb7dc1573" title="Premium Unleaded Gasoline 10 ppm FOB MED (Platts) Futures">PremiumUnleadedGasoline10ppmFOBMEDPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ac66a025c8258285cbda16a1eb7dc1573" title="Premium Unleaded Gasoline 10 ppm FOB MED (Platts) Futures">PremiumUnleadedGasoline10ppmFOBMEDPlatts</a>;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                    </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    <span class="comment">// 48 consecutive months</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                })</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            },</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            <span class="comment">// Argus Propane Far East Index Futures (A7E): https://www.cmegroup.com/trading/energy/petrochemicals/argus-propane-far-east-index-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ab92996dfb42277cec0932e5d482a5a0e" title="Argus Propane Far East Index Futures">ArgusPropaneFarEastIndex</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ab92996dfb42277cec0932e5d482a5a0e" title="Argus Propane Far East Index Futures">ArgusPropaneFarEastIndex</a>;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                    </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                    <span class="comment">// Monthly contracts listed for 48 consecutive months</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                })</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            },</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            <span class="comment">// Gasoline Euro-bob Oxy NWE Barges (Argus) Crack Spread BALMO Futures (A7I): https://www.cmegroup.com/trading/energy/refined-products/gasoline-euro-bob-oxy-new-barges-crack-spread-balmo-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a34d0d5d4abb0bd424e29977b2ac5b779" title="Gasoline Euro-bob Oxy NWE Barges (Argus) Crack Spread BALMO Futures">GasolineEurobobOxyNWEBargesArgusCrackSpreadBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a34d0d5d4abb0bd424e29977b2ac5b779" title="Gasoline Euro-bob Oxy NWE Barges (Argus) Crack Spread BALMO Futures">GasolineEurobobOxyNWEBargesArgusCrackSpreadBALMO</a>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                    </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    <span class="comment">// Trading ceases on the last business day of the contract month.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                })</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            },</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            <span class="comment">// Mont Belvieu Natural Gasoline (OPIS) Futures (A7Q): https://www.cmegroup.com/trading/energy/petrochemicals/mont-belvieu-natural-gasoline-5-decimal-opis-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7090274eabf8fcdb2677521bde72d185" title="Mont Belvieu Natural Gasoline (OPIS) Futures">MontBelvieuNaturalGasolineOPIS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7090274eabf8fcdb2677521bde72d185" title="Mont Belvieu Natural Gasoline (OPIS) Futures">MontBelvieuNaturalGasolineOPIS</a>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                    </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                    <span class="comment">// Monthly contracts listed for 56 consecutive months</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                })</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            },</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            <span class="comment">// Mont Belvieu Normal Butane (OPIS) BALMO Futures (A8J): https://www.cmegroup.com/trading/energy/petrochemicals/mont-belvieu-normal-butane-opis-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#abacfbab626029056c4ed49d99960621a" title="Mont Belvieu Normal Butane (OPIS) BALMO Futures">MontBelvieuNormalButaneOPISBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#abacfbab626029056c4ed49d99960621a" title="Mont Belvieu Normal Butane (OPIS) BALMO Futures">MontBelvieuNormalButaneOPISBALMO</a>;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                    </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                })</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            },</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <span class="comment">// Conway Propane (OPIS) Futures (A8K): https://www.cmegroup.com/trading/energy/petrochemicals/conway-propane-opis-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a1294651504cc660479548296a5253871" title="Conway Propane (OPIS) Futures">ConwayPropaneOPIS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                {</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a1294651504cc660479548296a5253871" title="Conway Propane (OPIS) Futures">ConwayPropaneOPIS</a>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                    </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 4 calendar years.</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                })</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            },</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            <span class="comment">// Mont Belvieu LDH Propane (OPIS) BALMO Futures (A8O): https://www.cmegroup.com/trading/energy/petrochemicals/mont-belvieu-ldh-propane-opis-balmo-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a2a42949a4327add9a19134ad565e87d2" title="Mont Belvieu LDH Propane (OPIS) BALMO Futures">MontBelvieuLDHPropaneOPISBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a2a42949a4327add9a19134ad565e87d2" title="Mont Belvieu LDH Propane (OPIS) BALMO Futures">MontBelvieuLDHPropaneOPISBALMO</a>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                    </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                })</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            },</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            <span class="comment">// Argus Propane Far East Index vs. European Propane CIF ARA (Argus) Futures (A91): https://www.cmegroup.com/trading/energy/petrochemicals/argus-propane-far-east-index-vs-european-propane-cif-ara-argus-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a5022527a7f7bd57ead957730b5bb8dad" title="Argus Propane Far East Index vs. European Propane CIF ARA (Argus) Futures">ArgusPropaneFarEastIndexVsEuropeanPropaneCIFARAArgus</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a5022527a7f7bd57ead957730b5bb8dad" title="Argus Propane Far East Index vs. European Propane CIF ARA (Argus) Futures">ArgusPropaneFarEastIndexVsEuropeanPropaneCIFARAArgus</a>;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                    </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                })</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            },</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="comment">// Argus Propane (Saudi Aramco) Futures (A9N): https://www.cmegroup.com/trading/energy/petrochemicals/argus-propane-saudi-aramco-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a11bba67158886742174787623f1b4924" title="Argus Propane (Saudi Aramco) Futures">ArgusPropaneSaudiAramco</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a11bba67158886742174787623f1b4924" title="Argus Propane (Saudi Aramco) Futures">ArgusPropaneSaudiAramco</a>;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                    </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                    <span class="comment">// Monthly contracts listed for 48 consecutive months</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                    <span class="comment">// Trading shall terminate on the last business day of the month prior to the contract month.</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                    <span class="comment">// Business days are based on the Singapore Public Holiday Calendar.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                    <span class="comment">// Special case in 2021 where last traded date falls on US Holiday, but not exchange holiday</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                    var previousMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                    var lastDay = <span class="keyword">new</span> DateTime(previousMonth.Year, previousMonth.Month, DateTime.DaysInMonth(previousMonth.Year, previousMonth.Month));</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                    <span class="keywordflow">while</span> (!lastDay.IsCommonBusinessDay() || holidays.Contains(lastDay))</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                    {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                        lastDay = lastDay.AddDays(-1);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                    }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                    <span class="keywordflow">return</span> lastDay;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                })</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            },</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            <span class="comment">// Group Three ULSD (Platts) vs. NY Harbor ULSD Futures (AA6): https://www.cmegroup.com/trading/energy/refined-products/group-three-ultra-low-sulfur-diesel-ulsd-platts-vs-heating-oil-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a3f66956c24caacae32cd486fdc2eb974" title="Group Three ULSD (Platts) vs. NY Harbor ULSD Futures">GroupThreeULSDPlattsVsNYHarborULSD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a3f66956c24caacae32cd486fdc2eb974" title="Group Three ULSD (Platts) vs. NY Harbor ULSD Futures">GroupThreeULSDPlattsVsNYHarborULSD</a>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                })</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            },</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <span class="comment">// Group Three Sub-octane Gasoline (Platts) vs. RBOB Futures (AA8): https://www.cmegroup.com/trading/energy/refined-products/group-three-unleaded-gasoline-platts-vs-rbob-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7b56895df724eef1805147e3d7b935f3" title="Group Three Sub-octane Gasoliine (Platts) vs. RBOB Futures">GroupThreeSuboctaneGasolinePlattsVsRBOB</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7b56895df724eef1805147e3d7b935f3" title="Group Three Sub-octane Gasoliine (Platts) vs. RBOB Futures">GroupThreeSuboctaneGasolinePlattsVsRBOB</a>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                    </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                    <span class="comment">// 36 consecutive months</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                })</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            },</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <span class="comment">// Singapore Fuel Oil 180 cst (Platts) BALMO Futures (ABS): https://www.cmegroup.com/trading/energy/refined-products/singapore-180cst-fuel-oil-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a1898a076e73d77b15b8c9a49582cedac" title="Singapore Fuel Oil 180 cst (Platts) BALMO Futures">SingaporeFuelOil180cstPlattsBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a1898a076e73d77b15b8c9a49582cedac" title="Singapore Fuel Oil 180 cst (Platts) BALMO Futures">SingaporeFuelOil180cstPlattsBALMO</a>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                    </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                })</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            },</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            <span class="comment">// Singapore Fuel Oil 380 cst (Platts) BALMO Futures (ABT): https://www.cmegroup.com/trading/energy/refined-products/singapore-380cst-fuel-oil-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a54a03c1ccd3a02ca1e3d56e9f372ea08" title="Singapore Fuel Oil 380 cst (Platts) BALMO Futures">SingaporeFuelOil380cstPlattsBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a54a03c1ccd3a02ca1e3d56e9f372ea08" title="Singapore Fuel Oil 380 cst (Platts) BALMO Futures">SingaporeFuelOil380cstPlattsBALMO</a>;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                    </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                })</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;            },</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <span class="comment">// Mont Belvieu Ethane (OPIS) Futures (AC0): https://www.cmegroup.com/trading/energy/petrochemicals/mont-belvieu-ethane-opis-5-decimals-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a59a6fafc122dbc83a8d18953d5a531de" title="Mont Belvieu Ethane (OPIS) Futures">MontBelvieuEthaneOPIS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a59a6fafc122dbc83a8d18953d5a531de" title="Mont Belvieu Ethane (OPIS) Futures">MontBelvieuEthaneOPIS</a>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                    </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 4 calendar years.</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                })</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            },</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            <span class="comment">// Mont Belvieu Normal Butane (OPIS) Futures (AD0): https://www.cmegroup.com/trading/energy/petrochemicals/mont-belvieu-normal-butane-5-decimals-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af37791aeabc111ab07a5464c69ad906f" title="Mont Belvieu Normal Butane (OPIS) Futures">MontBelvieuNormalButaneOPIS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af37791aeabc111ab07a5464c69ad906f" title="Mont Belvieu Normal Butane (OPIS) Futures">MontBelvieuNormalButaneOPIS</a>;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                    </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and next 4 calendar years.</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                })</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            },</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;            <span class="comment">// Brent Crude Oil vs. Dubai Crude Oil (Platts) Futures (ADB): https://www.cmegroup.com/trading/energy/crude-oil/brent-dubai-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af36966dda858486e382a53848a97dd02" title="Brent Crude Oil vs. Dubai Crude Oil (Platts) Futures">BrentCrudeOilVsDubaiCrudeOilPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af36966dda858486e382a53848a97dd02" title="Brent Crude Oil vs. Dubai Crude Oil (Platts) Futures">BrentCrudeOilVsDubaiCrudeOilPlatts</a>;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                    <span class="comment">// Trading shall cease on the last London and Singapore business day of the contract month.</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                })</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;            },</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            <span class="comment">// Argus LLS vs. WTI (Argus) Trade Month Futures (AE5): https://www.cmegroup.com/trading/energy/crude-oil/argus-lls-vs-wti-argus-trade-month-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#abdcfbce43a21993a7750d09b1e04ef7d" title="Argus LLS vs. WTI (Argus) Trade Month Futures">ArgusLLSvsWTIArgusTradeMonth</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#abdcfbce43a21993a7750d09b1e04ef7d" title="Argus LLS vs. WTI (Argus) Trade Month Futures">ArgusLLSvsWTIArgusTradeMonth</a>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                    </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                    <span class="comment">// Trading shall cease at the close of trading on the last business day that falls on or before the 25th calendar day of the month prior to the contract month. If the 25th calendar day is a weekend or holiday, trading shall cease on the first business day prior to the 25th calendar day.</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                    var previousMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                    var twentyFifthDay = <span class="keyword">new</span> DateTime(previousMonth.Year, previousMonth.Month, 25);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                    <span class="keywordflow">while</span> (!twentyFifthDay.IsCommonBusinessDay() || holidays.Contains(twentyFifthDay))</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                    {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                        twentyFifthDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(twentyFifthDay, -1, holidays);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                    }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                    <span class="keywordflow">return</span> twentyFifthDay;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                })</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            },</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <span class="comment">// Singapore Gasoil (Platts) vs. Low Sulphur Gasoil (AGA): https://www.cmegroup.com/trading/energy/refined-products/gasoil-arb-singapore-gasoil-platts-vs-ice-rdam-gasoil-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#acdc63d048bd75d225a02f129b270fcd1" title="Singapore Gasoil (Platts) vs. Low Sulphur Gasoil Futures">SingaporeGasoilPlattsVsLowSulphurGasoilFutures</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#acdc63d048bd75d225a02f129b270fcd1" title="Singapore Gasoil (Platts) vs. Low Sulphur Gasoil Futures">SingaporeGasoilPlattsVsLowSulphurGasoilFutures</a>;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                    </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 2 calendar years.</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                    <span class="comment">// Trading ceases on the last business day of the contract month</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                })</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            },</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            <span class="comment">// Los Angeles CARBOB Gasoline (OPIS) vs. RBOB Gasoline (AJL): https://www.cmegroup.com/trading/energy/refined-products/los-angeles-carbob-gasoline-opis-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa49751e065d37bc5dc23d1bb477c399f" title="Los Angeles CARBOB Gasoline (OPIS) vs. RBOB Gasoline Futures">LosAngelesCARBOBGasolineOPISvsRBOBGasoline</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa49751e065d37bc5dc23d1bb477c399f" title="Los Angeles CARBOB Gasoline (OPIS) vs. RBOB Gasoline Futures">LosAngelesCARBOBGasolineOPISvsRBOBGasoline</a>;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                    </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                    <span class="comment">// 36 consecutive months</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                })</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            },</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            <span class="comment">// Los Angeles Jet (OPIS) vs. NY Harbor ULSD (AJS): https://www.cmegroup.com/trading/energy/refined-products/los-angeles-carbob-gasoline-opis-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#abc99911ed29e2217c3c57c1937690df7" title="Los Angeles Jet (OPIS) vs. NY Harbor ULSD Futures">LosAngelesJetOPISvsNYHarborULSD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#abc99911ed29e2217c3c57c1937690df7" title="Los Angeles Jet (OPIS) vs. NY Harbor ULSD Futures">LosAngelesJetOPISvsNYHarborULSD</a>;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                    <span class="comment">// 36 consecutive months</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                })</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            },</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <span class="comment">// Los Angeles CARB Diesel (OPIS) vs. NY Harbor ULSD (AKL): https://www.cmegroup.com/trading/energy/refined-products/los-angeles-carbob-diesel-opis-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ab16c901d26300cef425c22e5a25c42b2" title="Los Angeles CARB Diesel (OPIS) vs. NY Harbor ULSD Futures">LosAngelesCARBDieselOPISvsNYHarborULSD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ab16c901d26300cef425c22e5a25c42b2" title="Los Angeles CARB Diesel (OPIS) vs. NY Harbor ULSD Futures">LosAngelesCARBDieselOPISvsNYHarborULSD</a>;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                    <span class="comment">// 3 consecutive years</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                })</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            },</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            <span class="comment">// European Naphtha (Platts) BALMO (AKZ): https://www.cmegroup.com/trading/energy/refined-products/european-naphtha-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a36f5f742ad7688297ca9f9316df894f5" title="European Naphtha (Platts) BALMO Futures">EuropeanNaphthaPlattsBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                {</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a36f5f742ad7688297ca9f9316df894f5" title="European Naphtha (Platts) BALMO Futures">EuropeanNaphthaPlattsBALMO</a>;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                })</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            },</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            <span class="comment">// European Propane CIF ARA (Argus) (APS): https://www.cmegroup.com/trading/energy/petrochemicals/european-propane-cif-ara-argus-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a615cf3e77484dca0f6f201fa963f3318" title="European Propane CIF ARA (Argus) Futures">EuropeanPropaneCIFARAArgus</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a615cf3e77484dca0f6f201fa963f3318" title="European Propane CIF ARA (Argus) Futures">EuropeanPropaneCIFARAArgus</a>;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years.</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                })</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            },</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            <span class="comment">// Mont Belvieu Natural Gasoline (OPIS) BALMO (AR0): https://www.cmegroup.com/trading/energy/petrochemicals/mt-belvieu-natural-gasoline-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aff59dd069700e303f2e71803e3a69fcd" title="Mont Belvieu Natural Gasoline (OPIS) BALMO Futures">MontBelvieuNaturalGasolineOPISBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aff59dd069700e303f2e71803e3a69fcd" title="Mont Belvieu Natural Gasoline (OPIS) BALMO Futures">MontBelvieuNaturalGasolineOPISBALMO</a>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                })</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            },</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            <span class="comment">// RBOB Gasoline Crack Spread (ARE): https://www.cmegroup.com/trading/energy/refined-products/rbob-crack-spread-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7574ae5e6b71d4d133bb1730dc948374" title="RBOB Gasoline Crack Spread Futures">RBOBGasolineCrackSpread</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7574ae5e6b71d4d133bb1730dc948374" title="RBOB Gasoline Crack Spread Futures">RBOBGasolineCrackSpread</a>;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                    <span class="comment">// The current year plus the next three calendar years</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                })</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            },</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            <span class="comment">// Gulf Coast HSFO (Platts) BALMO (AVZ): https://www.cmegroup.com/trading/energy/refined-products/gulf-coast-3pct-fuel-oil-balmo-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0a0da7ca0c7b33b351140f11f5382197" title="Gulf Coast HSFO (Platts) BALMO Futures">GulfCoastHSFOPlattsBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                {</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0a0da7ca0c7b33b351140f11f5382197" title="Gulf Coast HSFO (Platts) BALMO Futures">GulfCoastHSFOPlattsBALMO</a>;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for the current month and the following month listed 10 business days prior to the start of the contract month</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                })</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            },</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="comment">// Mars (Argus) vs. WTI Trade Month (AYV): https://www.cmegroup.com/trading/energy/crude-oil/mars-crude-oil-argus-vs-wti-trade-month-spread-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa2cc9fcd0dc5e628bba1b63da62d7c2c" title="Mars (Argus) vs. WTI Trade Month Futures">MarsArgusVsWTITradeMonth</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa2cc9fcd0dc5e628bba1b63da62d7c2c" title="Mars (Argus) vs. WTI Trade Month Futures">MarsArgusVsWTITradeMonth</a>;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 5 calendar years.</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                    <span class="comment">// Trading shall cease at the close of trading on the last business day that falls on or before the 25th calendar day of the</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                    <span class="comment">// month prior to the contract month. If the 25th calendar day is a weekend or holiday, trading shall cease on the</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                    <span class="comment">// first business day prior to the 25th calendar day.</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                    var twentyFifthDayPriorMonth = <span class="keyword">new</span> DateTime(time.Year, time.Month, 25).AddMonths(-1);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(twentyFifthDayPriorMonth, holidays) || holidays.Contains(twentyFifthDayPriorMonth))</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                    {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                        twentyFifthDayPriorMonth = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(twentyFifthDayPriorMonth, -1, holidays);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                    }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                    <span class="keywordflow">return</span> twentyFifthDayPriorMonth;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                })</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            },</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="comment">// Mars (Argus) vs. WTI Financial (AYX): https://www.cmegroup.com/trading/energy/crude-oil/mars-crude-oil-argus-vs-wti-calendar-spread-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0f968a25e56f46a4e18584b018b2f136" title="Mars (Argus) vs. WTI Financial Futures">MarsArgusVsWTIFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0f968a25e56f46a4e18584b018b2f136" title="Mars (Argus) vs. WTI Financial Futures">MarsArgusVsWTIFinancial</a>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                    <span class="comment">// The current year and the next five (5) consecutive calendar years.</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                })</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            },</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            <span class="comment">// Ethanol T2 FOB Rdam Including Duty (Platts) (AZ1): https://www.cmegroup.com/trading/energy/ethanol/ethanol-platts-t2-fob-rotterdam-including-duty-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6619806efb32d4a8c1192253ac324967" title="Ethanol T2 FOB Rdam Including Duty (Platts) Futures">EthanolT2FOBRdamIncludingDutyPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6619806efb32d4a8c1192253ac324967" title="Ethanol T2 FOB Rdam Including Duty (Platts) Futures">EthanolT2FOBRdamIncludingDutyPlatts</a>;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160; </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                })</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            },</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="comment">// Mont Belvieu LDH Propane (OPIS) (B0): https://www.cmegroup.com/trading/energy/petrochemicals/mont-belvieu-propane-5-decimals-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a686ffbf57b66fd3579cfaff744a3b614" title="Mont Belvieu LDH Propane (OPIS) Futures">MontBelvieuLDHPropaneOPIS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a686ffbf57b66fd3579cfaff744a3b614" title="Mont Belvieu LDH Propane (OPIS) Futures">MontBelvieuLDHPropaneOPIS</a>;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 4 calendar years.</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                })</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            },</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            <span class="comment">// Gasoline Euro-bob Oxy NWE Barges (Argus) (B7H): https://www.cmegroup.com/trading/energy/refined-products/gasoline-euro-bob-oxy-new-barges-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a937928eddaefd00c6994e8ace7593efe" title="Gasoline Euro-bob Oxy NWE Barges (Argus) Futures">GasolineEurobobOxyNWEBargesArgus</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a937928eddaefd00c6994e8ace7593efe" title="Gasoline Euro-bob Oxy NWE Barges (Argus) Futures">GasolineEurobobOxyNWEBargesArgus</a>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                })</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            },</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;            <span class="comment">// WTI-Brent Financial (BK): https://www.cmegroup.com/trading/energy/crude-oil/wti-brent-ice-calendar-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ad358799130ad7c04a481b26ad89190b8" title="WTI-Brent Financial Futures">WTIBrentFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                {</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ad358799130ad7c04a481b26ad89190b8" title="WTI-Brent Financial Futures">WTIBrentFinancial</a>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 8 calendar years.</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                })</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            },</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            <span class="comment">// 3.5% Fuel Oil Barges FOB Rdam (Platts) Crack Spread (1000mt) (BOO): https://www.cmegroup.com/trading/energy/refined-products/35pct-fuel-oil-platts-barges-fob-rdam-crack-spread-1000mt-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a9fed8cd35ec3593e2b537125c59fb57b" title="3.5% Fuel Oil Barges FOB Rdam (Platts) Crack Spread (1000mt) Futures">ThreePointFivePercentFuelOilBargesFOBRdamPlattsCrackSpread1000mt</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                {</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a9fed8cd35ec3593e2b537125c59fb57b" title="3.5% Fuel Oil Barges FOB Rdam (Platts) Crack Spread (1000mt) Futures">ThreePointFivePercentFuelOilBargesFOBRdamPlattsCrackSpread1000mt</a>;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 4 calendar years.</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                })</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;            },</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            <span class="comment">// Gasoline Euro-bob Oxy NWE Barges (Argus) BALMO (BR7): https://www.cmegroup.com/trading/energy/refined-products/gasoline-euro-bob-oxy-new-barges-balmo-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6e9500bc1afad941f8c99ba7cf90cbea" title="Gasoline Euro-bob Oxy NWE Barges (Argus) BALMO Futures">GasolineEurobobOxyNWEBargesArgusBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6e9500bc1afad941f8c99ba7cf90cbea" title="Gasoline Euro-bob Oxy NWE Barges (Argus) BALMO Futures">GasolineEurobobOxyNWEBargesArgusBALMO</a>;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                })</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            },</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            <span class="comment">// Brent Last Day Financial (BZ): https://www.cmegroup.com/trading/energy/crude-oil/brent-crude-oil-last-day_contract_specifications.html</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ae188002920b69ee1e4493e435da575a7" title="Brent Last Day Financial Futures">BrentLastDayFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                {</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ae188002920b69ee1e4493e435da575a7" title="Brent Last Day Financial Futures">BrentLastDayFinancial</a>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 7 calendar years and 3 additional contract months.</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                    <span class="comment">// Trading terminates the last London business day of the month, 2 months prior to the contract month except for the February contract month which terminates the 2nd last London business day of the month, 2 months prior to the contract month.</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                    var twoMonthsPriorToContractMonth = time.AddMonths(-2);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                    DateTime lastBusinessDay;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                    <span class="keywordflow">if</span> (twoMonthsPriorToContractMonth.Month == 2)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                    {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                        lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(twoMonthsPriorToContractMonth, 1, holidays);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                    }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                    {</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                        lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(twoMonthsPriorToContractMonth, 1, holidays);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                    }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                    </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160; </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                })</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            },</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            <span class="comment">// CrudeOilWTI (CL): http://www.cmegroup.com/trading/energy/crude-oil/light-sweet-crude_contract_specifications.html</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6717ec466055589f5c4ac36438cb1d37" title="Crude Oil WTI Futures">CrudeOilWTI</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6717ec466055589f5c4ac36438cb1d37" title="Crude Oil WTI Futures">CrudeOilWTI</a>;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 10 calendar years and 2 additional contract months.</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                    <span class="comment">// Trading in the current delivery month shall cease on the third business day prior to the twenty-fifth calendar day of the month preceding the delivery month. If the twenty-fifth calendar day of the month is a non-business day, trading shall cease on the third business day prior to the last business day preceding the twenty-fifth calendar day. In the event that the official Exchange holiday schedule changes subsequent to the listing of a Crude Oil futures, the originally listed expiration date shall remain in effect.In the event that the originally listed expiration day is declared a holiday, expiration will move to the business day immediately prior.</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                    var twentyFifth = <span class="keyword">new</span> DateTime(time.Year,time.Month,25);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                    twentyFifth = twentyFifth.AddMonths(-1);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                    var businessDays = -3;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                    <span class="keywordflow">if</span>(!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(twentyFifth, holidays))</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                    {</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                        <span class="comment">// if the 25th is a holiday we substract 1 extra bussiness day</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                        businessDays -= 1;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                    }</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(twentyFifth, businessDays, holidays);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                })</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            },</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            <span class="comment">// Gulf Coast CBOB Gasoline A2 (Platts) vs. RBOB Gasoline (CRB): https://www.cmegroup.com/trading/energy/refined-products/gulf-coast-cbob-gasoline-a2-platts-vs-rbob-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a4f5f4575328412c053a219781b588994" title="Gulf Coast CBOB Gasoline A2 (Platts) vs. RBOB Gasoline Futures">GulfCoastCBOBGasolineA2PlattsVsRBOBGasoline</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                {</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a4f5f4575328412c053a219781b588994" title="Gulf Coast CBOB Gasoline A2 (Platts) vs. RBOB Gasoline Futures">GulfCoastCBOBGasolineA2PlattsVsRBOBGasoline</a>;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                    <span class="comment">// 36 consecutive months</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                })</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            },</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <span class="comment">// Clearbrook Bakken Sweet Crude Oil Monthly Index (Net Energy) (CSW): https://www.cmegroup.com/trading/energy/crude-oil/clearbrook-bakken-crude-oil-index-net-energy_contract_specifications.html</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a4d1b0cf594b12a3a658638de16a3d6b1" title="Clearbrook Bakken Sweet Crude Oil Monthly Index (Net Energy) Futures">ClearbrookBakkenSweetCrudeOilMonthlyIndexNetEnergy</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years.</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                    <span class="comment">// Trading terminates one Canadian business day prior to the Notice of Shipments (NOS) date on the Enbridge Pipeline. The NOS date occurs on or about the 20th calendar day of the month, subject to confirmation by Enbridge Pipeline. The official schedule for the NOS dates will be made publicly available by Enbridge.</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                    <span class="comment">// This report is behind a portal that requires registration (privately). As such, we cannot access the notice of shipment dates, but we can keep track</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                    <span class="comment">// of the CME group&#39;s website in order to discover the NOS dates</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                    <span class="comment">// Publication dates are also erratic. We must maintain a separate list from MHDB in order to keep track of these days</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                    DateTime publicationDate;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryFunctions.html#a4b2fbfcd2df2c157bca020c1fe7d9b40" title="Enbridge&#39;s Notice of Shipment report dates. Used to calculate the last trade date for CSW">EnbridgeNoticeOfShipmentDates</a>.TryGetValue(time, out publicationDate))</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                    {</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                        publicationDate = <span class="keyword">new</span> DateTime(time.Year, time.Month, 21).AddMonths(-1);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                    }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                    {</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                        publicationDate = publicationDate.AddDays(-1);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                    }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                    <span class="keywordflow">while</span> (!publicationDate.IsCommonBusinessDay());</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                    <span class="keywordflow">return</span> publicationDate;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                })</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            },</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            <span class="comment">// WTI Financial (CSX): https://www.cmegroup.com/trading/energy/crude-oil/west-texas-intermediate-wti-crude-oil-calendar-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa775344fd040dec790af15941c792f30" title="WTI Financial Futures">WTIFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa775344fd040dec790af15941c792f30" title="WTI Financial Futures">WTIFinancial</a>;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 8 calendar years.</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                })</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            },</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            <span class="comment">// Chicago Ethanol (Platts) (CU): https://www.cmegroup.com/trading/energy/ethanol/chicago-ethanol-platts-swap_contract_specifications.html a</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a21d3c69ab82a70ba388d73aa6723e29c" title="Chicago Ethaanol (Platts) Futures">ChicagoEthanolPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                {</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a21d3c69ab82a70ba388d73aa6723e29c" title="Chicago Ethaanol (Platts) Futures">ChicagoEthanolPlatts</a>;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                })</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            },</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            <span class="comment">// Singapore Mogas 92 Unleaded (Platts) Brent Crack Spread (D1N): https://www.cmegroup.com/trading/energy/refined-products/singapore-mogas-92-unleaded-platts-brent-crack-spread-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a33ebf471dc711f2992ab159bf0ced6f6" title="Singapore Mogas 92 Unleaded (Platts) Brent Crack Spread Futures">SingaporeMogas92UnleadedPlattsBrentCrackSpread</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                {</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a33ebf471dc711f2992ab159bf0ced6f6" title="Singapore Mogas 92 Unleaded (Platts) Brent Crack Spread Futures">SingaporeMogas92UnleadedPlattsBrentCrackSpread</a>;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next calendar year.</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                })</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            },</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <span class="comment">// Dubai Crude Oil (Platts) Financial (DCB): https://www.cmegroup.com/trading/energy/crude-oil/dubai-crude-oil-calendar-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a03a4ab1249243411e5bcd3e3ace905a2" title="Dubai Crude Oil (Platts) Financial Futures">DubaiCrudeOilPlattsFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a03a4ab1249243411e5bcd3e3ace905a2" title="Dubai Crude Oil (Platts) Financial Futures">DubaiCrudeOilPlattsFinancial</a>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next five calendar years.</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                    <span class="comment">// Trading shall cease on the last London and Singapore business day of the contract month</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                })</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;            },</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            <span class="comment">// Japan C&amp;amp;F Naphtha (Platts) BALMO (E6): https://www.cmegroup.com/trading/energy/refined-products/japan-naphtha-balmo-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af1d01e0a6cc511c9695a1cfb4c76f5e3" title="Japan C&amp;F Naphtha (Platts) BALMO Futures">JapanCnFNaphthaPlattsBALMO</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af1d01e0a6cc511c9695a1cfb4c76f5e3" title="Japan C&amp;F Naphtha (Platts) BALMO Futures">JapanCnFNaphthaPlattsBALMO</a>;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                    <span class="comment">// Monthly BALMO contracts listed for 3 consecutive months</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                })</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            },</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;            <span class="comment">// Ethanol (EH): https://www.cmegroup.com/trading/energy/ethanol/cbot-ethanol_contract_specifications.html</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6fd85557d9d05338c398b14d5466bc7a" title="Ethanol Futures">Ethanol</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                {</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6fd85557d9d05338c398b14d5466bc7a" title="Ethanol Futures">Ethanol</a>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                    <span class="comment">// Trading terminates on 3rd business day of the contract month in &quot;ctm&quot;</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a033bcd11133290ed64a7d98b4a454548" title="Calculates the n^th business day of the month (includes checking for holidays)">NthBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                })</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;            },</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            <span class="comment">// European Naphtha (Platts) Crack Spread (EN): https://www.cmegroup.com/trading/energy/refined-products/european-naphtha-crack-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a03ab3e2220631b78c4077ea178980fda" title="European Naphtha (Platts) Crack Spread Futures">EuropeanNaphthaPlattsCrackSpread</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                    <span class="comment">// Trading ceases on the last business day of the contract month.</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a03ab3e2220631b78c4077ea178980fda" title="European Naphtha (Platts) Crack Spread Futures">EuropeanNaphthaPlattsCrackSpread</a>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                    {</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                    }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                })</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            },</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            <span class="comment">// European Propane CIF ARA (Argus) vs. Naphtha Cargoes CIF NWE (Platts) (EPN): https://www.cmegroup.com/trading/energy/refined-products/european-propane-cif-ara-argus-vs-naphtha-cif-nwe-platts-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a768fa49b21aa1bb0003ea3de50299b48" title="European Propane CIF ARA (Argus) vs. Naphtha Cargoes CIF NWE (Platts) Futures">EuropeanPropaneCIFARAArgusVsNaphthaCargoesCIFNWEPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years.</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a768fa49b21aa1bb0003ea3de50299b48" title="European Propane CIF ARA (Argus) vs. Naphtha Cargoes CIF NWE (Platts) Futures">EuropeanPropaneCIFARAArgusVsNaphthaCargoesCIFNWEPlatts</a>;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160; </div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                    {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                    }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160; </div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                })</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            },</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <span class="comment">// Singapore Fuel Oil 380 cst (Platts) vs. European 3.5% Fuel Oil Barges FOB Rdam (Platts) (EVC): https://www.cmegroup.com/trading/energy/refined-products/singapore-fuel-oil-380-cst-platts-vs-european-35-fuel-oil-barges-fob-rdam-platts_contract_specifications.html</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa74c35222d1899d6c17c45df4018cd64" title="Singapore Fuel Oil 380 cst (Platts) vs. European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">SingaporeFuelOil380cstPlattsVsEuropeanThreePointFivePercentFuelOilBargesFOBRdamPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aa74c35222d1899d6c17c45df4018cd64" title="Singapore Fuel Oil 380 cst (Platts) vs. European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">SingaporeFuelOil380cstPlattsVsEuropeanThreePointFivePercentFuelOilBargesFOBRdamPlatts</a>;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 5 calendar years.</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                    {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                    }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                })</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            },</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            <span class="comment">// East-West Gasoline Spread (Platts-Argus) (EWG): https://www.cmegroup.com/trading/energy/refined-products/east-west-gasoline-spread-platts-argus-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#afddd3a6a7604ba380e290cfcf320c945" title="East-West Gasoline Spread (Platts-Argus) Futures">EastWestGasolineSpreadPlattsArgus</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#afddd3a6a7604ba380e290cfcf320c945" title="East-West Gasoline Spread (Platts-Argus) Futures">EastWestGasolineSpreadPlattsArgus</a>;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                    <span class="comment">// Monthly contracts listed for 12 consecutive months</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                })</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;            },</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            <span class="comment">// East-West Naphtha: Japan C&amp;amp;F vs. Cargoes CIF NWE Spread (Platts) (EWN): https://www.cmegroup.com/trading/energy/refined-products/east-west-naphtha-japan-cf-vs-cargoes-cif-nwe-spread-platts-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ac676edf206ff82e39ac3af66a15498e3" title="East-West Naphtha: Japan C&amp;F vs. Cargoes CIF NWE Spread (Platts) Futures">EastWestNaphthaJapanCFvsCargoesCIFNWESpreadPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ac676edf206ff82e39ac3af66a15498e3" title="East-West Naphtha: Japan C&amp;F vs. Cargoes CIF NWE Spread (Platts) Futures">EastWestNaphthaJapanCFvsCargoesCIFNWESpreadPlatts</a>;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                    {</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                    }</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160; </div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                })</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            },</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="comment">// RBOB Gasoline vs. Euro-bob Oxy NWE Barges (Argus) (350,000 gallons) (EXR): https://www.cmegroup.com/trading/energy/refined-products/rbob-gasoline-vs-euro-bob-oxy-argus-nwe-barges-1000mt-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ae737d9a738201e6eb0783c3b293b165b" title="RBOB Gasoline vs. Euro-bob Oxy NWE Barges (Argus) (350,000 gallons) Futures">RBOBGasolineVsEurobobOxyNWEBargesArgusThreeHundredFiftyThousandGallons</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                {</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ae737d9a738201e6eb0783c3b293b165b" title="RBOB Gasoline vs. Euro-bob Oxy NWE Barges (Argus) (350,000 gallons) Futures">RBOBGasolineVsEurobobOxyNWEBargesArgusThreeHundredFiftyThousandGallons</a>;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                })</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;            },</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            <span class="comment">// 3.5% Fuel Oil Barges FOB Rdam (Platts) Crack Spread Futures (FO): https://www.cmegroup.com/trading/energy/refined-products/northwest-europe-nwe-35pct-fuel-oil-rottderdam-crack-spread-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6a1ab8f9c688da4c831e042849f64057" title="3.5% Fuel Oil Barges FOB Rdam (Platts) Crack Spread Futures">ThreePointFivePercentFuelOilBargesFOBRdamPlattsCrackSpread</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6a1ab8f9c688da4c831e042849f64057" title="3.5% Fuel Oil Barges FOB Rdam (Platts) Crack Spread Futures">ThreePointFivePercentFuelOilBargesFOBRdamPlattsCrackSpread</a>;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 4 calendar years.</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                    <span class="comment">// Trading ceases on the last business day of the contract month.</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160; </div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                    {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                    }</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160; </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                })</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            },</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            <span class="comment">// Freight Route TC14 (Baltic) (FRC): https://www.cmegroup.com/trading/energy/freight/freight-route-tc14-baltic-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#afa9dcae129a38531d0a4aa450f6f0e73" title="Freight Route TC14 (Baltic) Futures">FreightRouteTC14Baltic</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#afa9dcae129a38531d0a4aa450f6f0e73" title="Freight Route TC14 (Baltic) Futures">FreightRouteTC14Baltic</a>;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 5 consecutive years.</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160; </div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                    {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                    }</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                })</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            },</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            <span class="comment">// 1% Fuel Oil Cargoes FOB NWE (Platts) vs. 3.5% Fuel Oil Barges FOB Rdam (Platts) (FSS):  https://www.cmegroup.com/trading/energy/refined-products/fuel-oil-diff-1pct-nwe-cargoes-vs-35pct-barges-swap_contract_specifications.html</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a75b89198884e0d253ef31e283f4716f2" title="1% Fuel Oil Cargoes FOB NWE (Platts) vs. 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">OnePercentFuelOilCargoesFOBNWEPlattsVsThreePointFivePercentFuelOilBargesFOBRdamPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                {</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                    <span class="comment">// Monthly contracts listed for 52 consecutive months</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                    <span class="comment">// Trading ceases on the last business day of the contract month.</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a75b89198884e0d253ef31e283f4716f2" title="1% Fuel Oil Cargoes FOB NWE (Platts) vs. 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">OnePercentFuelOilCargoesFOBNWEPlattsVsThreePointFivePercentFuelOilBargesFOBRdamPlatts</a>;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; </div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                    {</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                    }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160; </div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                })</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            },</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            <span class="comment">// Gulf Coast HSFO (Platts) vs. European 3.5% Fuel Oil Barges FOB Rdam (Platts) (GCU): https://www.cmegroup.com/trading/energy/refined-products/gulf-coast-no6-fuel-oil-3pct-vs-european-3point5pct-fuel-oil-barges-fob-rdam-platts-swap-futures_contract_specifications.html</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#afd462b0b6898d61331a0e35c4d0e0ffe" title="Gulf Coast HSFO (Platts) vs. European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">GulfCoastHSFOPlattsVsEuropeanThreePointFivePercentFuelOilBargesFOBRdamPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                {</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#afd462b0b6898d61331a0e35c4d0e0ffe" title="Gulf Coast HSFO (Platts) vs. European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">GulfCoastHSFOPlattsVsEuropeanThreePointFivePercentFuelOilBargesFOBRdamPlatts</a>;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                    <span class="comment">// Trading shall cease on the last business day of the contract month.</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastBusinessDay) || !lastBusinessDay.IsCommonBusinessDay())</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                    {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                        lastBusinessDay = lastBusinessDay.AddDays(-1);</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                    }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160; </div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                })</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;            },</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <span class="comment">// WTI Houston Crude Oil (HCL): https://www.cmegroup.com/trading/energy/crude-oil/wti-houston-crude-oil_contract_specifications.html</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a84ecd48c2d0813c5117535a998ef0825" title="WTI Houston Crude Oil Futures">WTIHoustonCrudeOil</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                {</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a84ecd48c2d0813c5117535a998ef0825" title="WTI Houston Crude Oil Futures">WTIHoustonCrudeOil</a>;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                    <span class="comment">// Monthly contracts listed through and including Dec-21</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                    <span class="comment">// Trading terminates 3 business days prior to the twenty-fifth calendar day of the month prior to the contract month.  If the twenty-fifth calendar day is not a business day, trading terminates 3 business days prior to the business day preceding the twenty-fifth calendar day of the month prior to the contract month.</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                    var twentyFifthDayInPriorMonth = <span class="keyword">new</span> DateTime(time.Year, time.Month, 25).AddMonths(-1);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                    var i = 0;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160; </div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;                    <span class="keywordflow">while</span> (i &lt; 3 || !twentyFifthDayInPriorMonth.IsCommonBusinessDay() || holidays.Contains(twentyFifthDayInPriorMonth))</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                    {</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                        <span class="keywordflow">if</span> (twentyFifthDayInPriorMonth.IsCommonBusinessDay() &amp;&amp;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;                            !holidays.Contains(twentyFifthDayInPriorMonth))</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                        {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                            i++;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                        }</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                        twentyFifthDayInPriorMonth = twentyFifthDayInPriorMonth.AddDays(-1);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                    }</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                    <span class="keywordflow">return</span> twentyFifthDayInPriorMonth;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                })</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            },</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            <span class="comment">// Natural Gas (Henry Hub) Last-day Financial (HH): https://www.cmegroup.com/trading/energy/natural-gas/natural-gas-last-day_contract_specifications.html</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aff0c308db74bd50b524c5c005e66635f" title="Natural Gas (Henry Hub) Last-day Financial Futures">NaturalGasHenryHubLastDayFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aff0c308db74bd50b524c5c005e66635f" title="Natural Gas (Henry Hub) Last-day Financial Futures">NaturalGasHenryHubLastDayFinancial</a>;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 12 calendar years.</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the month prior to the contract month.</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                    var previousMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                    previousMonth = <span class="keyword">new</span> DateTime(previousMonth.Year, previousMonth.Month, DateTime.DaysInMonth(previousMonth.Year, previousMonth.Month));</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160; </div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(previousMonth, 3, holidays);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                })</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            },</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            <span class="comment">// HeatingOil (HO): http://www.cmegroup.com/trading/energy/refined-products/heating-oil_contract_specifications.html</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#acd8dba34603f965e2a74d4bda88120f1" title="Heating Oil Futures">HeatingOil</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                {</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#acd8dba34603f965e2a74d4bda88120f1" title="Heating Oil Futures">HeatingOil</a>;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years and 1 additional month.</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                    <span class="comment">// Trading in a current month shall cease on the last business day of the month preceding the delivery month.</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                    var precedingMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(precedingMonth, 1, holidays);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                })</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            },</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            <span class="comment">// Natural Gas (Henry Hub) Penultimate Financial (HP): https://www.cmegroup.com/trading/energy/natural-gas/natural-gas-penultimate_contract_specifications.html</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a715423b18f746145d749980eb2ac23df" title="Natural Gas (Henry Hub) Penultimate Financial Futures">NaturalGasHenryHubPenultimateFinancial</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                {</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a715423b18f746145d749980eb2ac23df" title="Natural Gas (Henry Hub) Penultimate Financial Futures">NaturalGasHenryHubPenultimateFinancial</a>;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 5 calendar years.</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                    <span class="comment">// Trading terminates on the 4th last business day of the month prior to the contract month.</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                    var previousMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(previousMonth, 4, holidays);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                })</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            },</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            <span class="comment">// WTI Houston (Argus) vs. WTI Trade Month (HTT): https://www.cmegroup.com/trading/energy/crude-oil/wti-houston-argus-vs-wti-trade-month_contract_specifications.html</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aff9849b743fe77c33fa48836cca7e4a8" title="WTI Houston (Argus) vs. WTI Trade Month Futures">WTIHoustonArgusVsWTITradeMonth</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aff9849b743fe77c33fa48836cca7e4a8" title="WTI Houston (Argus) vs. WTI Trade Month Futures">WTIHoustonArgusVsWTITradeMonth</a>;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years.</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                    <span class="comment">// Trading terminates on the last business day that falls on or before the 25th calendar day of the month prior to the contract month. If the 25th calendar day is a weekend or holiday, trading shall cease on the first business day prior to the 25th calendar day.</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                    var twentyFifthPreviousMonth = <span class="keyword">new</span> DateTime(time.Year, time.Month, 25).AddMonths(-1);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(twentyFifthPreviousMonth) || !<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(twentyFifthPreviousMonth, holidays))</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                    {</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                        twentyFifthPreviousMonth = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(twentyFifthPreviousMonth, -1, holidays);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                    }</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; </div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                    <span class="keywordflow">return</span> twentyFifthPreviousMonth;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                })</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            },</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            <span class="comment">// Gasoline (RB): http://www.cmegroup.com/trading/energy/refined-products/rbob-gasoline_contract_specifications.html</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a9ad17ca9dedf7e7f97c921b0458ca11a" title="Gasoline RBOB Futures">Gasoline</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a9ad17ca9dedf7e7f97c921b0458ca11a" title="Gasoline RBOB Futures">Gasoline</a>;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 3 calendar years and 1 additional month.</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                    <span class="comment">// Trading in a current delivery month shall cease on the last business day of the month preceding the delivery month.</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                    var precedingMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(precedingMonth, 1, holidays);</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                })</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            },</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            <span class="comment">// Natural Gas (NG) : http://www.cmegroup.com/trading/energy/natural-gas/natural-gas_contract_specifications.html</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7d1adec13c406c5478eb7c9a40690d8c" title="Natural Gas Futures">NaturalGas</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                {</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7d1adec13c406c5478eb7c9a40690d8c" title="Natural Gas Futures">NaturalGas</a>;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next 12 calendar years.</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                    <span class="comment">//Trading of any delivery month shall cease three (3) business days prior to the first day of the delivery month. In the event that the official Exchange holiday schedule changes subsequent to the listing of a Natural Gas futures, the originally listed expiration date shall remain in effect.In the event that the originally listed expiration day is declared a holiday, expiration will move to the business day immediately prior.</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                    var firstDay = <span class="keyword">new</span> DateTime(time.Year,time.Month,1);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(firstDay, -3, holidays);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                })</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            },</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            <span class="comment">// Brent Crude (B) : https://www.theice.com/products/219/Brent-Crude-Futures</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6cbe7db42e56a8b2d2c06f815c0e5ef5" title="Brent Crude Futures">BrentCrude</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                {</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a6cbe7db42e56a8b2d2c06f815c0e5ef5" title="Brent Crude Futures">BrentCrude</a>;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                    <span class="comment">// Up to 96 consecutive months</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                    <span class="comment">//Trading shall cease at the end of the designated settlement period on the last Business Day of the second month</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                    <span class="comment">//preceding the relevant contract month (e.g. the March contract month will expire on the last Business Day of January).</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                    <span class="comment">//If the day on which trading is due to cease would be either: (i) the Business Day preceding Christmas Day, or</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                    <span class="comment">//(ii) the Business Day preceding New Year’s Day, then trading shall cease on the next preceding Business Day</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                    var secondPrecedingMonth = time.AddMonths(-2);</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                    var nthLastBusinessDay = secondPrecedingMonth.Month == 12 ? 2 : 1;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(secondPrecedingMonth, nthLastBusinessDay, holidays);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                })</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;            },</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <span class="comment">// Low Sulphur Gasoil Futures (G): https://www.theice.com/products/34361119/Low-Sulphur-Gasoil-Futures</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aea23844a3f1371fd9f71cb2089aaa83f" title="Low Sulfur Gasoil">LowSulfurGasoil</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                {</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#aea23844a3f1371fd9f71cb2089aaa83f" title="Low Sulfur Gasoil">LowSulfurGasoil</a>;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                    <span class="comment">// Up to 96 consecutive months</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                    <span class="comment">//Trading shall cease at 12:00 hours London Time, 2 business days prior to the 14th calendar day of the delivery month.</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                    var fourteenthDay = <span class="keyword">new</span> DateTime(time.Year,time.Month,14);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                    var twelfthDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(fourteenthDay, -2, holidays);</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                    <span class="keywordflow">return</span> twelfthDay.Add(<span class="keyword">new</span> TimeSpan(12,0,0));</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                })</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;            },</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;            <span class="comment">// Meats group</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;            <span class="comment">// LiveCattle (LE): http://www.cmegroup.com/trading/agricultural/livestock/live-cattle_contract_specifications.html</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html" title="Meats group">Meats</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html#a9d4c13f92f2dbb541ba323579dcc201d" title="Live Cattle Futures">LiveCattle</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html" title="Meats group">Meats</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html#a9d4c13f92f2dbb541ba323579dcc201d" title="Live Cattle Futures">LiveCattle</a>;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                    <span class="comment">// Monthly contracts of (Feb, Apr, Jun, Aug, Oct, Dec) listed for 9 months</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a5f17db58b481b28cace2bf5ebfdaaa14" title="GJMQVZ Cycle">GJMQVZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                    {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                    }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                    <span class="comment">//Last business day of the contract month, 12:00 p.m.</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(12,0,0));</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                })</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            },</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            <span class="comment">// LeanHogs (HE): http://www.cmegroup.com/trading/agricultural/livestock/lean-hogs_contract_specifications.html</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html" title="Meats group">Meats</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html#a82180a9c6462f021a1879ff32cd51da8" title="Lean Hogs Futures">LeanHogs</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                {</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html" title="Meats group">Meats</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html#a82180a9c6462f021a1879ff32cd51da8" title="Lean Hogs Futures">LeanHogs</a>;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                    <span class="comment">/*</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment">                     2 monthly contracts of:</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment">                    Feb listed in August</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">                    Apr listed in October</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">                    May listed in December</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">                    Jun listed in December</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment">                    Jul listed in February</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment">                    Aug listed in April</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment">                    Oct listed in May</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">                    Dec listed in June</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">                     */</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a9c358c9ed801c6d1c5487d93ad49254b" title="GJKMNQVZ Cycle">GJKMNQVZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                    {</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                    }</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                    <span class="comment">// 10th business day of the contract month, 12:00 p.m.</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                    var lastday = <span class="keyword">new</span> DateTime(time.Year,time.Month,1);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                    lastday = lastday.AddDays(-1);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                    var tenthday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastday, 10, holidays);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                    <span class="keywordflow">return</span> tenthday.Add(<span class="keyword">new</span> TimeSpan(12,0,0));</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                })</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            },</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            <span class="comment">// FeederCattle (GF): http://www.cmegroup.com/trading/agricultural/livestock/feeder-cattle_contract_specifications.html</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html" title="Meats group">Meats</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html#ac8778d954f25d66b2e7e267bde6a4ebd" title="Feeder Cattle Futures">FeederCattle</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                {</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html" title="Meats group">Meats</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Meats.html#ac8778d954f25d66b2e7e267bde6a4ebd" title="Feeder Cattle Futures">FeederCattle</a>;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                    <span class="comment">// Monthly contracts of (Jan, Mar, Apr, May, Aug, Sep, Oct, Nov) listed for 8 months</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a08a035b4e48942480d0818e65ffec731" title="FHJKQUVX Cycle">FHJKQUVX</a>.Contains(time.Month))</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                    {</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                    }</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                    <span class="comment">/* Trading shall terminate on the last Thursday of the contract month, except:</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment">                     * 1. The November contract shall terminate on the Thursday</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment">                     * prior to Thanksgiving Day, unless a holiday falls on</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment">                     * that Thursday or on any of the four weekdays prior to</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment">                     * that Thursday, in which case trading shall terminate on</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment">                     * the first prior Thursday that is not a holiday and is</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">                     * not so preceded by a holiday. Weekdays shall be defined</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">                     * as Monday, Tuesday, Wednesday, Thursday and Friday.</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">                     * 2. Any contract month in which a holiday falls on the last</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment">                     * Thursday of the month or on any of the four weekdays</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment">                     * prior to that Thursday shall terminate on the first</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment">                     * prior Thursday that is not a holiday and is not so</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="comment">                     * preceded by a holiday.*/</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                    var daysInMonth = DateTime.DaysInMonth(time.Year, time.Month);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                    <span class="comment">// Checking condition 1</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                    <span class="keywordflow">if</span>(time.Month == 11)</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                    {</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                        var priorThursday = (from day in Enumerable.Range(1, daysInMonth)</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                                  where <span class="keyword">new</span> DateTime(time.Year, time.Month, day).DayOfWeek == DayOfWeek.Thursday</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                                  select <span class="keyword">new</span> DateTime(time.Year, time.Month, day)).Reverse().ElementAt(1);</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                        <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(priorThursday, holidays) || !<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#ab0e73750c417736f06e57168e93af178" title="This function takes Thursday as input and returns true if four weekdays preceding it are not Holidays">NotPrecededByHoliday</a>(priorThursday, holidays))</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                        {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                            priorThursday = priorThursday.AddDays(-7);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                        }</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                        <span class="keywordflow">return</span> priorThursday;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                    }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                    <span class="comment">// Checking Condition 2</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                    var lastThursday = (from day in Enumerable.Range(1, daysInMonth)</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                                  where <span class="keyword">new</span> DateTime(time.Year, time.Month, day).DayOfWeek == DayOfWeek.Thursday</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                                  select <span class="keyword">new</span> DateTime(time.Year, time.Month, day)).Reverse().ElementAt(0);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(lastThursday, holidays) || !<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#ab0e73750c417736f06e57168e93af178" title="This function takes Thursday as input and returns true if four weekdays preceding it are not Holidays">NotPrecededByHoliday</a>(lastThursday, holidays))</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                    {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                        lastThursday = lastThursday.AddDays(-7);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                    }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                    <span class="keywordflow">return</span> lastThursday;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                })</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            },</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;            <span class="comment">// Softs group</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;            <span class="comment">// Cotton #2 (CT): https://www.theice.com/products/254/Cotton-No-2-Futures</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#a599287cea08a31c82cb4aebb7a3edfe1" title="Cotton #2 Futures">Cotton2</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#a599287cea08a31c82cb4aebb7a3edfe1" title="Cotton #2 Futures">Cotton2</a>;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                    <span class="comment">// March, May, July, October, December</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#abc8b39c8b5e903eb0057938276098a6e" title="HKNVZ Cycle">HKNVZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                    {</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                    }</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                    <span class="comment">// Last Trading Day:</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                    <span class="comment">// Seventeen business days from end of spot month.</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 17, holidays);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                })</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;            },</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;            <span class="comment">// Orange Juice (OJ): https://www.theice.com/products/30/FCOJ-A-Futures</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#adc1c1d5da7985436ad97a1aedc9f9bb5" title="Orange Juice Futures">OrangeJuice</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#adc1c1d5da7985436ad97a1aedc9f9bb5" title="Orange Juice Futures">OrangeJuice</a>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                    </div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                    <span class="comment">// January, March, May, July, September, November.</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#abdd664b0966118a46ff25c906350bad6" title="FHKNUX Cycle">FHKNUX</a>.Contains(time.Month))</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                    {</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                    }</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160; </div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 15, holidays);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                })</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;            },</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;            <span class="comment">// Coffee (KC): https://www.theice.com/products/15/Coffee-C-Futures</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#a8c08c5e987b22ed76ee8001c0b4fe7fd" title="Coffee C Arabica Futures">Coffee</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                {</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#a8c08c5e987b22ed76ee8001c0b4fe7fd" title="Coffee C Arabica Futures">Coffee</a>;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                    <span class="comment">// March, May, July, September, December.</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a7f732da437ca4c5d8ea92b01a685eccc" title="HKNUZ Cycle">HKNUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                    {</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                    }</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160; </div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                    <span class="comment">// Last Trading Day:</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                    <span class="comment">// One business day prior to last notice day</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                    <span class="comment">// Last Notice Day:</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                    <span class="comment">// Seven business days prior to the last business day off the delivery month</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160; </div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 9, holidays);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                })</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;            },</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;            <span class="comment">// Sugar #11 ICE (SB): https://www.theice.com/products/23/Sugar-No-11-Futures</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#ac7e6fcd5acbd90f9a644663b1c6e6d69" title="Sugar #11 Futures ICE">Sugar11</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#ac7e6fcd5acbd90f9a644663b1c6e6d69" title="Sugar #11 Futures ICE">Sugar11</a>;</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                    <span class="comment">// March, May, July and October</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a78f6eddf711245e75766333a73550f4c" title="HKNV Cycle">HKNV</a>.Contains(time.Month))</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                    {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                    }</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160; </div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                    <span class="comment">// Last Trading Day:</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                    <span class="comment">// Last business day of the month preceding the delivery month</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time.AddMonths(-1), 1, holidays);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                })</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;            },</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;            <span class="comment">// Sugar #11 CME (YO): https://www.cmegroup.com/trading/agricultural/softs/sugar-no11_contract_specifications.html</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#affe752f7217ae1e6ed5d7a94784a8aba" title="Sugar #11 Futures CME">Sugar11CME</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                {</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#affe752f7217ae1e6ed5d7a94784a8aba" title="Sugar #11 Futures CME">Sugar11CME</a>;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                    <span class="comment">// Trading is conducted in the March, May, July, and October cycle for the next 24 months.</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a78f6eddf711245e75766333a73550f4c" title="HKNV Cycle">HKNV</a>.Contains(time.Month))</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                    {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                    }</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160; </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                    <span class="comment">// Trading terminates on the day immediately preceding the first notice day of the corresponding trading month of Sugar No. 11 futures at ICE Futures U.S.</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                    var precedingMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(precedingMonth, 1, holidays);</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                })</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;            },</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;            <span class="comment">// Cocoa (CC): https://www.theice.com/products/7/Cocoa-Futures</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#a100265311d8459f9c7c12516678e5ca2" title="Cocoa Futures">Cocoa</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>), (time =&gt;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                {</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a29d8609f3451e3caed5fa1bd186f25eb" title="ICE">ICE</a>;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html" title="Softs group">Softs</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Softs.html#a100265311d8459f9c7c12516678e5ca2" title="Cocoa Futures">Cocoa</a>;</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                    <span class="comment">// March, May, July, September, December</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a7f732da437ca4c5d8ea92b01a685eccc" title="HKNUZ Cycle">HKNUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                    {</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                    }</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160; </div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                    <span class="comment">// Last Trading Day:</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                    <span class="comment">// One business day prior to last notice day</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                    <span class="comment">// Last Notice Day:</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                    <span class="comment">// Ten business days prior to last business day of delivery month</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; </div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 12, holidays);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                })</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            },</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            <span class="comment">// Dairy Group</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            <span class="comment">// Cash-settled Butter (CB): https://www.cmegroup.com/trading/agricultural/dairy/cash-settled-butter_contract_specifications.html</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a6727be9b5be4df063c91ebc28a41a7fb" title="Cash-settled Butter Futures">CashSettledButter</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                {</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a6727be9b5be4df063c91ebc28a41a7fb" title="Cash-settled Butter Futures">CashSettledButter</a>;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                    <span class="comment">// Monthly contracts listed for 24 consecutive months</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                    <span class="comment">// Trading shall terminate on the business day immediately preceding the day on which the USDA announces the Butter price for that contract month. (LTD 12:10 p.m.)</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aac582df507673dd8c6bd5b4415634148" title="Gets the last trade date corresponding to the contract month">DairyLastTradeDate</a>(time, holidays);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                })</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            },</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            <span class="comment">// Cash-Settled Cheese (CSC): https://www.cmegroup.com/trading/agricultural/dairy/cheese_contract_specifications.html</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#ae2f164925b7e92d771c1352feb50d4e9" title="Cash-settled Cheese Futures">CashSettledCheese</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                {</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#ae2f164925b7e92d771c1352feb50d4e9" title="Cash-settled Cheese Futures">CashSettledCheese</a>;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                    <span class="comment">// Monthly contracts listed for 24 consecutive months</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                    <span class="comment">// Trading shall terminate on the business day immediately preceding the release date for the USDA monthly weighted average price in the U.S. for cheese. LTD close is at 12:10 p.m. Central Time</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aac582df507673dd8c6bd5b4415634148" title="Gets the last trade date corresponding to the contract month">DairyLastTradeDate</a>(time, holidays);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                })</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;            },</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;            <span class="comment">// Class III Milk (DC): https://www.cmegroup.com/trading/agricultural/dairy/class-iii-milk_contract_specifications.html</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#abf270e2f8f81b1598540879153786999" title="Class III Milk Futures">ClassIIIMilk</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                {</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#abf270e2f8f81b1598540879153786999" title="Class III Milk Futures">ClassIIIMilk</a>;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                    <span class="comment">// Monthly contracts listed for 24 consecutive months</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                    <span class="comment">// Trading shall terminate on the business day immediately preceding the day on which the USDA announces the Class III price for that contract month (LTD 12:10 p.m.)</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aac582df507673dd8c6bd5b4415634148" title="Gets the last trade date corresponding to the contract month">DairyLastTradeDate</a>(time, holidays);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                })</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;            },</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;            <span class="comment">// Dry Whey (DY): https://www.cmegroup.com/trading/agricultural/dairy/dry-whey_contract_specifications.html</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a34f04b62ef99459023563e4e36e119a3" title="Dry Whey Futures">DryWhey</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;                {</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a34f04b62ef99459023563e4e36e119a3" title="Dry Whey Futures">DryWhey</a>;</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                    <span class="comment">// Monthly contracts listed for 24 consecutive months</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                    <span class="comment">// Trading shall terminate on the business day immediately preceding the day on which the USDA announces the Dry Whey price for that contract month. (LTD 12:10 p.m.)</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aac582df507673dd8c6bd5b4415634148" title="Gets the last trade date corresponding to the contract month">DairyLastTradeDate</a>(time, holidays);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                })</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            },</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            <span class="comment">// Class IV Milk (GDK): https://www.cmegroup.com/trading/agricultural/dairy/class-iv-milk_contract_specifications.html</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a13dc7255dca85c3b260d33848c4dc411" title="Class IV Milk Futures">ClassIVMilk</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                {</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a13dc7255dca85c3b260d33848c4dc411" title="Class IV Milk Futures">ClassIVMilk</a>;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                    <span class="comment">// Monthly contracts listed for 24 consecutive months</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                    <span class="comment">// Trading shall terminate on the business day immediately preceding the day on which the USDA announces the Class IV price for that contract month. (LTD 12:10 p.m.)</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aac582df507673dd8c6bd5b4415634148" title="Gets the last trade date corresponding to the contract month">DairyLastTradeDate</a>(time, holidays);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                })</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            },</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            <span class="comment">// Non-fat Dry Milk (GNF): https://www.cmegroup.com/trading/agricultural/dairy/nonfat-dry-milk_contract_specifications.html</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a7c405719924b8ea3719bcb749236bb53" title="Non-fat Dry Milk Futures">NonfatDryMilk</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html" title="Dairy group">Dairy</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Dairy.html#a7c405719924b8ea3719bcb749236bb53" title="Non-fat Dry Milk Futures">NonfatDryMilk</a>;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                    <span class="comment">// Monthly contracts listed for 24 consecutive months</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                    <span class="comment">// Trading shall terminate on the business day immediately preceding the day on which the USDA announces the Nonfat Dry Milk price for that contract month. (LTD 12:10 p.m.)</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aac582df507673dd8c6bd5b4415634148" title="Gets the last trade date corresponding to the contract month">DairyLastTradeDate</a>(time, holidays);</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                })</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            },</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            <span class="comment">// Micro Gold Futures (MGC): https://www.cmegroup.com/markets/metals/precious/e-micro-gold.contractSpecs.html</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a4d931ce514d24e9727b763167baaa224" title="Micro Gold Futures">MicroGold</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a4d931ce514d24e9727b763167baaa224" title="Micro Gold Futures">MicroGold</a>;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month.</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160; </div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                })</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;            },</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;            <span class="comment">// Micro Silver Futures (SIL): https://www.cmegroup.com/markets/metals/precious/1000-oz-silver.contractSpecs.html</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a0819eba355f1935dc287fac639e4cfce" title="Micro Silver Futures">MicroSilver</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;                {</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a0819eba355f1935dc287fac639e4cfce" title="Micro Silver Futures">MicroSilver</a>;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month.</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                })</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;            },</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;            <span class="comment">// Micro Gold TAS Futures (MGT): https://www.cmegroup.com/markets/metals/precious/e-micro-gold.contractSpecs.html</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#afce6cc8161d8f062d6beb91126676e99" title="Micro Gold TAS Futures">MicroGoldTAS</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                {</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a10eda16bfb7d512ff5e324c9eb019133" title="Comex">COMEX</a>;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#afce6cc8161d8f062d6beb91126676e99" title="Micro Gold TAS Futures">MicroGoldTAS</a>;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month.</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                })</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            },</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;            <span class="comment">// Micro Palladium Futures (PAM): https://www.cmegroup.com/markets/metals/precious/e-micro-palladium.contractSpecs.html</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a06cb33dd6417691baed4468a9d498b5a" title="Micro Palladium Futures">MicroPalladium</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                {</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a06cb33dd6417691baed4468a9d498b5a" title="Micro Palladium Futures">MicroPalladium</a>;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month.</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; </div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                })</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;            },</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;            <span class="comment">// Mini Sized NY Gold Futures: https://www.theice.com/products/31500921/Mini-Gold-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#aec241d790f443c33a9d58bdb25603c20" title="Mini Sized NY Gold Futures">MiniNYGold</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                {</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#aec241d790f443c33a9d58bdb25603c20" title="Mini Sized NY Gold Futures">MiniNYGold</a>;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month @13:30</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160; </div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                })</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            },</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;            <span class="comment">// Mini Sized NY Silver Futures: https://www.theice.com/products/31500921/Mini-Silver-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#ab78e9f43583be820d165a643ac623576" title="Mini Sized NY Silver Futures">MiniNYSilver</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#ab78e9f43583be820d165a643ac623576" title="Mini Sized NY Silver Futures">MiniNYSilver</a>;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month @13:25</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160; </div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(13, 25, 0));</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                })</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            },</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;            <span class="comment">// Gold 100 Oz Futures: https://www.theice.com/products/31499002/100-oz-Gold-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a967ce6f282fe60f7982b51355c947e63" title="Gold 100 Oz Futures">Gold100Oz</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a967ce6f282fe60f7982b51355c947e63" title="Gold 100 Oz Futures">Gold100Oz</a>;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month @13:30</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160; </div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(13, 30, 0));</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;                })</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            },</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;            <span class="comment">// Silver 5000 Oz Futures: https://www.theice.com/products/31500922/5000-oz-Silver-Future &amp; https://www.theice.com/publicdocs/futures_us/exchange_notices/ICE_Futures_US_2022_TRADING_HOLIDAY_CALENDAR_20211118.pdf</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a22a53c9587db2a53907fc95c5c37905f" title="Silver 5000 Oz Futures">Silver5000Oz</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>), (time =&gt;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                {</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a15bb2a7f73e08d5fd7c7b75c2343d0d5" title="London International Financial Futures and Options Exchange">NYSELIFFE</a>;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html" title="Metals group">Metals</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Metals.html#a22a53c9587db2a53907fc95c5c37905f" title="Silver 5000 Oz Futures">Silver5000Oz</a>;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                    <span class="comment">// Trading terminates on the third last business day of the contract month @13:25</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; </div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 3, holidays);</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(13, 25, 0));</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                })</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;            },</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;            <span class="comment">// Micro 10-Year Yield Futures (10Y): https://www.cmegroup.com/markets/interest-rates/us-treasury/micro-10-year-yield.contractSpecs.html</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a96bf1c0861841779ea8f59dfbe80b984" title="Micro 10-Year Yield Futures">MicroY10TreasuryNote</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#a96bf1c0861841779ea8f59dfbe80b984" title="Micro 10-Year Yield Futures">MicroY10TreasuryNote</a>;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160; </div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                })</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;            },</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            <span class="comment">// Micro 30-Year Yield Futures (30Y): https://www.cmegroup.com/markets/interest-rates/us-treasury/micro-30-year-yield_contract_specifications.html</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#aa5aa983bd8266415bd856feb6c03fb34" title="Micro 30-Year Yield Futures">MicroY30TreasuryBond</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#aa5aa983bd8266415bd856feb6c03fb34" title="Micro 30-Year Yield Futures">MicroY30TreasuryBond</a>;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160; </div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                })</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;            },</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;            <span class="comment">// Micro 2-Year Yield Futures (2YY): https://www.cmegroup.com/markets/interest-rates/us-treasury/micro-2-year-yield.contractSpecs.html</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#ab08c564c4e140510f10c670308a2d3f4" title="Micro 2-Year Yield Futures">MicroY2TreasuryBond</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;                {</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#ab08c564c4e140510f10c670308a2d3f4" title="Micro 2-Year Yield Futures">MicroY2TreasuryBond</a>;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160; </div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                })</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;            },</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;            <span class="comment">// Micro 5-Year Yield Futures (5YY): https://www.cmegroup.com/markets/interest-rates/us-treasury/micro-5-year-yield.contractSpecs.html</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#abb755c41068fa3c9774fac10da57393b" title="Micro 5-Year Yield Futures">MicroY5TreasuryBond</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                {</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html" title="Financials group">Financials</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Financials.html#abb755c41068fa3c9774fac10da57393b" title="Micro 5-Year Yield Futures">MicroY5TreasuryBond</a>;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;                    <span class="comment">// Monthly contracts</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160; </div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;                })</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;            },</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;            <span class="comment">// Micro EUR/USD Futures (M6E): https://www.cmegroup.com/markets/fx/g10/e-micro-euro.contractSpecs.html</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a51f04d18b2a57d7c1e3386222b5199c0" title="Micro EUR/USD Futures">MicroEUR</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;                {</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a51f04d18b2a57d7c1e3386222b5199c0" title="Micro EUR/USD Futures">MicroEUR</a>;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                    {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                    }</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160; </div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                    <span class="comment">// Trading terminates at 9:16 a.m. CT 2 business day prior to the 3rd Wednesday of the contract quqrter.</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160; </div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                })</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;            },</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;            <span class="comment">// Micro AUD/USD Futures (M6A): https://www.cmegroup.com/markets/fx/g10/e-micro-australian-dollar.contractSpecs.html</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a64d61da18cec3c48c41fb264fdcd5241" title="Micro AUD/USD Futures">MicroAUD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                {</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a64d61da18cec3c48c41fb264fdcd5241" title="Micro AUD/USD Futures">MicroAUD</a>;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                    {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                    }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                    <span class="comment">// On the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                })</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            },</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            <span class="comment">// Micro GBP/USD Futures (M6B): https://www.cmegroup.com/markets/fx/g10/e-micro-british-pound.contractSpecs.html</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a08adc91a90d86cb0d71acc2fe1b16b5d" title="Micro GBP/USD Futures">MicroGBP</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a08adc91a90d86cb0d71acc2fe1b16b5d" title="Micro GBP/USD Futures">MicroGBP</a>;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                    {</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                    }</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160; </div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160; </div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                })</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            },</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;            <span class="comment">// Micro CAD/USD Futures (MCD): https://www.cmegroup.com/markets/fx/g10/e-micro-canadian-dollar-us-dollar.contractSpecs.html</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad28cbbb81af8324922e261506b8c6d43" title="Micro CAD/USD Futures">MicroCADUSD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                {</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad28cbbb81af8324922e261506b8c6d43" title="Micro CAD/USD Futures">MicroCADUSD</a>;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                    {</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                    }</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160; </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                    <span class="comment">// Trading terminates 1 business day prior to the 3rd Wednesday of the contract quarter.</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                    var firstBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;                    firstBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(firstBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160; </div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;                    <span class="keywordflow">return</span> firstBusinessDayPrecedingThirdWednesday;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;                })</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;            },</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;            <span class="comment">// Micro JPY/USD Futures (MJY): https://www.cmegroup.com/markets/fx/g10/e-micro-japanese-yen-us-dollar.contractSpecs.html</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a1013140686ca4c4618e476f71cb9cab1" title="Micro JPY/USD Futures">MicroJPY</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                {</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a1013140686ca4c4618e476f71cb9cab1" title="Micro JPY/USD Futures">MicroJPY</a>;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                    {</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                    }</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; </div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160; </div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                })</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            },</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;            <span class="comment">// Micro CHF/USD Futures (MSF): https://www.cmegroup.com/markets/fx/g10/e-micro-swiss-franc-us-dollar.contractSpecs.html</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ab0975ec6539d7019493ab2e9a1d3d4e3" title="Micro CHF/USD Futures">MicroCHF</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;                {</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ab0975ec6539d7019493ab2e9a1d3d4e3" title="Micro CHF/USD Futures">MicroCHF</a>;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;                    {</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                    }</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160; </div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160; </div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                })</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;            },</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;            <span class="comment">// Micro USD/JPY Futures (M6J): https://www.cmegroup.com/markets/fx/g10/micro-usd-jpy.contractSpecs.html</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#abadf96ef88abaa802da1fdfb0b558632" title="Micro USD/JPY Futures">MicroUSDJPY</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#abadf96ef88abaa802da1fdfb0b558632" title="Micro USD/JPY Futures">MicroUSDJPY</a>;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 2 consecutive quarters</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                    {</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                    }</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                    <span class="comment">// 9:16 a.m. Central Time (CT) on the second business day immediately preceding the third Wednesday of the contract month (usually Monday).</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160; </div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                })</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;            },</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;            <span class="comment">// Micro INR/USD Futures (MIR): https://www.cmegroup.com/markets/fx/g10/e-micro-indian-rupee.contractSpecs.html</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a1237b378db0e90f04385703f35dfe17c" title="Micro INR/USD Futures">MicroINRUSD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                {</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a1237b378db0e90f04385703f35dfe17c" title="Micro INR/USD Futures">MicroINRUSD</a>;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                    <span class="comment">// Monthly contracts listed for 12 consecutive months.</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;                    <span class="comment">// Trading terminates at 12:00 noon Mumbai time two Indian business days immediately preceding the last Indian</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                    <span class="comment">// business day of the contract month.</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160; </div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160; </div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                    var secondBusinessDayPrecedingLastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastBusinessDay,-2, holidays);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingLastBusinessDay.Add(<span class="keyword">new</span> TimeSpan(6,30,0));</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                })</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;            },</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;            <span class="comment">// Micro USD/CAD Futures (M6C): https://www.cmegroup.com/markets/fx/g10/micro-usd-cad.contractSpecs.html</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a281cea63efc1dca81edb2c47b4809473" title="Micro USD/CAD Futures">MicroCAD</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                {</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a281cea63efc1dca81edb2c47b4809473" title="Micro USD/CAD Futures">MicroCAD</a>;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                    <span class="comment">// Two months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;                    {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;                    }</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160; </div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                   <span class="comment">// Trading terminates at 9:16 a.m. CT, 1 business day prior to the third Wednesday of the contract month.</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                    var firstBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                    firstBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(firstBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160; </div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                    <span class="keywordflow">return</span> firstBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                })</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;            },</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            <span class="comment">// Micro USD/CHF Futures (M6S): https://www.cmegroup.com/markets/fx/g10/micro-usd-chf.contractSpecs.html</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad59fa1ff165f01c9066441278e2b4b6b" title="Micro USD/CHF Futures">MicroUSDCHF</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                {</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad59fa1ff165f01c9066441278e2b4b6b" title="Micro USD/CHF Futures">MicroUSDCHF</a>;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                    <span class="comment">// Two months in the March quarterly cycle (Mar, Jun, Sep, Dec)</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                    {</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                    }</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160; </div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                   <span class="comment">// Trading terminates at 9:16 a.m. CT, 2 business days prior to the third Wednesday of the contract month.</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday, -2, holidays);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                    secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(secondBusinessDayPrecedingThirdWednesday, -1, holidays);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160; </div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(14, 16, 0));</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                })</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            },</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            <span class="comment">// Micro USD/CNH Futures (MNH): https://www.cmegroup.com/markets/fx/g10/e-micro-cnh.contractSpecs.html</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#abee57850506caa482afcde7e31b1d7a5" title="Micro USD/CNH Futures">MicroUSDCNH</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                {</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#abee57850506caa482afcde7e31b1d7a5" title="Micro USD/CNH Futures">MicroUSDCNH</a>;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                    <span class="comment">// Monthly contracts listed for 12 consecutive months.</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160; </div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                    <span class="comment">// Trading terminates at 11:00 a.m. Hong Kong time on the second Hong Kong business day prior</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                    <span class="comment">// to the third Wednesday of the contract month.</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160; </div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                    var thirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a329ece8370b48d75075d72762552d3af" title="Method to retrieve third Wednesday of the given month (usually Monday).">ThirdWednesday</a>(time);</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                    var secondBusinessDayPrecedingThirdWednesday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(thirdWednesday,-2, holidays);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                    <span class="keywordflow">return</span> secondBusinessDayPrecedingThirdWednesday.Add(<span class="keyword">new</span> TimeSpan(3,0,0));</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                })</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;            },</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;            <span class="comment">// Micro E-mini S&amp;P 500 Index Futures (MES): https://www.cmegroup.com/markets/equities/sp/micro-e-mini-sandp-500.contractSpecs.html</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#a2b6b702160f97131bc9eaf243e585d74" title="Micro E-mini S&amp;P 500 Index Futures">MicroSP500EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                {</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                    {</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                    }</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160; </div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                    <span class="comment">// Trading terminates at 9:30 a.m. ET on the 3rd Friday of the contract month.</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                })</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;            },</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;            <span class="comment">// Micro E-mini Nasdaq-100 Index Futures (MNQ): https://www.cmegroup.com/markets/equities/nasdaq/micro-e-mini-nasdaq-100.contractSpecs.html</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#acd66ce2e5bc8712b86d1063978b074d6" title="Micro E-mini Nasdaq-100 Index Futures">MicroNASDAQ100EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                {</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                    {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;                    }</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160; </div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                    <span class="comment">// Trading terminates at 9:30 a.m. ET on the 3rd Friday of the contract month.</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                })</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            },</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;            <span class="comment">// Micro E-mini Russell 2000 Index Futures (M2K): https://www.cmegroup.com/markets/equities/russell/micro-e-mini-russell-2000.contractSpecs.html</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ad9825d28fd1213610167595c3a8ff56c" title="Micro E-mini Russell 2000 Index Futures">MicroRussell2000EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                {</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 5 consecutive quarters</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                    {</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                    }</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160; </div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                    <span class="comment">// Trading terminates at 9:30 a.m. ET on the 3rd Friday of the contract month.</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;                })</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            },</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;            <span class="comment">// Micro E-mini Dow Jones Industrial Average Index Futures (MYM): https://www.cmegroup.com/markets/equities/dow-jones/micro-e-mini-dow.contractSpecs.html</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html" title="Indices group">Indices</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Indices.html#ae30f255c82da135cd58eaed7a1a24cd1" title="Micro E-mini Dow Jones Industrial Average Index Futures">MicroDow30EMini</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#a57478f7cbb23e6fcc0b59bde158ed4a8" title="CBOT">CBOT</a>), (time =&gt;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                {</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                    <span class="comment">// Quarterly contracts (Mar, Jun, Sep, Dec) listed for 4 consecutive quarters</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                    <span class="keywordflow">while</span> (!<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html" title="Static class contains definitions of popular futures expiration cycles">FutureExpirationCycles</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1FutureExpirationCycles.html#a322aa5a88b4a160eceae0b0115a99081" title="HMUZ Cycle">HMUZ</a>.Contains(time.Month))</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                    {</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                        time = time.AddMonths(1);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                    }</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160; </div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                    <span class="comment">// Trading can occur up to 9:30 a.m. Eastern Time (ET) on the 3rd Friday of the contract month</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                    var thirdFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aadb0c0815d821fe2e795a2521aac802a" title="Method to retrieve the 3rd Friday of the given month">ThirdFriday</a>(time);</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                    <span class="keywordflow">return</span> thirdFriday.Add(<span class="keyword">new</span> TimeSpan(13,30,0));</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                })</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;            },</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;            <span class="comment">// Micro WTI Crude Oil Futures (MCL): https://www.cmegroup.com/markets/energy/crude-oil/micro-wti-crude-oil.contractSpecs.html</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a5661994cf67963ea3cf175f5dc6d68d4" title="Micro WTI Crude Oil Futures">MicroCrudeOilWTI</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a5661994cf67963ea3cf175f5dc6d68d4" title="Micro WTI Crude Oil Futures">MicroCrudeOilWTI</a>;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;                    <span class="comment">// Monthly contracts listed for 12 consecutive months and additional Jun and Dec contract months</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                    <span class="comment">// Trading terminates 4 business days prior to the 25th calendar day of the month prior to the</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;                    <span class="comment">// contract month (1 business day prior to CL LTD)</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;                    <span class="comment">// If the 25th calendar day is not a business day, trading terminates 5 business days before the 25th calendar day of the month prior to the contract month.</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160; </div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                    var previousMonth = time.AddMonths(-1);</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                    var twentyFifthDay = <span class="keyword">new</span> DateTime(previousMonth.Year, previousMonth.Month, 25);</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160; </div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                    var businessDays = -4;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;                    <span class="keywordflow">if</span>(!<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aca9031037c022ee7e9db03c14c04ac35" title="Method to check whether a given time is holiday or not">NotHoliday</a>(twentyFifthDay, holidays))</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;                    {</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;                        <span class="comment">// if the 25th is a holiday we substract 1 extra bussiness day</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;                        businessDays -= 1;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;                    }</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(twentyFifthDay, businessDays, holidays);</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                })</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;            },</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            <span class="comment">// Micro Singapore FOB Marine Fuel 0.5% (Platts) Futures (S50): https://www.cmegroup.com/markets/energy/refined-products/micro-singapore-fob-marine-fuel-05-platts.contractSpecs.html</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a388660bd7c02e207a17ca675c94f8f3b" title="Micro Singapore FOB Marine Fuel 0.5% (Platts) Futures">MicroSingaporeFOBMarineFuelZeroPointFivePercetPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;                {</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a388660bd7c02e207a17ca675c94f8f3b" title="Micro Singapore FOB Marine Fuel 0.5% (Platts) Futures">MicroSingaporeFOBMarineFuelZeroPointFivePercetPlatts</a>;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and next 3 calendar years</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;                    <span class="comment">// Add monthly contracts for a new calendar year following the termination of trading in the</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;                    <span class="comment">// December contract of the current year.</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160; </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160; </div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                })</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;            },</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;            <span class="comment">// Micro Gasoil 0.1% Barges FOB ARA (Platts) Futures (M1B): https://www.cmegroup.com/markets/energy/refined-products/micro-gasoil-01-barges-fob-rdam-platts.contractSpecs.html</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a2ed10f6e36010700349d2168bea2595f" title="Micro Gasoil 0.1% Barges FOB ARA (Platts) Futures">MicroGasoilZeroPointOnePercentBargesFOBARAPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                {</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a2ed10f6e36010700349d2168bea2595f" title="Micro Gasoil 0.1% Barges FOB ARA (Platts) Futures">MicroGasoilZeroPointOnePercentBargesFOBARAPlatts</a>;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160; </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                    <span class="comment">// Trading terminates on the last London business day of the contract month.</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160; </div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;                })</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;            },</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;            <span class="comment">// Micro European FOB Rdam Marine Fuel 0.5% Barges (Platts) Futures (R50): https://www.cmegroup.com/markets/energy/refined-products/micro-european-fob-rdam-marine-fuel-05-barges-platts.contractSpecs.html</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7b0bb8c6ec1f60d7bd212d506f5c47b6" title="Micro European FOB Rdam Marine Fuel 0.5% Barges (Platts) Futures">MicroEuropeanFOBRdamMarineFuelZeroPointFivePercentBargesPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;                {</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a7b0bb8c6ec1f60d7bd212d506f5c47b6" title="Micro European FOB Rdam Marine Fuel 0.5% Barges (Platts) Futures">MicroEuropeanFOBRdamMarineFuelZeroPointFivePercentBargesPlatts</a>;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and next 3 calendar years.</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                    <span class="comment">// Add monthly contracts for a new calendar year following the termination of trading</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                    <span class="comment">// in the December contract of the current year.</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160; </div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                    <span class="comment">// Trading terminates on the last London business day of the contract month.</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160; </div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                })</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            },</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            <span class="comment">// Micro European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures (MEF): https://www.cmegroup.com/markets/energy/refined-products/micro-european-35-fuel-oil-barges-fob-rdam-platts.contractSpecs.html</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ad3b9202e06a82261e37f2a2e84575ed1" title="Micro European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">MicroEuropeanThreePointFivePercentOilBargesFOBRdamPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;                {</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ad3b9202e06a82261e37f2a2e84575ed1" title="Micro European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">MicroEuropeanThreePointFivePercentOilBargesFOBRdamPlatts</a>;</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and 5 calendar years.Monthly contracts for a new calendar</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;                    <span class="comment">// year will be added following the termination of trading in  the December contract of the current year.</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160; </div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160; </div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                })</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            },</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;            <span class="comment">// Micro Singapore Fuel Oil 380CST (Platts) Futures (MAF): https://www.cmegroup.com/markets/energy/refined-products/micro-singapore-fuel-oil-380cst-platts.contractSpecs.html</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#af40a251021a47523745ea90c2bb9c0b4" title="Micro Singapore Fuel Oil 380CST (Platts) Futures">MicroSingaporeFuelOil380CSTPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                {</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#ad3b9202e06a82261e37f2a2e84575ed1" title="Micro European 3.5% Fuel Oil Barges FOB Rdam (Platts) Futures">MicroEuropeanThreePointFivePercentOilBargesFOBRdamPlatts</a>;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and 5 calendar years.Monthly contracts for a new calendar</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                    <span class="comment">// year will be added following the termination of trading in  the December contract of the current year.</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160; </div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160; </div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                })</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;            },</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;            <span class="comment">// Micro Coal (API 5) fob Newcastle (Argus/McCloskey) Futures (M5F): https://www.cmegroup.com/markets/energy/coal/micro-coal-api-5-fob-newcastle-argus-mccloskey.contractSpecs.html</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0e1dcfd8d88c8d7fe6dc4dcfa782c5c6" title="Micro Coal (API 5) fob Newcastle (Argus/McCloskey) Futures">MicroCoalAPIFivefobNewcastleArgusMcCloskey</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                {</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a0e1dcfd8d88c8d7fe6dc4dcfa782c5c6" title="Micro Coal (API 5) fob Newcastle (Argus/McCloskey) Futures">MicroCoalAPIFivefobNewcastleArgusMcCloskey</a>;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                    <span class="comment">// Monthly contracts listed for the current year and the next calendar year. Monthly contracts</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;                    <span class="comment">// for a new calendar year will be added following the termination of trading in the December</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                    <span class="comment">// contract of the current year.</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160; </div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;                    <span class="comment">// Trading terminates on the last Friday of the contract month. If such Friday is a UK holiday,</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                    <span class="comment">// trading terminates on the UK business day immediately prior to the last Friday of the contract</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                    <span class="comment">// month unless such day is not an Exchange business day, in which case trading terminates on the</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                    <span class="comment">// Exchange business day immediately prior.</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                    var lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a050919058118947f8294ec0e10105087" title="Method to retrieve the last Friday of any month">LastFriday</a>(time);</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160; </div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                    <span class="keywordflow">while</span> (holidays.Contains(lastFriday))</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                    {</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                        lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastFriday, -1, holidays);</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                        <span class="keywordflow">while</span> (holidays.Contains(lastFriday))</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                        {</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                            lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a4dbfe18d885325956f86d258afcc793b" title="Method to retrieve n^th succeeding/preceding business day for a given day">AddBusinessDays</a>(lastFriday, -1, holidays);</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                        }</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                    }</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160; </div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;                    <span class="keywordflow">return</span> lastFriday;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;                })</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            },</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            <span class="comment">// Micro European 3.5% Fuel Oil Cargoes FOB Med (Platts) Futures (M35): https://www.cmegroup.com/markets/energy/refined-products/micro-european-35-fuel-oil-cargoes-fob-med-platts.contractSpecs.html</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a569e8d2eb3af5160054ee228865f6b2d" title="Micro European 3.5% Fuel Oil Cargoes FOB Med (Platts) Futures">MicroEuropeanThreePointFivePercentFuelOilCargoesFOBMedPlatts</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>), (time =&gt;</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                {</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#aa3e989830b584f8d66d87962c1e6df94" title="NYMEX">NYMEX</a>;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html" title="Energies group">Energies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Energies.html#a569e8d2eb3af5160054ee228865f6b2d" title="Micro European 3.5% Fuel Oil Cargoes FOB Med (Platts) Futures">MicroEuropeanThreePointFivePercentFuelOilCargoesFOBMedPlatts</a>;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                    <span class="comment">// Monthly contracts listed for 36 consecutive months</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160; </div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                    <span class="comment">// Trading terminates on the last business day of the contract month.</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                    var lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#aea0dd9861d3b7362c8858adccb3445ab" title="Method to retrieve the n^th last business day of the delivery month.">NthLastBusinessDay</a>(time, 1, holidays);</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                    lastBusinessDay = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastBusinessDay, -1, holidays);</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160; </div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;                    <span class="keywordflow">return</span> lastBusinessDay;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;                })</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;            },</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;            <span class="comment">// Micro Ether Futures (MET): https://www.cmegroup.com/markets/cryptocurrencies/ether/micro-ether.contractSpecs.html</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a6897265d211a0d5f04de45db16aed6b8" title="Micro Ether Futures">MicroEther</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                {</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#a6897265d211a0d5f04de45db16aed6b8" title="Micro Ether Futures">MicroEther</a>;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                    <span class="comment">// Monthly contracts listed for 6 consecutive months and 2 additional Dec contract months.</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160; </div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                    <span class="comment">// Trading terminates at 4:00 p.m. London time on the last Friday of the contract month that</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                    <span class="comment">// is either a London or U.S. business day. If the last Friday of the contract month day is</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                    <span class="comment">// not a business day in both London and the U.S., trading terminates on the prior London or</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                    <span class="comment">// U.S. business day.</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160; </div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                    <span class="comment">// BTIC: Trading terminates at 4:00 p.m. London time on the last Thursday of the contract month</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                    <span class="comment">// that is either a London or U.S. business day. If the last Thursday of the contract month day</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                    <span class="comment">// is not a business day in both London and the U.S., trading terminates on the prior London or U.S.</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                    <span class="comment">// business day.</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160; </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                    var lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a050919058118947f8294ec0e10105087" title="Method to retrieve the last Friday of any month">LastFriday</a>(time);</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;                    lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastFriday, -1, holidays);</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160; </div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                    <span class="keywordflow">return</span> lastFriday.Add(<span class="keyword">new</span> TimeSpan(15, 0, 0));</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                })</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;            },</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;            <span class="comment">// Micro Bitcoin Futures (MBT): https://www.cmegroup.com/markets/cryptocurrencies/bitcoin/micro-bitcoin.contractSpecs.html</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;            {<a class="code" href="classQuantConnect_1_1Symbol.html" title="Represents a unique security identifier. This is made of two components, the unique SID and the Value...">Symbol</a>.<a class="code" href="classQuantConnect_1_1Symbol.html#a350b9a625cf7bad95da82894be3cd0a8" title="Provides a convenience method for creating a Symbol for most security types. This method currently do...">Create</a>(<a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad4e5ffef79955dfe7008c4efd46b027a" title="Micro Bitcoin Futures">MicroBTC</a>, <a class="code" href="namespaceQuantConnect.html#a5b278afcdcc479a49e001f7ea24b1eb2" title="Type of tradable security / underlying asset">SecurityType</a>.Future, <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>), (time =&gt;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                {</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                    var market = <a class="code" href="classQuantConnect_1_1Market.html" title="Markets Collection: Soon to be expanded to a collection of items specifying the market hour,...">Market</a>.<a class="code" href="classQuantConnect_1_1Market.html#abca92e7522042f4cdcefc4cba868e597" title="CME">CME</a>;</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                    var symbol = <a class="code" href="classQuantConnect_1_1Securities_1_1Futures.html" title="Futures static class contains shortcut definitions of major futures contracts available for trading">Futures</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html" title="Currencies group">Currencies</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Futures_1_1Currencies.html#ad4e5ffef79955dfe7008c4efd46b027a" title="Micro Bitcoin Futures">MicroBTC</a>;</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                    var holidays = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a9aa543735102b14ff694b42d1ee142d4" title="Get holiday list from the MHDB given the market and the symbol of the security">GetHolidays</a>(market, symbol);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                    <span class="comment">// Monthly contracts listed for 6 consecutive months and 2 additional Dec contract months.</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                    <span class="comment">// If the 6 consecutive months includes Dec, list only 1 additional Dec contract month.</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                    <span class="comment">// Trading terminates at 4:00 p.m. London time on the last Friday of the contract month.</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                    <span class="comment">// If this is not both a London and U.S. business day, trading terminates on the prior</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                    <span class="comment">// London and the U.S. business day.</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160; </div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;                    <span class="comment">// BTIC: Trading terminates at 4:00 p.m. London time on the last Thursday of the contract</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;                    <span class="comment">// month.If this is not both a London and U.S. business day, trading terminates on the prior</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                    <span class="comment">// London and the U.S. business day.</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160; </div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                    var lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a050919058118947f8294ec0e10105087" title="Method to retrieve the last Friday of any month">LastFriday</a>(time);</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                    lastFriday = <a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html" title="Class to implement common functions used in FuturesExpiryFunctions">FuturesExpiryUtilityFunctions</a>.<a class="code" href="classQuantConnect_1_1Securities_1_1Future_1_1FuturesExpiryUtilityFunctions.html#a2faa025cfb79f45e8738b8f8e9343d7a" title="Method to retrieve n^th succeeding/preceding business day for a given day if there was a holiday on t...">AddBusinessDaysIfHoliday</a>(lastFriday, -1, holidays);</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160; </div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                    <span class="keywordflow">return</span> lastFriday.Add(<span class="keyword">new</span> TimeSpan(15, 0, 0));</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                })</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;            }</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;        };</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    }</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4ab6b4cc6a7edbff49100e9123df213f.html">Common</a></li><li class="navelem"><a class="el" href="dir_4002bdd9f4b1a6ee3703d6414aeb1b9a.html">Securities</a></li><li class="navelem"><a class="el" href="dir_19465bf91af8fc55468d4cd1d9f4b7f2.html">Future</a></li><li class="navelem"><b>FuturesExpiryFunctions.cs</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
